<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>ReactNativeç¢ç‰‡æ•´ç†ä¹‹State</title>
      <link href="/2018/07/28/ReactNative%E7%A2%8E%E7%89%87%E6%95%B4%E7%90%86%E4%B9%8BState/"/>
      <content type="html"><![CDATA[<p>æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§æ•°æ®æ¥æ§åˆ¶ä¸€ä¸ªç»„ä»¶ï¼špropså’Œstateã€‚propsæ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­æŒ‡å®šï¼Œè€Œä¸”ä¸€ç»æŒ‡å®šï¼Œåœ¨è¢«æŒ‡å®šçš„ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­åˆ™ä¸å†æ”¹å˜ã€‚ å¯¹äºéœ€è¦æ”¹å˜çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨stateã€‚</p><a id="more"></a><p>stateå±æ€§ä¸»è¦ç”¨æ¥å­˜å‚¨ç»„ä»¶è‡ªèº«éœ€è¦çš„æ•°æ®ï¼Œæ˜¯ç»„ä»¶è‡ªå·±ç§æœ‰çš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ä¿®æ”¹ state å±æ€§çš„å€¼æ¥æ›´æ–°æ•°æ®ï¼ŒReact å†…éƒ¨ä¼šç›‘å¬ <code>state</code> çš„å˜åŒ–ï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–å°±ä¼šä¸»åŠ¨è§¦å‘ç»„ä»¶çš„ render() æ–¹æ³•æ¥æ›´æ–° Dom ç»“æ„</p><h3 id="stateçš„ä½¿ç”¨"><a href="#stateçš„ä½¿ç”¨" class="headerlink" title="stateçš„ä½¿ç”¨"></a>stateçš„ä½¿ç”¨</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œä½ éœ€è¦åœ¨ constructor()æ–¹æ³•ä¸­åˆå§‹åŒ– stateï¼ˆè¿™æ˜¯ES6çš„å†™æ³•ï¼ŒES5 ä¸­ä¸€èˆ¬åœ¨ <code>getInitialState()</code> æ–¹æ³•ä¸­æ¥åˆå§‹åŒ– <code>state</code>ï¼‰ï¼Œç„¶ååœ¨éœ€è¦ä¿®æ”¹æ—¶è°ƒç”¨ setState() æ–¹æ³•ã€‚</p><p>ä¸è¦ä½¿ç”¨ <code>this.state</code> æ¥ä¿®æ”¹ <code>state</code> å±æ€§å€¼ï¼Œåº”è¯¥è°ƒç”¨ <code>setState()</code> æ–¹æ³•ï¼Œ<code>this.state</code> <strong>æ˜¯æ— æ•ˆçš„</strong>ã€‚</p><h3 id="setStateï¼ˆï¼‰æ–¹æ³•"><a href="#setStateï¼ˆï¼‰æ–¹æ³•" class="headerlink" title="setStateï¼ˆï¼‰æ–¹æ³•"></a>setStateï¼ˆï¼‰æ–¹æ³•</h3><p><code>setState()</code> çš„å®Œæ•´è¡¨è¾¾å¼ï¼š</p><p><code>setState(updater, [callback])</code></p><p><code>setState()</code> æ–¹æ³•ä¼šæŠŠå¯¹ç»„ä»¶ state çš„æ”¹å˜åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”å‘Šè¯‰ React è¿™ä¸ªç»„ä»¶åŠå…¶å­ç»„ä»¶éœ€è¦é‡æ–°æ¸²æŸ“ã€‚</p><h4 id="ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater-å‡½æ•°"><a href="#ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater-å‡½æ•°" class="headerlink" title="ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater å‡½æ•°"></a>ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>updater</code> å‡½æ•°</h4><p><code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›ºå®šæ ¼å¼çš„ <code>updater</code> å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(prevState, props) =&gt; stateChange</div></pre></td></tr></table></figure><p><code>prevState</code> æ˜¯ä¸€ä¸ªå¯¹ä¹‹å‰çŠ¶æ€ï¼ˆprevious stateï¼‰çš„å¼•ç”¨ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥ä¿®æ”¹è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œè¦æƒ³ä¿®æ”¹ <code>state</code> çš„å€¼ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ® <code>prevState</code> å’Œ <code>props</code> å‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ JavaScript å¯¹è±¡ã€‚</p><p><strong>ä¾‹å­1ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> &#123;<span class="attr">counter</span>: prevState.counter + props.step&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ªå¯¹è±¡è€Œä¸æ˜¯å‡½æ•°ï¼Œæ¥ä½œä¸º<code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒReact ä¼šå°†è¯¥å‚æ•° merge åˆ° state ä¸­ã€‚</p><p><strong>ä¾‹å­2:</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">this</span><span class="selector-class">.setState</span>(&#123;<span class="attribute">quantity</span>: <span class="number">2</span>&#125;);</div></pre></td></tr></table></figure><h4 id="ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback"><a href="#ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback" class="headerlink" title="ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback"></a>ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback</h4><p><code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•° <code>callback</code> æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚ï¼ˆåŸºæœ¬æ˜¯ç©ºçš„ï¼Œä¸€èˆ¬ä¸è¿™ä¹ˆä½¿ç”¨ï¼‰</p><p>ä¸ºäº†æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼ŒReact å¹¶ä¸èƒ½ä¿è¯ <code>setState()</code> ä¸€è¢«è°ƒç”¨ state å°±èƒ½æ›´æ–°ã€‚æ‰€ä»¥ï¼Œå¦‚æœåœ¨è°ƒç”¨ <code>setState()</code> ä¹‹åï¼Œé©¬ä¸Šå°±è¯»å– <code>this.state</code> çš„å€¼çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°è¯¯å·®ã€‚</p><p>å› æ­¤ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ <code>componentDidUpdate</code> æˆ–è€… <code>setState(updater, callback)</code> æ–¹æ³•çš„ <code>callback</code> æ¥è·å–æœ€æ–°çš„çŠ¶æ€ã€‚</p><p><strong>React å®˜æ–¹æ›´æ¨è</strong>ä½¿ç”¨ <code>componentDidUpdate()</code>ï¼Œè€Œä¸æ˜¯ <code>callback</code> æ¥ç›‘å¬ update äº‹ä»¶ï¼ˆæ³¨ï¼š é™¤é <code>shouldComponentUpdate()</code> æ–¹æ³•è¿”å› <code>false</code>ï¼Œ<code>setState()</code> å°†æ°¸è¿œéƒ½ä¼šå¼•å‘é‡æ–°æ¸²æŸ“ï¼‰ã€‚</p><p><strong>ä¾‹å­1:</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">    View,</div><div class="line">    StyleSheet,</div><div class="line">    TouchableOpacity,</div><div class="line">    ToastAndroid,</div><div class="line">    Platform,</div><div class="line">    Text,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</div><div class="line">    <span class="comment">// æ„é€ </span></div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">        <span class="comment">// åˆå§‹çŠ¶æ€</span></div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            <span class="attr">num</span>: <span class="number">1</span></div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    shouldComponentUpdate() &#123;</div><div class="line">  <span class="comment">//è¿”å› false åˆ™setStateä¸åˆ·æ–°</span></div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> defaultProps = &#123;</div><div class="line">        <span class="attr">add</span>: <span class="number">100</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    componentDidUpdate() &#123;</div><div class="line">        <span class="keyword">if</span>(Platform.OS==<span class="string">'ios'</span>)&#123;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        ToastAndroid.show(<span class="string">""</span>+<span class="keyword">this</span>.state.num,ToastAndroid.SHORT)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;flex:1,justifyContent:</span>'<span class="attr">center</span>',<span class="attr">alignItems:</span> '<span class="attr">center</span>'&#125;&#125;&gt;</span></span></div><div class="line">                <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</div><div class="line">                    this.setState((prevState, props) =&gt; &#123;</div><div class="line">                        return &#123;num: prevState.num + props.add&#125;;</div><div class="line">                    &#125;);</div><div class="line">                &#125;&#125; style=&#123;styles.container&#125;&gt;</div><div class="line">                    <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.text&#125;</span>&gt;</span>&#123;this.state.num&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</div><div class="line"></div><div class="line">    <span class="attr">container</span>: &#123;</div><div class="line">        <span class="attr">backgroundColor</span>: <span class="string">'#00a056'</span>,</div><div class="line">        <span class="attr">paddingRight</span>: <span class="number">70</span>,</div><div class="line">        <span class="attr">paddingTop</span>: <span class="number">10</span>,</div><div class="line">        <span class="attr">paddingBottom</span>: <span class="number">10</span>,</div><div class="line">        <span class="attr">paddingLeft</span>: <span class="number">70</span>,</div><div class="line">        <span class="attr">shadowColor</span>: <span class="string">'#00a056'</span>,</div><div class="line">        <span class="attr">shadowOffset</span>: &#123;<span class="attr">width</span>: <span class="number">3</span>, <span class="attr">height</span>: <span class="number">3</span>&#125;,</div><div class="line">        <span class="attr">shadowOpacity</span>: <span class="number">0.5</span>,</div><div class="line">        <span class="attr">shadowRadius</span>: <span class="number">4</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">text</span>: &#123;</div><div class="line">        <span class="attr">color</span>: <span class="string">'#ffffff'</span>,</div><div class="line">        <span class="attr">fontSize</span>: <span class="number">30</span>,</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><img src="https://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/state.gif" width="600"></p><p><strong>å¦‚ä¸Šå›¾æ•ˆæœï¼š</strong></p><ul><li>shouldComponentUpdate ä¸é‡å†™æˆ–è€…è¿”å›trueï¼Œåˆ™è±¡å·¦ä¾§iosæ¨¡æ‹Ÿå™¨ä¸€æ ·ï¼Œå¯ä»¥ä¿®æ”¹çŠ¶æ€</li><li>è¿”å›falseï¼Œåˆ™ä¸é‡å†™</li><li>å®˜æ–¹ä¸æ¨èæˆ‘ä»¬ä½¿ç”¨setStateçš„ç¬¬äºŒä¸ªå‚æ•°Callbackçš„å½¢å¼è·å–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨componentDidUpdateå›è°ƒä¸­ï¼Œè·å–æœ€æ–°çš„State</li></ul><h3 id="å¦‚ä½•æ­£ç¡®æ“ä½œstate"><a href="#å¦‚ä½•æ­£ç¡®æ“ä½œstate" class="headerlink" title="å¦‚ä½•æ­£ç¡®æ“ä½œstate"></a>å¦‚ä½•æ­£ç¡®æ“ä½œstate</h3><h4 id="ä¸è¦ä½¿ç”¨this-stateæ¥ä¿®æ”¹state"><a href="#ä¸è¦ä½¿ç”¨this-stateæ¥ä¿®æ”¹state" class="headerlink" title="ä¸è¦ä½¿ç”¨this.stateæ¥ä¿®æ”¹state"></a>ä¸è¦ä½¿ç”¨<code>this.state</code>æ¥ä¿®æ”¹<code>state</code></h4><figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// Wrong</div><div class="line">this.<span class="keyword">state</span>.comment = 'Hello';</div></pre></td></tr></table></figure><p>è®°ä½ï¼Œ<code>this.state</code> æ˜¯ä¸å¯å˜çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//äº‹å®è¯æ˜ï¼Œå¹¶æ”¹å˜ä¸äº†</span></div><div class="line">render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;flex:</span> <span class="attr">1</span>, <span class="attr">justifyContent:</span> '<span class="attr">center</span>', <span class="attr">alignItems:</span> '<span class="attr">center</span>'&#125;&#125;&gt;</span></span></div><div class="line">            <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</div><div class="line">                this.state.num = 3</div><div class="line">            &#125;&#125; style=&#123;styles.container&#125;&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.text&#125;</span>&gt;</span>&#123;this.state.num&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line">    )</div></pre></td></tr></table></figure><p>åº”è¯¥è°ƒç”¨ <code>setState()</code> æ–¹æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Correct</span></div><div class="line"><span class="keyword">this</span>.setState(&#123;<span class="attr">comment</span>: <span class="string">'Hello'</span>&#125;);</div><div class="line"><span class="comment">//æˆ–è€…</span></div><div class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</div><div class="line">                        <span class="keyword">return</span> &#123;<span class="attr">num</span>: prevState.num + props.add&#125;;</div><div class="line">                    &#125;);</div><div class="line"><span class="comment">//prevState å¯ä»¥è·å–ä¸Šä¸ªstate æ•°å€¼</span></div><div class="line"><span class="comment">//props å¯ä»¥è·å–å½“å‰propsæ‰€æœ‰æ•°å€¼ï¼Œå¯ä»¥åšä¸€äº›æ“ä½œ</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//ä¸è¦è¿™ä¹ˆä½¿ç”¨</span></div><div class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState, props</span>) =&gt;</span> &#123;</div><div class="line">                        <span class="keyword">return</span> &#123;<span class="attr">num</span>: <span class="keyword">this</span>.state.num+<span class="number">1</span>&#125;;</div><div class="line">                    &#125;);</div><div class="line"><span class="comment">//è€ƒè™‘åˆ°setStateå¯èƒ½æ˜¯å¼‚æ­¥è°ƒç”¨çš„ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨prevStateï¼ˆä¸Šä¸€ä¸ªå€¼ï¼‰ï¼Œè€Œä¸æ˜¯ä¾èµ–this.stateæ¥è®¡ç®—æœ€æ–°çš„stateï¼Œè¿™æ ·å¯èƒ½ä¼šæœ‰è¯¯å·®</span></div></pre></td></tr></table></figure><h4 id="stateçš„æ”¹å˜æ˜¯ä¸€ä¸ªè¦†ç›–ï¼ˆåˆå¹¶ï¼‰è¿‡ç¨‹"><a href="#stateçš„æ”¹å˜æ˜¯ä¸€ä¸ªè¦†ç›–ï¼ˆåˆå¹¶ï¼‰è¿‡ç¨‹" class="headerlink" title="stateçš„æ”¹å˜æ˜¯ä¸€ä¸ªè¦†ç›–ï¼ˆåˆå¹¶ï¼‰è¿‡ç¨‹"></a>stateçš„æ”¹å˜æ˜¯ä¸€ä¸ªè¦†ç›–ï¼ˆåˆå¹¶ï¼‰è¿‡ç¨‹</h4><p>å½“ä½ è°ƒç”¨ <code>setState()</code> æ–¹æ³•æ—¶ï¼ŒReact ä¼šå°†å°†ä½ å½“å‰æ‰€æä¾›çš„å¯¹è±¡åˆå¹¶åˆ°å½“å‰çš„çŠ¶æ€ä¸­ã€‚</p><p><strong>ä¾‹å­1:</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      <span class="attr">posts</span>: [],</div><div class="line">      <span class="attr">comments</span>: []</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">componentDidMount() &#123;</div><div class="line"></div><div class="line">    fetchComments().then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">this</span>.setState(&#123;</div><div class="line">        <span class="attr">comments</span>: response.comments</div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div></pre></td></tr></table></figure><p>â¬†é¢çš„æ —å­ï¼Œstateæ›´æ–°è‡³æ›¿æ¢äº†commentsï¼Œpostsä¸å—å½±å“</p><h3 id="stateä¼ é€’ï¼Ÿ"><a href="#stateä¼ é€’ï¼Ÿ" class="headerlink" title="stateä¼ é€’ï¼Ÿ"></a>stateä¼ é€’ï¼Ÿ</h3><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ä¹‹é—´ä¸èƒ½é€šè¿‡ state æ¥äº¤äº’ï¼Œçˆ¶ç»„ä»¶åªèƒ½å°†è‡ªå·±çš„ state å€¼ä¼ ç»™å­ç»„ä»¶çš„ propsã€‚</li></ul><ul><li>è¿™ç§æ•°æ®ä¼ é€’çš„æ–¹å¼é€šå¸¸è¢«ç§°ä¸º â€œè‡ªé¡¶å‘ä¸‹ï¼ˆtop-downï¼‰â€æˆ–è€…â€œå•å‘ï¼ˆunidirectionalï¼‰â€æ•°æ®æµã€‚</li><li>ä»»ä½•stateéƒ½æ˜¯ç”±ä¸€ä¸ªç‰¹å®šçš„ç»„ä»¶æ‰€æ‹¥æœ‰çš„ï¼Œä»»ä½•stateæ•°æ®ä¿®æ”¹é»˜è®¤åªä¼šå½±å“å½“å‰ç»„ä»¶ï¼Œ</li><li>å¯ä»¥é€šè¿‡å›è°ƒä¼ å€¼ï¼ˆåé¢ä¼šæ•´ç†ï¼‰</li></ul><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.jianshu.com/p/583473c37db9" target="_blank" rel="external">[ã€1ã€‘React Native] React ä¸­çš„çŠ¶æ€ï¼ˆStateï¼‰</a></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=455304006&auto=1&height=32"></iframe>]]></content>
      
      <categories>
          
          <category> RN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RN </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>^_^å¤æ—¥ï½</title>
      <link href="/2018/07/28/%E5%A4%8F%E6%97%A5/"/>
      <content type="html"><![CDATA[<p><strong>å¤æ—¥çš„å¤œæ™š</strong></p><p>å¤æ—¥çš„å¤œæ™šï¼ŒçŒ«ååœ¨åºŠè¾¹</p><p>ä½ å¹ç€å¤´å‘ï¼Œä¸è¯´è¯å°±å¾ˆç”œ</p><p>æƒ³å’Œä½ ä¸€èµ·çœ‹æ˜Ÿç©ºï¼Œåªè°ˆå¤œè‰²å’Œå¾®é£</p><p>æ²¡æœ‰å·¥ä½œï¼Œæ²¡æœ‰æ—©èµ·</p><p>åªæœ‰ç”œç”œçš„æ¢¦</p><p>å’Œæ¢¦é‡Œçš„ä½  ^_^ ï½</p>]]></content>
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Rxjava2.0-çŸ¥è¯†ç¢ç‰‡ï¼ˆä¸‰ï¼‰</title>
      <link href="/2018/07/24/Rxjava2-0-%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87%EF%BC%88%E4%B8%89%EF%BC%89/"/>
      <content type="html"><![CDATA[<p>åŸºäºRxjava2.0çš„æ“ä½œç¬¦å°ç»“</p><a id="more"></a><h1 id="ä¸€ï¼šåˆ›å»ºç›¸å…³"><a href="#ä¸€ï¼šåˆ›å»ºç›¸å…³" class="headerlink" title="ä¸€ï¼šåˆ›å»ºç›¸å…³"></a>ä¸€ï¼šåˆ›å»ºç›¸å…³</h1><h3 id="creatæ“ä½œç¬¦"><a href="#creatæ“ä½œç¬¦" class="headerlink" title="creatæ“ä½œç¬¦"></a>creatæ“ä½œç¬¦</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;<span class="built_in">String</span>&gt;() &#123;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> <span class="built_in">void</span> call(Subscriber&lt;? <span class="keyword">super</span> <span class="built_in">String</span>&gt; subscriber) &#123;</div><div class="line"></div><div class="line">            subscriber.onNext(<span class="string">"item1"</span>);</div><div class="line">            subscriber.onNext(<span class="string">"item2"</span>);</div><div class="line">            subscriber.onCompleted();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><h3 id="just"><a href="#just" class="headerlink" title="just"></a>just</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable observable = Observable.just(<span class="string">"Hello"</span>, <span class="string">"Hi"</span>, <span class="string">"Aloha"</span>);</div><div class="line"><span class="regexp">//</span> å°†ä¼šä¾æ¬¡è°ƒç”¨ï¼š</div><div class="line"><span class="regexp">//</span> onNext(<span class="string">"Hello"</span>);</div><div class="line"><span class="regexp">//</span> onNext(<span class="string">"Hi"</span>);</div><div class="line"><span class="regexp">//</span> onNext(<span class="string">"Aloha"</span>);</div><div class="line"><span class="regexp">//</span> onCompleted();</div></pre></td></tr></table></figure><h3 id="from"><a href="#from" class="headerlink" title="from"></a>from</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">String[] words = &#123;<span class="string">"Hello"</span>, <span class="string">"Hi"</span>, <span class="string">"Aloha"</span>&#125;;</div><div class="line">Observable observable = Observable.from(words);</div><div class="line"><span class="comment">// å°†ä¼šä¾æ¬¡è°ƒç”¨ï¼š</span></div><div class="line"><span class="comment">// onNext("Hello");</span></div><div class="line"><span class="comment">// onNext("Hi");</span></div><div class="line"><span class="comment">// onNext("Aloha");</span></div><div class="line"><span class="comment">// onCompleted();</span></div></pre></td></tr></table></figure><h3 id="intervalæ“ä½œç¬¦"><a href="#intervalæ“ä½œç¬¦" class="headerlink" title="intervalæ“ä½œç¬¦"></a>intervalæ“ä½œç¬¦</h3><p>ä¸å¤šbbï¼Œçœ‹ä»¥ä¸‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.interval(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">                .subscribe(<span class="keyword">new</span> Consumer&lt;Long&gt;() &#123;</div><div class="line">                    <span class="keyword">public</span> Disposable mDisposable;</div><div class="line"></div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Long aLong)</span> </span>&#123;</div><div class="line">                        <span class="keyword">if</span> (aLong == <span class="number">10</span>) &#123;</div><div class="line">                            mDisposable.dispose();</div><div class="line">                        &#125;</div><div class="line">                        System.out.println(<span class="string">"è®¡æ—¶å™¨"</span> + aLong);</div><div class="line">                    &#125;</div><div class="line">                &#125;, throwable -&gt; &#123;</div><div class="line"></div><div class="line">                &#125;, () -&gt; &#123;</div><div class="line">                    System.out.println(<span class="string">"action"</span>);</div><div class="line">                &#125;, disposable -&gt; mDisposable = disposable);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">52.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">0</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">53.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">1</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">54.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">2</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">55.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">3</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">56.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">4</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">57.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">5</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">58.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">6</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">24</span>:<span class="number">59.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">7</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">25</span>:<span class="number">00.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">8</span></div><div class="line"><span class="number">07</span>-<span class="number">24</span> <span class="number">11</span>:<span class="number">25</span>:<span class="number">01.718</span> <span class="number">12306</span>-<span class="number">12332</span>/com.fengandev.rxjavademo I/System.out: è®¡æ—¶å™¨<span class="number">9</span></div></pre></td></tr></table></figure><p>å¯ä»¥ç®€æ˜“çš„å°è£…ï¼Œè·å–ä¸€ä¸ªå€’è®¡æ—¶Observable</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * äº§ç”Ÿä¸€ä¸ªå€’è®¡æ—¶çš„ Observable</div><div class="line">     * <span class="doctag">@param</span> time</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> Observable&lt;Long&gt; <span class="title">countdown</span><span class="params">(<span class="keyword">final</span> <span class="keyword">long</span> time)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Observable.interval(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">                .map(<span class="keyword">new</span> Function&lt;Long, Long&gt;() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> Long <span class="title">apply</span><span class="params">(@NonNull Long aLong)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                        <span class="keyword">return</span> time - aLong;</div><div class="line">                    &#125;</div><div class="line">                &#125;).take( time + <span class="number">1</span> );</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">//ä½¿ç”¨</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        countdown(<span class="number">10</span>).subscribe(<span class="keyword">new</span> Consumer&lt;Long&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Long aLong)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                System.out.println(<span class="string">"å€’è®¡æ—¶"</span>+aLong);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><h3 id="rangeæ“ä½œç¬¦"><a href="#rangeæ“ä½œç¬¦" class="headerlink" title="rangeæ“ä½œç¬¦"></a>rangeæ“ä½œç¬¦</h3><p>range å‘å°„ç‰¹å®šæ•´æ•°åºåˆ—çš„ Observable</p><ul><li>range( int start , int end ) //start :å¼€å§‹çš„å€¼ ï¼Œ end ï¼šç»“æŸçš„å€¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> Observable.range(<span class="number">0</span>,<span class="number">5</span>)</div><div class="line">                .subscribe(integer -&gt; System.out.println(integer));</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div></pre></td></tr></table></figure><p>è€è§„çŸ©ï¼ŒåŒ…å‰ä¸åŒ…å</p><h3 id="emptyå’Œerrorå’Œnever"><a href="#emptyå’Œerrorå’Œnever" class="headerlink" title="emptyå’Œerrorå’Œnever"></a>emptyå’Œerrorå’Œnever</h3><p><strong>empty</strong></p><p><code>Observable observable1=Observable.empty();</code>//ç›´æ¥è°ƒç”¨onCompletedã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Observable observable1=Observable.empty();//ç›´æ¥è°ƒç”¨onCompletedã€‚</span></div><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable&lt;String&gt; empty = Observable.empty();</div><div class="line">        empty.subscribe(<span class="keyword">new</span> Observer&lt;String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onSubscribe"</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onNext"</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onError"</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onComplete"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//log:</span></div><div class="line"><span class="comment">//onSubscribe</span></div><div class="line"><span class="comment">//onComplete</span></div></pre></td></tr></table></figure><p><strong>never</strong></p><p><code>Observable observable3=Observable.never();</code>//å•¥éƒ½ä¸åš</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable&lt;String&gt; empty = Observable.never();</div><div class="line">    empty.subscribe(<span class="keyword">new</span> Observer&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onSubscribe"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onNext"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onError"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onComplete"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="comment">//onSubscribe</span></div></pre></td></tr></table></figure><p><strong>error</strong></p><p><code>Observable observable2=Observable.error(new RuntimeException());</code>//ç›´æ¥è°ƒç”¨onErrorã€‚è¿™é‡Œå¯ä»¥è‡ªå®šä¹‰å¼‚å¸¸</p><h2 id="åŠŸèƒ½æ“ä½œ"><a href="#åŠŸèƒ½æ“ä½œ" class="headerlink" title="åŠŸèƒ½æ“ä½œ"></a>åŠŸèƒ½æ“ä½œ</h2><h3 id="mapæ“ä½œç¬¦"><a href="#mapæ“ä½œç¬¦" class="headerlink" title="mapæ“ä½œç¬¦"></a>mapæ“ä½œç¬¦</h3><p>mapæ“ä½œç¬¦ç®—æ˜¯Rxjavaä¸­æœ€ç®€å•çš„ä¸€ä¸ªæ“ä½œç¬¦äº†ï¼Œåœ¨2.xä¸­çš„ç”¨æ³•å’Œ1.xå·®ä¸å¤šï¼›å®ƒçš„ä½œç”¨å°±æ˜¯å¯¹å‘å°„çš„æ¯ä¸€ä¸ªäº‹ä»¶åº”ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œæ¯ä¸€ä¸ªäº‹ä»¶éƒ½æŒ‰ç…§mapæ“ä½œç¬¦æŒ‡å®šçš„å‡½æ•°å»å˜åŒ–è½¬æ¢ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªæ —å­ğŸŒ°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;Integer&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;Integer&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                emitter.onNext(<span class="number">1</span>);</div><div class="line">                emitter.onNext(<span class="number">2</span>);</div><div class="line">                emitter.onNext(<span class="number">3</span>);</div><div class="line">                emitter.onComplete();</div><div class="line">            &#125;</div><div class="line">        &#125;).map(<span class="keyword">new</span> Function&lt;Integer, String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                Log.e(<span class="string">"fengan"</span>, <span class="string">"apply----&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                <span class="keyword">return</span> <span class="string">"this is value = "</span> + integer;</div><div class="line">            &#125;</div><div class="line">        &#125;).subscribeOn(Schedulers.single())</div><div class="line"><span class="comment">//                .observeOn(Schedulers.single())</span></div><div class="line">                .subscribe(<span class="keyword">new</span> Consumer&lt;String&gt;() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                        Log.e(<span class="string">"fengan"</span>, <span class="string">"accept----&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                        Log.e(<span class="string">"fengan"</span>, <span class="string">"accept----&gt;"</span> + s);</div><div class="line">                        Log.e(<span class="string">"fengan"</span>,<span class="string">"========"</span>);</div><div class="line"></div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>log</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">apply----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;<span class="keyword">this</span> is value = <span class="number">1</span></div><div class="line">========</div><div class="line">apply----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;<span class="keyword">this</span> is value = <span class="number">2</span></div><div class="line">========</div><div class="line">apply----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">accept----&gt;<span class="keyword">this</span> is value = <span class="number">3</span></div><div class="line">========</div></pre></td></tr></table></figure><p>ä»è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬èƒ½çœ‹å‡º</p><ul><li>æˆ‘ä»¬å‘å°„çš„integeräº‹ä»¶ï¼Œè¢«è½¬æ¢ä¸ºStringï¼Œç»§ç»­è¿›è¡Œ</li><li>æˆ‘ä»¬ä¹Ÿé¡ºä¾¿éªŒè¯äº†ä¸¤ä¸ªé—®é¢˜ï¼ˆåœ¨ç¢ç‰‡åŒ–2æ•´ç†çš„çº¿ç¨‹è°ƒåº¦ï¼‰<ul><li>åªæŒ‡å®š<code>subscribeOn</code>æœªæŒ‡å®š<code>observeOn</code>çš„æƒ…å†µä¸‹ï¼Œè§‚å¯Ÿè€…çš„äº‹ä»¶çš„æ¥å—ï¼ˆä¸‹æ¸¸ï¼‰æŒ‰ç…§<code>subscribeOn</code>æŒ‡å®šçš„çº¿ç¨‹è¿›è¡Œ</li><li><code>Schedulers.single()</code>æ˜¯åœ¨æŒ‡å®šçº¿ç¨‹ä¸­æŒ‰ç…§é˜Ÿåˆ—çš„å½¢å¼è¿›è¡Œï¼Œå…ˆè¿›å…ˆå‡ºï¼ˆä½“ç°åœ¨ï¼šä¸€ä¸ªäº‹ä»¶å‘å¸ƒå’Œæ¥å—å®Œæ¯•åï¼Œæ‰å‘é€ç¬¬äºŒä¸ªäº‹ä»¶ï¼‰</li></ul></li></ul><h3 id="debounceæ“ä½œç¬¦"><a href="#debounceæ“ä½œç¬¦" class="headerlink" title="debounceæ“ä½œç¬¦"></a>debounceæ“ä½œç¬¦</h3><p><code>debounce</code>ï¼šé˜²æŠ–ï¼›</p><p>only emit an item from an Observable if a particular time-span has passed without it emitting another item,</p><p>å½“ä¸€ä¸ªäº‹ä»¶å‘é€å‡ºæ¥ä¹‹åï¼Œåœ¨çº¦å®šæ—¶é—´å†…æ²¡æœ‰å†æ¬¡å‘é€è¿™ä¸ªäº‹ä»¶ï¼Œåˆ™å‘å°„è¿™ä¸ªäº‹ä»¶ï¼Œå¦‚æœå†æ¬¡è§¦å‘äº†ï¼Œåˆ™é‡æ–°è®¡ç®—æ—¶é—´ã€‚</p><p><a href="https://www.jianshu.com/p/ee1f0d21a856" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"> Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;Integer&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;Integer&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                <span class="comment">// send events with simulated time wait</span></div><div class="line">                emitter.onNext(<span class="number">1</span>); <span class="comment">// skip</span></div><div class="line">                Thread.sleep(<span class="number">400</span>);</div><div class="line">                emitter.onNext(<span class="number">2</span>); <span class="comment">// deliver</span></div><div class="line">                Thread.sleep(<span class="number">505</span>);</div><div class="line">                emitter.onNext(<span class="number">3</span>); <span class="comment">// skip</span></div><div class="line">                Thread.sleep(<span class="number">100</span>);</div><div class="line">                emitter.onNext(<span class="number">4</span>); <span class="comment">// deliver</span></div><div class="line">                Thread.sleep(<span class="number">605</span>);</div><div class="line">                emitter.onNext(<span class="number">5</span>); <span class="comment">// deliver</span></div><div class="line">                Thread.sleep(<span class="number">510</span>);</div><div class="line">                emitter.onComplete();</div><div class="line">            &#125;</div><div class="line">        &#125;).debounce(<span class="number">500</span>,TimeUnit.MILLISECONDS)</div><div class="line">            .subscribe(<span class="keyword">new</span> Consumer&lt;Integer&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                    System.out.println(integer);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line"><span class="comment">//2</span></div><div class="line"><span class="comment">//4</span></div><div class="line"><span class="comment">//5</span></div></pre></td></tr></table></figure><h3 id="onTerminateDetachæ“ä½œç¬¦"><a href="#onTerminateDetachæ“ä½œç¬¦" class="headerlink" title="onTerminateDetachæ“ä½œç¬¦"></a>onTerminateDetachæ“ä½œç¬¦</h3><p><a href="https://blog.csdn.net/johnny901114/article/details/67640594" target="_blank" rel="external">Rxjavaå¯¼è‡´å†…å­˜æ³„æ¼çš„é—®é¢˜</a></p><p><a href="https://blog.csdn.net/johnny901114/article/details/67640594" target="_blank" rel="external">ä¸€å¼ å›¾æå®š-RxJava2çš„çº¿ç¨‹åˆ‡æ¢åŸç†å’Œå†…å­˜æ³„éœ²é—®é¢˜</a></p><p>çœ‹å®Œè¿™ä¸¤ä¸ªå‚è€ƒé“¾æ¥ï¼ŒåŸºæœ¬ä¹Ÿå°±çŸ¥é“äº†onTerminateDetachçš„ä½¿ç”¨æ–¹æ³•å’Œä½œç”¨</p><h3 id="deferæ“ä½œç¬¦"><a href="#deferæ“ä½œç¬¦" class="headerlink" title="deferæ“ä½œç¬¦"></a>deferæ“ä½œç¬¦</h3><p>åªæœ‰å½“è®¢é˜…è€…è®¢é˜…æ‰åˆ›å»ºObservableï¼Œä¸ºæ¯ä¸ªè®¢é˜…åˆ›å»ºä¸€ä¸ªæ–°çš„Observableã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable.defer(<span class="keyword">new</span> Callable&lt;ObservableSource&lt;Integer&gt;&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> ObservableSource&lt;Integer&gt; <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            <span class="keyword">return</span> Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;).subscribe(<span class="keyword">new</span> Consumer&lt;Integer&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            System.out.println(integer);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure><h3 id="flatMapæ“ä½œç¬¦"><a href="#flatMapæ“ä½œç¬¦" class="headerlink" title="flatMapæ“ä½œç¬¦"></a>flatMapæ“ä½œç¬¦</h3><p>æŠŠä¸€ä¸ªå‘å°„å™¨<code>Observable</code> é€šè¿‡æŸç§æ–¹æ³•è½¬æ¢ä¸ºå¤šä¸ª<code>Observables</code>ï¼Œç„¶åå†æŠŠè¿™äº›åˆ†æ•£çš„<code>Observables</code>è£…è¿›ä¸€ä¸ªå•ä¸€çš„å‘å°„å™¨<code>Observable</code>ã€‚ä½†æœ‰ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>flatMap</code>å¹¶ä¸èƒ½ä¿è¯äº‹ä»¶çš„é¡ºåºï¼Œå¦‚æœéœ€è¦ä¿è¯ï¼Œéœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¸‹é¢è¦è®²çš„<code>ConcatMap</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;Integer&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;Integer&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            emitter.onNext(<span class="number">1</span>);</div><div class="line">            emitter.onNext(<span class="number">2</span>);</div><div class="line">            emitter.onNext(<span class="number">3</span>);</div><div class="line">            emitter.onComplete();</div><div class="line">        &#125;</div><div class="line">    &#125;).flatMap(<span class="keyword">new</span> Function&lt;Integer, ObservableSource&lt;String&gt;&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> ObservableSource&lt;String&gt; <span class="title">apply</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            List&lt;String&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">            res.add(<span class="string">"i am value ="</span> + integer);</div><div class="line">            Log.e(<span class="string">"fengan"</span>,<span class="string">"flatMap size"</span>+res.size());</div><div class="line">            <span class="keyword">return</span> Observable.fromIterable(res);</div><div class="line">        &#125;</div><div class="line">    &#125;).subscribe(<span class="keyword">new</span> Consumer&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            Log.e(<span class="string">"fengan"</span>,<span class="string">"accept="</span>+s);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>log</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">flatMap size1</div><div class="line"><span class="attr">accept=i</span> am <span class="attr">value</span> =<span class="number">1</span></div><div class="line">   flatMap size1</div><div class="line">   <span class="attr">accept=i</span> am <span class="attr">value</span> =<span class="number">2</span></div><div class="line">   flatMap size1</div><div class="line">   <span class="attr">accept=i</span> am <span class="attr">value</span> =<span class="number">3</span></div></pre></td></tr></table></figure><p><strong>ç»“è®º</strong></p><ul><li>éªŒè¯äº†æˆ‘ä¹‹å‰çš„ä¸€ä¸ªè¯¯åŒºï¼ˆsizeå¤§å°ä¸€ç›´ä¸º1ï¼‰ï¼šè¯¯ä»¥ä¸ºæ‰€æœ‰äº‹ä»¶å‘é€å®Œæ¯•ä¹‹åï¼Œåœ¨flatmapç»Ÿä¸€å¤„ç†ï¼Œå…¶å®ä¸æ˜¯ï¼Œäº‹ä»¶æºæ¯å‘å°„ä¸€ä¸ªäº‹ä»¶ï¼Œ<code>flatmap</code>å°±å¤„ç†è½¬æ¢ä¸€ä¸ªäº‹ä»¶</li><li><code>flatMap</code>çš„ä½œç”¨æ˜¯ï¼Œæ¥å—ä¸€ä¸ªäº‹ä»¶ï¼Œä½œå‡ºå¤„ç†å®Œä¹‹åï¼Œé‡æ–°å‘å°„ä¸€ä¸ªæ–°çš„äº‹ä»¶</li></ul><p>åˆšæ‰è¯´åˆ°<code>flatMap</code>å¹¶ä¸èƒ½ä¿è¯äº‹ä»¶çš„é¡ºåºï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­å°±æ˜ç™½äº†</p><h3 id="concatMapæ“ä½œç¬¦"><a href="#concatMapæ“ä½œç¬¦" class="headerlink" title="concatMapæ“ä½œç¬¦"></a>concatMapæ“ä½œç¬¦</h3><p>flatMapæ“ä½œç¬¦å¯ä»¥å°†ä¸€ä¸ª<code>Observable</code>è½¬æ¢ä¸ºå¦ä¸€ä¸ª<code>Observable</code>å‘å°„å‡ºå»,å¹¶ä¸”å¯ä»¥å°†å¤šä¸ªäº‹ä»¶è½¬åŒ–ä¸º1ä¸ªï¼Œä½†æ˜¯æœ€åè¾“å‡ºçš„äº‹ä»¶åºåˆ—é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œå¦‚æœæƒ³è¦æœ€åè¾“å‡ºçš„äº‹ä»¶é¡ºåºå’Œæºæ•°æ®çš„é¡ºåºä¸€è‡´åªè¦æ¢æˆ<code>concatMap</code>å°±å¯ä»¥äº†ã€‚<br>flatMapå’ŒMapæ“ä½œç¬¦çš„ä¸åŒæ˜¯mapä¸€æ¬¡åªèƒ½è½¬æ¢ä¸€ä¸ªäº‹ä»¶ã€‚</p><p>å…ˆçœ‹ä¸€ä¸ª<code>flatmap</code>çš„ä½¿ç”¨ä¾‹å­ï¼Œå¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Observable.create((ObservableOnSubscribe&lt;Integer&gt;) emitter -&gt; &#123;</div><div class="line">           emitter.onNext(<span class="number">1</span>);</div><div class="line">           emitter.onNext(<span class="number">2</span>);</div><div class="line">           emitter.onNext(<span class="number">3</span>);</div><div class="line">           emitter.onComplete();</div><div class="line">       &#125;).subscribeOn(Schedulers.io()).flatMap((Function&lt;Integer, ObservableSource&lt;String&gt;&gt;) integer -&gt; &#123;</div><div class="line">           List&lt;String&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</div><div class="line">               res.add(<span class="string">"I am value "</span> + integer);</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">int</span> delayTime = (<span class="keyword">int</span>) (<span class="number">1</span> + Math.random() * <span class="number">10</span>);</div><div class="line">           <span class="keyword">return</span> Observable.fromIterable(res).delay(delayTime, TimeUnit.MILLISECONDS);</div><div class="line">       &#125;).subscribe(s -&gt; Log.e(<span class="string">"fengan"</span>, <span class="string">"accept="</span> + s));</div></pre></td></tr></table></figure><p>log</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">accept=I am value <span class="number">3</span></div><div class="line">accept=I am value <span class="number">3</span></div><div class="line">accept=I am value <span class="number">2</span></div><div class="line">accept=I am value <span class="number">2</span></div><div class="line">accept=I am value <span class="number">2</span></div><div class="line">accept=I am value <span class="number">3</span></div><div class="line">accept=I am value <span class="number">1</span></div><div class="line">accept=I am value <span class="number">1</span></div><div class="line">accept=I am value <span class="number">1</span></div></pre></td></tr></table></figure><p>å¯è§ä¸æ˜¯æŒ‰ç…§æºæ•°æ®åˆ°é¡ºåºä¸€è‡´ï¼Œè‹¥æƒ³ä¸€è‡´ä½¿ç”¨<code>concatMap</code>å°±å¯ä»¥äº†</p><h3 id="repeatæ“ä½œç¬¦"><a href="#repeatæ“ä½œç¬¦" class="headerlink" title="repeatæ“ä½œç¬¦"></a>repeatæ“ä½œç¬¦</h3><p>repeat é‡å¤åœ°å‘å°„æ•°æ®</p><ul><li>repeat( ) //æ— é™é‡å¤</li><li>repeat( int time ) //è®¾å®šé‡å¤çš„æ¬¡æ•°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">                .repeat(<span class="number">3</span>)</div><div class="line">                .subscribe(integer -&gt; System.out.println(integer));</div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure><h3 id="fromArrayå’ŒfromIterbleæ“ä½œç¬¦"><a href="#fromArrayå’ŒfromIterbleæ“ä½œç¬¦" class="headerlink" title="fromArrayå’ŒfromIterbleæ“ä½œç¬¦"></a>fromArrayå’ŒfromIterbleæ“ä½œç¬¦</h3><p>ä¸€ä¸ªæ˜¯å‘å°„ä¸€ä¸ªæ•°ç»„ä¸€ä¸ªæ˜¯å‘å°„ä¸€ä¸ªé›†åˆ</p><h3 id="toList"><a href="#toList" class="headerlink" title="toList"></a>toList</h3><p>å°†æ•°ç»„è½¬æ¢ä¸ºé›†åˆ</p><h3 id="delayæ“ä½œç¬¦"><a href="#delayæ“ä½œç¬¦" class="headerlink" title="delayæ“ä½œç¬¦"></a>delayæ“ä½œç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                .delay(<span class="number">3</span>, TimeUnit.SECONDS)</div><div class="line">                .observeOn(Schedulers.io())</div><div class="line">                .subscribe(integer -&gt; &#123;</div><div class="line">                    <span class="keyword">int</span> a = integer;</div><div class="line">                    System.out.println(a);</div><div class="line">                &#125;);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//æ³¨æ„ï¼šå»¶è¿Ÿ3ç§’é’Ÿï¼Œç„¶ååœ¨å‘å°„æ•°æ®</span></div><div class="line"><span class="comment">//æ˜¯å»¶è¿Ÿä¸‰ç§’ï¼Œå‘é€1ï¼Œ2ï¼Œ3æ•°æ®</span></div><div class="line"><span class="comment">//è€Œä¸æ˜¯--å»¶è¿Ÿ3ç§’--å‘é€1--å»¶è¿Ÿ3ç§’---å‘é€2</span></div></pre></td></tr></table></figure><ul><li>æ˜¯å»¶è¿Ÿä¸‰ç§’ï¼Œå‘é€1ï¼Œ2ï¼Œ3æ•°æ®</li><li>è€Œä¸æ˜¯â€“å»¶è¿Ÿ3ç§’â€“å‘é€1â€“å»¶è¿Ÿ3ç§’â€”å‘é€2</li></ul><p>è‹¥æƒ³è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œå¯ä»¥ç±»ä¼¼è¿™ä¹ˆåš</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                .concatMap(<span class="keyword">new</span> Function&lt;Integer, ObservableSource&lt;Integer&gt;&gt;() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> ObservableSource&lt;Integer&gt; <span class="title">apply</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                        <span class="keyword">return</span> Observable.just(integer) .delay(<span class="number">3</span>, TimeUnit.SECONDS);</div><div class="line">                        </div><div class="line">                    &#125;</div><div class="line">                &#125;)</div><div class="line">                .subscribe(integer -&gt; System.out.println(integer));</div><div class="line">    &#125;</div><div class="line"><span class="comment">//--å»¶è¿Ÿä¸‰ç§’---å‘é€1---å»¶è¿Ÿä¸‰ç§’---å‘é€2---å»¶è¿Ÿ3ç§’---å‘é€3</span></div></pre></td></tr></table></figure><h3 id="doOnNextæ“ä½œç¬¦"><a href="#doOnNextæ“ä½œç¬¦" class="headerlink" title="doOnNextæ“ä½œç¬¦"></a>doOnNextæ“ä½œç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;Integer&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;Integer&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            emitter.onNext(<span class="number">1</span>);</div><div class="line">            emitter.onNext(<span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;).doOnNext(<span class="keyword">new</span> Consumer&lt;Integer&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            System.out.println(<span class="string">"å‰ç½®æ“ä½œ"</span> + integer);</div><div class="line">            integer+=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">            .subscribe(System.out::println);</div><div class="line">&#125;</div><div class="line"><span class="comment">//log</span></div><div class="line">å‰ç½®æ“ä½œ<span class="number">1</span></div><div class="line"><span class="number">1</span></div><div class="line">å‰ç½®æ“ä½œ<span class="number">2</span></div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure><p>åœ¨æ¯æ¬¡ OnNext() æ–¹æ³•è¢«è°ƒç”¨å‰æ‰§è¡Œ</p><p>ä½¿ç”¨åœºæ™¯ï¼šä»ç½‘ç»œè¯·æ±‚æ•°æ®ï¼Œåœ¨æ•°æ®è¢«å±•ç¤ºå‰ï¼Œç¼“å­˜åˆ°æœ¬åœ°</p><h2 id="åˆå¹¶æ“ä½œ"><a href="#åˆå¹¶æ“ä½œ" class="headerlink" title="åˆå¹¶æ“ä½œ"></a>åˆå¹¶æ“ä½œ</h2><h3 id="concatæ“ä½œç¬¦"><a href="#concatæ“ä½œç¬¦" class="headerlink" title="concatæ“ä½œç¬¦"></a>concatæ“ä½œç¬¦</h3><p>æŒ‰é¡ºåºè¿æ¥å¤šä¸ªObservablesã€‚éœ€è¦æ³¨æ„çš„æ˜¯Observable.concat(a,b)ç­‰ä»·äºa.concatWith(b)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Observable&lt;Integer&gt; observable1=Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</div><div class="line">    Observable&lt;Integer&gt;  observable2=Observable.just(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>);</div><div class="line"></div><div class="line">    Observable.concat(observable1,observable2)</div><div class="line">            .subscribe(item-&gt;Log.d(<span class="string">"JG"</span>,item.toString()));<span class="comment">//1,2,3,4,4,5,6</span></div></pre></td></tr></table></figure><h3 id="startWithæ“ä½œç¬¦"><a href="#startWithæ“ä½œç¬¦" class="headerlink" title="startWithæ“ä½œç¬¦"></a>startWithæ“ä½œç¬¦</h3><p>åœ¨æ•°æ®åºåˆ—çš„å¼€å¤´å¢åŠ ä¸€é¡¹æ•°æ®ã€‚startWithçš„å†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨äº†concat</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">           .startWith(<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>)</div><div class="line">   .subscribe(item-&gt;Log.d(<span class="string">"JG"</span>,item.toString()));<span class="comment">//6,7,8,1,2,3,4,5</span></div></pre></td></tr></table></figure><h3 id="mergeæ“ä½œç¬¦"><a href="#mergeæ“ä½œç¬¦" class="headerlink" title="mergeæ“ä½œç¬¦"></a>mergeæ“ä½œç¬¦</h3><p>åˆå¹¶è¢«è§‚å¯Ÿè€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> String[] aStrings = &#123;<span class="string">"A1"</span>, <span class="string">"A2"</span>, <span class="string">"A3"</span>, <span class="string">"A4"</span>&#125;;</div><div class="line">        <span class="keyword">final</span> String[] bStrings = &#123;<span class="string">"B1"</span>, <span class="string">"B2"</span>, <span class="string">"B3"</span>&#125;;</div><div class="line"></div><div class="line">        <span class="keyword">final</span> Observable&lt;String&gt; aObservable = Observable.fromArray(aStrings);</div><div class="line">        <span class="keyword">final</span> Observable&lt;String&gt; bObservable = Observable.fromArray(bStrings);</div><div class="line"></div><div class="line">        Observable.merge(aObservable, bObservable)<span class="comment">//ä½¿ç”¨mergeæ“ä½œç¬¦å°†ä¸¤ä¸ªè¢«è§‚å¯Ÿè€…åˆå¹¶</span></div><div class="line">                .subscribe(getObserver());<span class="comment">//è¿™é‡Œçš„è§‚å¯Ÿè€…ä¾ç„¶ä¸é‡è¦</span></div><div class="line"><span class="comment">//"A1", "B1", "A2", "A3", "A4", "B2", "B3"</span></div></pre></td></tr></table></figure><p>æ“ä½œç¬¦mergeå°†ä¸¤ä¸ªè¢«è§‚å¯Ÿè€…åˆå¹¶,è¿™é‡Œè¦æ³¨æ„mergeä¹‹åçš„Observableæ˜¯ä¸èƒ½ä¿è¯å’ŒåŸæ¥çš„Observableå‘å°„é¡ºåºç›¸åŒ.</p><h3 id="Zipæ“ä½œç¬¦"><a href="#Zipæ“ä½œç¬¦" class="headerlink" title="Zipæ“ä½œç¬¦"></a>Zipæ“ä½œç¬¦</h3><p>zipæˆ‘ä»¬æƒ³åˆ°â€å‹ç¼©â€œï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæ“ä½œç¬¦æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œè¯·çœ‹ä¸‹é¢å›¾ç‰‡</p><p><img src="https://upload-images.jianshu.io/upload_images/1931185-14134e499db9d0c4.png?imageMogr2/auto-orient/" alt="Zip"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.zip(Observable.just(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>), Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>), <span class="keyword">new</span> BiFunction&lt;String, Integer, String&gt;() &#123;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(String s, Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                <span class="keyword">return</span> s+integer;</div><div class="line">            &#125;</div><div class="line">        &#125;).subscribe(s -&gt; System.out.println(<span class="string">"value="</span> + s));</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>log</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">value=A1</div><div class="line">value=B2</div><div class="line">value=C3</div></pre></td></tr></table></figure><p>ç»“è®ºï¼š</p><ul><li>zip ç»„åˆäº‹ä»¶çš„è¿‡ç¨‹å°±æ˜¯åˆ†åˆ«ä»å‘å°„å™¨Aå’Œå‘å°„å™¨Bå„å–å‡ºä¸€ä¸ªäº‹ä»¶æ¥ç»„åˆï¼Œå¹¶ä¸”ä¸€ä¸ªäº‹ä»¶åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ï¼Œç»„åˆçš„é¡ºåºæ˜¯ä¸¥æ ¼æŒ‰ç…§äº‹ä»¶å‘é€çš„é¡ºåºæ¥è¿›è¡Œçš„ï¼Œæ‰€ä»¥ä¸Šé¢æˆªå›¾ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ1æ°¸è¿œæ˜¯å’ŒA ç»“åˆçš„ï¼Œ2æ°¸è¿œæ˜¯å’ŒBç»“åˆçš„ã€‚</li></ul><ul><li>æœ€ç»ˆæ¥æ”¶å™¨æ”¶åˆ°çš„äº‹ä»¶æ•°é‡æ˜¯å’Œå‘é€å™¨å‘é€äº‹ä»¶æœ€å°‘çš„é‚£ä¸ªå‘é€å™¨çš„å‘é€äº‹ä»¶æ•°ç›®ç›¸åŒï¼Œæ‰€ä»¥ä»£ç ä¸­ï¼Œ4å’Œ5æ˜¯æ²¡æœ‰é…å¯¹çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•å‘å°„åˆå¹¶äº‹ä»¶</li></ul><h3 id="combineLatestæ“ä½œç¬¦"><a href="#combineLatestæ“ä½œç¬¦" class="headerlink" title="combineLatestæ“ä½œç¬¦"></a>combineLatestæ“ä½œç¬¦</h3><p>å…ˆçœ‹ä¸€å¼ å›¾ï¼Œæˆ‘æƒ³ä½ åº”è¯¥å·²ç»å¤§è‡´æ˜ç™½æ„æ€äº†</p><p><img src="https://upload-images.jianshu.io/upload_images/1931185-1e60a8bf25b31e91.png?imageMogr2/auto-orient/" alt="combineLatest"></p><p><a href="https://blog.csdn.net/jdsjlzx/article/details/53040293" target="_blank" rel="external">ä½¿ç”¨åœºæ™¯ï¼Œè¡¨å•éªŒè¯</a></p><p>combineLatestæ˜¯RxJavaæœ¬èº«æä¾›çš„ä¸€ä¸ªå¸¸ç”¨çš„æ“ä½œç¬¦ï¼Œå®ƒæ¥å—ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„Observableå’Œä¸€ä¸ªFuncXé—­åŒ…ã€‚å½“ä¼ å…¥çš„Observableä¸­ä»»æ„çš„ä¸€ä¸ªå‘å°„æ•°æ®æ—¶ï¼ŒcombineLatestå°†æ¯ä¸ªObservableçš„æœ€è¿‘å€¼(Lastest)è”åˆèµ·æ¥ï¼ˆcombineï¼‰ä¼ ç»™FuncXé—­åŒ…è¿›è¡Œå¤„ç†ã€‚è¦ç‚¹åœ¨äºï¼š</p><ol><li>combineLatestæ˜¯ä¼šå­˜å‚¨æ¯ä¸ªObservableçš„æœ€è¿‘çš„å€¼çš„</li><li>ä»»æ„ä¸€ä¸ªObservableå‘å°„æ–°å€¼æ—¶éƒ½ä¼šè§¦å‘æ“ä½œ-&gt;â€œcombine all the Observableâ€™s lastest value together and send to Functionâ€</li></ol><p>çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥è¯´æ˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> String[] aStrings = &#123;<span class="string">"A1"</span>, <span class="string">"A2"</span>, <span class="string">"A3"</span>, <span class="string">"A4"</span>&#125;;</div><div class="line">        <span class="keyword">final</span> String[] bStrings = &#123;<span class="string">"B1"</span>, <span class="string">"B2"</span>, <span class="string">"B3"</span>&#125;;</div><div class="line"></div><div class="line">        <span class="keyword">final</span> Observable&lt;String&gt; aObservable = Observable.fromArray(aStrings).delay(<span class="number">1</span>,TimeUnit.MILLISECONDS);</div><div class="line">        <span class="keyword">final</span> Observable&lt;String&gt; bObservable = Observable.fromArray(bStrings);</div><div class="line"></div><div class="line">        Observable.combineLatest(aObservable, bObservable, <span class="keyword">new</span> BiFunction&lt;String, String, String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(String s1, String s2)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                <span class="keyword">return</span> s1+s2;</div><div class="line">            &#125;</div><div class="line">        &#125;).subscribe(<span class="keyword">new</span> Consumer&lt;String&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                System.out.println(s);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="comment">//A1B3</span></div><div class="line"><span class="comment">//A2B3</span></div><div class="line"><span class="comment">//A3B3</span></div><div class="line"><span class="comment">//A4B3</span></div><div class="line">å¯è§ï¼Œå‘é€A1çš„æ—¶å€™B1 B2 B3éƒ½å·²ç»å‘å°„å®Œæ¯•</div><div class="line">æ‰€ä»¥ï¼Œå­˜å‚¨æ¯ä¸ªObservableçš„æœ€è¿‘çš„å€¼çš„ï¼Œä¹Ÿå°±æ˜¯B3</div><div class="line">å½“B1ï¼ŒB2ï¼ŒB3å‘å°„çš„ Aè¢«è§‚å¯Ÿè€…ä¸€ä¸ªéƒ½æ²¡å‘å°„ï¼Œæ‰€ä»¥å¾—è‡³å°‘ä¸¤ä¸ªæ‰ä¼šåˆå¹¶ï¼Œè¿™ä¸ªçœ‹å›¾å¯ä»¥è§£é‡Š</div></pre></td></tr></table></figure><p>##è¿‡æ»¤æ“ä½œ</p><h3 id="takeç­‰æ“ä½œç¬¦"><a href="#takeç­‰æ“ä½œç¬¦" class="headerlink" title="takeç­‰æ“ä½œç¬¦"></a>takeç­‰æ“ä½œç¬¦</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//take å–å‰nä¸ªæ•°æ®</span></div><div class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>)</div><div class="line">        .take(<span class="number">3</span>)</div><div class="line">       .subscribe(System.out::println);</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="comment">//takelast å–ånä¸ªæ•°æ®</span></div><div class="line"> Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</div><div class="line">                .takeLast(<span class="number">3</span>)</div><div class="line">                .subscribe(System.out::println);</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">6</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="comment">//first åªå‘é€ç¬¬ä¸€ä¸ªæ•°æ®  </span></div><div class="line"><span class="comment">//last åªå‘é€æœ€åä¸€ä¸ªæ•°æ®</span></div><div class="line"><span class="comment">//skip() è·³è¿‡å‰nä¸ªæ•°æ®å‘é€åé¢çš„æ•°æ®</span></div><div class="line"><span class="comment">//skipLast() è·³è¿‡æœ€ånä¸ªæ•°æ®ï¼Œå‘é€å‰é¢çš„æ•°æ®</span></div></pre></td></tr></table></figure><h3 id="filteræ“ä½œç¬¦"><a href="#filteræ“ä½œç¬¦" class="headerlink" title="filteræ“ä½œç¬¦"></a>filteræ“ä½œç¬¦</h3><p>é¡¾åæ€ä¹‰ï¼Œè¿‡æ»¤å‘é€çš„äº‹ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRxJava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                .filter(integer -&gt; &#123;</div><div class="line">                    <span class="keyword">if</span> (integer==<span class="number">2</span>) &#123;</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;).subscribe(System.out::println);</div><div class="line">    &#125;</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure><h3 id="ofType"><a href="#ofType" class="headerlink" title="ofType"></a>ofType</h3><p>è¿‡æ»¤æŒ‡å®šç±»å‹çš„æ•°æ®ï¼Œä¸filterç±»ä¼¼ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable.just(<span class="number">1</span>,<span class="string">"1"</span>,-<span class="number">1</span>)</div><div class="line">            .ofType(Integer.class)</div><div class="line">            .subscribe(<span class="keyword">new</span> Consumer&lt;Integer&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                    System.out.println(integer);</div><div class="line">                &#125;</div><div class="line"><span class="comment">//log</span></div><div class="line"><span class="number">1</span></div><div class="line">-<span class="number">1</span></div></pre></td></tr></table></figure><h3 id="firstå’Œlast"><a href="#firstå’Œlast" class="headerlink" title="firstå’Œlast"></a>firstå’Œlast</h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">        .first(<span class="number">2</span>)</div><div class="line">        .subscribe(<span class="literal">new</span> Consumer&lt;<span class="built_in">Integer</span>&gt;() &#123;</div><div class="line">            @Override</div><div class="line">            <span class="keyword">public</span> <span class="literal">void</span> accept(<span class="built_in">Integer</span> <span class="built_in">integer</span>) throws Exception &#123;</div><div class="line">                System.out.println(<span class="built_in">integer</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"><span class="comment">//1</span></div><div class="line"> Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                .last(<span class="number">2</span>)</div><div class="line">                .subscribe(<span class="literal">new</span> Consumer&lt;<span class="built_in">Integer</span>&gt;() &#123;</div><div class="line">                    @Override</div><div class="line">                    <span class="keyword">public</span> <span class="literal">void</span> accept(<span class="built_in">Integer</span> <span class="built_in">integer</span>) throws Exception &#123;</div><div class="line">                        System.out.println(<span class="built_in">integer</span>);</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line"><span class="comment">//3</span></div></pre></td></tr></table></figure><h2 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h2><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p><a href="https://www.jianshu.com/p/d149043d103a" target="_blank" rel="external">æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨ RxJava 2.0ï¼ˆä¸€ï¼‰</a></p><p><a href="https://blog.csdn.net/jdsjlzx/article/details/53040293" target="_blank" rel="external">RxJava combineLatestæ“ä½œç¬¦å¤„ç†å¤æ‚è¡¨å•éªŒè¯é—®é¢˜</a></p><p><a href="https://www.jianshu.com/p/b30de498c3cc" target="_blank" rel="external">Android - RxJava2.0 æ“ä½œç¬¦æ•´ç†å½’çº³</a></p>]]></content>
      
      <categories>
          
          <category> Rxjava </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rxjava </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Rxjava2.0-çŸ¥è¯†ç¢ç‰‡(äºŒ)</title>
      <link href="/2018/07/23/Rxjava2-0-%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <content type="html"><![CDATA[<p>Rxjava2.0ä¸­çš„çº¿ç¨‹è°ƒåº¦å°èŠ‚</p><a id="more"></a><h1 id="Schedulerçš„ç§ç±»"><a href="#Schedulerçš„ç§ç±»" class="headerlink" title="Schedulerçš„ç§ç±»"></a>Schedulerçš„ç§ç±»</h1><p><img src="https://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/schedulers.png" width="25%" height="25%"></p><ul><li><p>Schedulers.io(â€¯)ï¼š</p><p>ç”¨äºIOå¯†é›†å‹çš„æ“ä½œï¼Œä¾‹å¦‚è¯»å†™SDå¡æ–‡ä»¶ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œè®¿é—®ç½‘ç»œç­‰ï¼Œå…·æœ‰çº¿ç¨‹ç¼“å­˜æœºåˆ¶ï¼Œåœ¨æ­¤è°ƒåº¦å™¨æ¥æ”¶åˆ°ä»»åŠ¡åï¼Œå…ˆæ£€æŸ¥çº¿ç¨‹ç¼“å­˜æ± ä¸­ï¼Œæ˜¯å¦æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å¤ç”¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå¹¶åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¦‚æœæ¯æ¬¡éƒ½æ²¡æœ‰ç©ºé—²çº¿ç¨‹ä½¿ç”¨ï¼Œå¯ä»¥æ— ä¸Šé™çš„åˆ›å»ºæ–°çº¿ç¨‹ã€‚</p></li><li><p>Schedulers.newThread(â€¯)ï¼š</p></li></ul><p>åœ¨æ¯æ‰§è¡Œä¸€ä¸ªä»»åŠ¡æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä¸å…·æœ‰çº¿ç¨‹ç¼“å­˜æœºåˆ¶ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¯”å¤ç”¨ä¸€ä¸ªçº¿ç¨‹æ›´è€—æ—¶è€—åŠ›ï¼Œè™½ç„¶ä½¿ç”¨Schedulers.io(â€¯)çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Schedulers.newThread(â€¯)ï¼Œä½†æ˜¯ï¼ŒSchedulers.newThread(â€¯)çš„æ•ˆç‡æ²¡æœ‰Schedulers.io(â€¯)é«˜ã€‚</p><ul><li>Schedulers.computation()ï¼š</li></ul><p>ç”¨äºCPU å¯†é›†å‹è®¡ç®—ä»»åŠ¡ï¼Œå³ä¸ä¼šè¢« I/O ç­‰æ“ä½œé™åˆ¶æ€§èƒ½çš„è€—æ—¶æ“ä½œï¼Œä¾‹å¦‚xml,jsonæ–‡ä»¶çš„è§£æï¼ŒBitmapå›¾ç‰‡çš„å‹ç¼©å–æ ·ç­‰ï¼Œå…·æœ‰å›ºå®šçš„çº¿ç¨‹æ± ï¼Œå¤§å°ä¸ºCPUçš„æ ¸æ•°ã€‚ä¸å¯ä»¥ç”¨äºI/Oæ“ä½œï¼Œå› ä¸ºI/Oæ“ä½œçš„ç­‰å¾…æ—¶é—´ä¼šæµªè´¹CPUã€‚</p><ul><li>Schedulers.trampoline()ï¼š</li></ul><p>åœ¨<strong>å½“å‰çº¿ç¨‹</strong>ç«‹å³æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œåˆ™ä¼šå°†å…¶æš‚åœï¼Œ<strong>ç­‰æ’å…¥è¿›æ¥çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œå†å°†æœªå®Œæˆçš„ä»»åŠ¡æ¥ç€æ‰§è¡Œã€‚</strong></p><ul><li>Schedulers.single()ï¼š</li></ul><p>æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹å•ä¾‹(<strong>æ³¨æ„æ˜¯å­çº¿ç¨‹</strong>)ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½åœ¨è¿™ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå½“æ­¤çº¿ç¨‹ä¸­æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå…¶ä»–ä»»åŠ¡å°†ä¼šæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</p><ul><li>Scheduler.from(@NonNull Executor executor)ï¼š</li></ul><p>æŒ‡å®šä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨ï¼Œç”±æ­¤è°ƒåº¦å™¨æ¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œç­–ç•¥ã€‚</p><ul><li>AndroidSchedulers.mainThread()ï¼š</li></ul><p>åœ¨Android UIçº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡.éœ€è¦æ·»åŠ RxAndroidä¾èµ–</p><blockquote><p>æ³¨æ„</p></blockquote><table><thead><tr><th style="text-align:left">æ–¹å¼</th><th style="text-align:center">å­çº¿ç¨‹</th><th style="text-align:center">ä¸»çº¿ç¨‹</th><th style="text-align:center">å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">Schedulers.io()</td><td style="text-align:center">yes</td><td style="text-align:center">â€“</td><td style="text-align:center">çº¿ç¨‹æ± </td></tr><tr><td style="text-align:left">Schedulers.newThread()</td><td style="text-align:center">yes</td><td style="text-align:center">â€“</td><td style="text-align:center">åˆ›å»ºæ–°çš„</td></tr><tr><td style="text-align:left">Schedulers.computation()</td><td style="text-align:center">yes</td><td style="text-align:center">â€“</td><td style="text-align:center">å ç”¨CPUï¼Œä¸è¦i/oè€—æ—¶</td></tr><tr><td style="text-align:left">Schedulers.trampoline()</td><td style="text-align:center">yes</td><td style="text-align:center">yes</td><td style="text-align:center">å½“å‰çº¿ç¨‹</td></tr><tr><td style="text-align:left">Schedulers.single()</td><td style="text-align:center">yes</td><td style="text-align:center">â€“</td><td style="text-align:center">å›ºå®šä¸€ä¸ªå­çº¿ç¨‹</td></tr><tr><td style="text-align:left">Scheduler.from(@NonNull Executor executor)</td><td style="text-align:center">yes</td><td style="text-align:center">yes</td><td style="text-align:center">æŒ‡å®šçº¿ç¨‹</td></tr><tr><td style="text-align:left">AndroidSchedulers.mainThread()</td><td style="text-align:center">â€“</td><td style="text-align:center">yes</td><td style="text-align:center">ä¸»çº¿ç¨‹ï¼ŒRxAndroid</td></tr></tbody></table><ul><li>åœ¨RxJava2ä¸­ï¼ŒåºŸå¼ƒäº†RxJava1ä¸­çš„Schedulers.immediate(â€¯)</li></ul><ul><li><p>åœ¨RxJava1ä¸­ï¼ŒSchedulers.immediate(â€¯)çš„ä½œç”¨ä¸ºåœ¨å½“å‰çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡ï¼ŒåŠŸèƒ½ç­‰åŒäºRxJava2ä¸­çš„Schedulers.trampoline(â€¯)ï¼Œä¸åŒçš„æ˜¯ï¼ŒSchedulers.trampoline(â€¯)æ˜¯åœä¸‹å½“å‰çš„ä»»åŠ¡ï¼Œå…ˆæ‰§è¡Œæ’å…¥è¿›æ¥çš„ä»»åŠ¡ï¼Œç­‰æ‰§è¡Œå®Œåï¼Œå†å°†æš‚åœçš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p></li><li><p>Schedulers.trampoline(â€¯)åœ¨RxJava1ä¸­çš„ä½œç”¨æ˜¯å½“å…¶å®ƒæ’é˜Ÿçš„ä»»åŠ¡å®Œæˆåï¼Œåœ¨å½“å‰çº¿ç¨‹æ’é˜Ÿå¼€å§‹æ‰§è¡Œæ¥åˆ°çš„ä»»åŠ¡ï¼Œæœ‰ç‚¹åƒRxJava2ä¸­çš„Schedulers.single()ï¼Œä½†ä¹Ÿä¸å®Œå…¨ç›¸åŒï¼Œå› ä¸ºSchedulers.single()ä¸æ˜¯åœ¨å½“å‰çº¿ç¨‹è€Œæ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å•ä¾‹ä¸­æ’é˜Ÿæ‰§è¡Œä»»åŠ¡.</p><p>â€‹</p><p>â€‹</p></li></ul><h1 id="subscribeOnå’ŒobserveOn"><a href="#subscribeOnå’ŒobserveOn" class="headerlink" title="subscribeOnå’ŒobserveOn"></a>subscribeOnå’ŒobserveOn</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><h3 id="subscribeOn"><a href="#subscribeOn" class="headerlink" title="subscribeOn"></a><strong>subscribeOn</strong></h3><p><code>Observable&lt;T&gt; subscribeOn(Scheduler scheduler)</code></p><p>  subscribeOné€šè¿‡æ¥æ”¶ä¸€ä¸ªSchedulerå‚æ•°ï¼Œæ¥æŒ‡å®šå¯¹æ•°æ®çš„å¤„ç†è¿è¡Œåœ¨ç‰¹å®šçš„çº¿ç¨‹è°ƒåº¦å™¨Schedulerä¸Šã€‚<br>  è‹¥å¤šæ¬¡è®¾å®šï¼Œåˆ™åªæœ‰ä¸€æ¬¡èµ·ä½œç”¨ã€‚</p><h3 id="observeOn"><a href="#observeOn" class="headerlink" title="observeOn"></a><strong>observeOn</strong></h3><p><code>Observable&lt;T&gt; observeOn(Scheduler scheduler)</code></p><p>observeOnåŒæ ·æ¥æ”¶ä¸€ä¸ªSchedulerå‚æ•°ï¼Œæ¥æŒ‡å®šä¸‹æ¸¸æ“ä½œè¿è¡Œåœ¨ç‰¹å®šçš„çº¿ç¨‹è°ƒåº¦å™¨Schedulerä¸Šã€‚<br>è‹¥å¤šæ¬¡è®¾å®šï¼Œæ¯æ¬¡å‡èµ·ä½œç”¨ã€‚</p><h3 id="ä½¿ç”¨å®ä¾‹"><a href="#ä½¿ç”¨å®ä¾‹" class="headerlink" title="ä½¿ç”¨å®ä¾‹"></a>ä½¿ç”¨å®ä¾‹</h3><h4 id="å®ä¾‹ä¸€ï¼š"><a href="#å®ä¾‹ä¸€ï¼š" class="headerlink" title="å®ä¾‹ä¸€ï¼š"></a>å®ä¾‹ä¸€ï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjavaThreadScheuler</span><span class="params">()</span></span>&#123;</div><div class="line">    Integer [] nums = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</div><div class="line">    Observable.fromArray(nums)</div><div class="line">            .observeOn(Schedulers.single())</div><div class="line">            .subscribeOn(Schedulers.io())</div><div class="line">            .map(<span class="keyword">new</span> Function&lt;Integer, String&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">                    System.out.println(<span class="string">"mapA"</span>+<span class="string">"Thread="</span>+Thread.currentThread().getName()+<span class="string">"\r\n"</span>+<span class="string">"integer="</span>+integer);</div><div class="line">                    <span class="keyword">return</span> <span class="string">"num"</span>+integer;</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .map(<span class="keyword">new</span> Function&lt;String, Integer&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(String s)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                    System.out.println(<span class="string">"mapB"</span>+<span class="string">"Thread="</span>+Thread.currentThread().getName()+<span class="string">"\r\n"</span>+<span class="string">"String="</span>+s);</div><div class="line">                    <span class="keyword">return</span> Integer.parseInt(s.substring(<span class="number">3</span>,s.length()));</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .subscribe(<span class="keyword">new</span> Consumer&lt;Integer&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Integer integer)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                    System.out.println(<span class="string">"subscribe"</span>+<span class="string">"Thread="</span>+Thread.currentThread().getName()+<span class="string">"\r\n"</span>+<span class="string">"integer="</span>+integer);</div><div class="line">                    System.out.println(<span class="string">"========"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">mapAThread=RxSingleScheduler-1</div><div class="line">integer=1</div><div class="line">mapBThread=RxSingleScheduler-1</div><div class="line">String=num1</div><div class="line">subscribeThread=RxSingleScheduler-1</div><div class="line"><span class="section">integer=1</span></div><div class="line">========</div><div class="line">mapAThread=RxSingleScheduler-1</div><div class="line">integer=2</div><div class="line">mapBThread=RxSingleScheduler-1</div><div class="line">String=num2</div><div class="line">subscribeThread=RxSingleScheduler-1</div><div class="line"><span class="section">integer=2</span></div><div class="line">========</div><div class="line">mapAThread=RxSingleScheduler-1</div><div class="line">integer=3</div><div class="line">mapBThread=RxSingleScheduler-1</div><div class="line">String=num3</div><div class="line">subscribeThread=RxSingleScheduler-1</div><div class="line"><span class="section">integer=3</span></div><div class="line">========</div></pre></td></tr></table></figure><p>ç»“è®ºï¼š</p><p>æ‰“å°çš„æ‰€æœ‰çº¿ç¨‹å‡åœ¨<code>Schedulers.single()</code>ä¸­æ‰§è¡Œï¼Œ  <code>subscribeOn(Schedulers.io())</code>è²Œä¼¼æ²¡æœ‰ç”Ÿæ•ˆï¼Œå…¶å®</p><p><code>Observable.fromArray(nums)</code>çš„æ‰§è¡Œçº¿ç¨‹ï¼Œæ˜¯åœ¨<code>Schedulers.io()</code>çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæˆ‘ä»¬é€šè¿‡å®ä¾‹äºŒéªŒè¯</p><h4 id="å®ä¾‹äºŒï¼š"><a href="#å®ä¾‹äºŒï¼š" class="headerlink" title="å®ä¾‹äºŒï¼š"></a>å®ä¾‹äºŒï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjavaThreadScheuler</span><span class="params">()</span> </span>&#123;</div><div class="line">    Integer[] nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</div><div class="line">    Observable.create((ObservableOnSubscribe&lt;Integer&gt;) emitter -&gt; &#123;</div><div class="line">        <span class="keyword">for</span> (Integer integer : nums) &#123;</div><div class="line">            emitter.onNext(integer);</div><div class="line">            System.out.println(<span class="string">"emitter.onNext()"</span> + <span class="string">"Thread="</span> + Thread.currentThread().getName() + <span class="string">"\r\n"</span> + <span class="string">"integer="</span> + integer);</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">            .observeOn(Schedulers.single())</div><div class="line">            .subscribeOn(Schedulers.io())</div><div class="line">            .map(integer -&gt; &#123;</div><div class="line">                System.out.println(<span class="string">"mapA"</span> + <span class="string">"Thread="</span> + Thread.currentThread().getName() + <span class="string">"\r\n"</span> + <span class="string">"integer="</span> + integer);</div><div class="line">                <span class="keyword">return</span> <span class="string">"num"</span> + integer;</div><div class="line">            &#125;)</div><div class="line">            .map(s -&gt; &#123;</div><div class="line">                System.out.println(<span class="string">"mapB"</span> + <span class="string">"Thread="</span> + Thread.currentThread().getName() + <span class="string">"\r\n"</span> + <span class="string">"String="</span> + s);</div><div class="line">                <span class="keyword">return</span> Integer.parseInt(s.substring(<span class="number">3</span>, s.length()));</div><div class="line">            &#125;)</div><div class="line">            .subscribe(integer -&gt; &#123;</div><div class="line">                System.out.println(<span class="string">"subscribe"</span> + <span class="string">"Thread="</span> + Thread.currentThread().getName() + <span class="string">"\r\n"</span> + <span class="string">"integer="</span> + integer);</div><div class="line">                System.out.println(<span class="string">"========"</span>);</div><div class="line">            &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>  logcat</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¯è§ï¼Œäº‹ä»¶çš„å‘å¸ƒï¼Œæ˜¯åœ¨.subscribeOn(Schedulers.io())æŒ‡å®šçš„ioçº¿ç¨‹</span></div><div class="line">emitter.onNext()Thread=RxCachedThreadScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">1</span></div><div class="line">emitter.onNext()Thread=RxCachedThreadScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">2</span></div><div class="line">emitter.onNext()Thread=RxCachedThreadScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">3</span></div><div class="line"><span class="comment">//å…¶ä»–å‡åœ¨.observeOn(Schedulers.single())æŒ‡å®šçš„Singleçº¿ç¨‹</span></div><div class="line">mapAThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">1</span></div><div class="line">mapBThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">String=num1</div><div class="line">subscribeThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">1</span></div><div class="line">========</div><div class="line">mapAThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">2</span></div><div class="line">mapBThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">String=num2</div><div class="line">subscribeThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">2</span></div><div class="line">========</div><div class="line">mapAThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">3</span></div><div class="line">mapBThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">String=num3</div><div class="line">subscribeThread=RxSingleScheduler-<span class="number">1</span></div><div class="line">integer=<span class="number">3</span></div><div class="line">========</div></pre></td></tr></table></figure><p>  ç»“è®ºï¼š</p><p>subscribeOn()æŒ‡å®šçš„æ˜¯äº‹ä»¶çš„å‘å¸ƒæ‰§è¡Œçš„çº¿ç¨‹ï¼ŒobserveOn()æŒ‡å®šçš„æ˜¯å„ç§æ“ä½œç¬¦å’Œsubscribeçš„onNextï¼ŒonErrorï¼ŒonCompleteæ‰§è¡Œç­‰çº¿ç¨‹ï¼Œé‚£ä¹ˆè°ƒç”¨å¤šæ¬¡subscribeOn()æˆ–è€…å¤šæ¬¡observeOn()ï¼Œä¼šä»¥å“ªæ¬¡ä¸ºå‡†å‘¢ï¼Œè¯·çœ‹å®ä¾‹ä¸‰</p><h4 id="å®ä¾‹ä¸‰ï¼šå¤šæ¬¡åˆ‡æ¢åœºæ™¯"><a href="#å®ä¾‹ä¸‰ï¼šå¤šæ¬¡åˆ‡æ¢åœºæ™¯" class="headerlink" title="å®ä¾‹ä¸‰ï¼šå¤šæ¬¡åˆ‡æ¢åœºæ™¯"></a>å®ä¾‹ä¸‰ï¼šå¤šæ¬¡åˆ‡æ¢åœºæ™¯</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjavaThreadScheuler</span><span class="params">()</span> </span>&#123;</div><div class="line">        Integer[] nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</div><div class="line">        Observable.create((ObservableOnSubscribe&lt;Integer&gt;) emitter -&gt; &#123;</div><div class="line">            <span class="keyword">for</span> (Integer integer : nums) &#123;</div><div class="line">                emitter.onNext(integer);</div><div class="line">                Log.e(<span class="string">"rxjava"</span>, <span class="string">"emitter.onNext()---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">            &#125;</div><div class="line">            emitter.onComplete();</div><div class="line">        &#125;)</div><div class="line">                .subscribeOn(AndroidSchedulers.mainThread())<span class="comment">//æŒ‡å®šä¸»çº¿ç¨‹å‘å¸ƒäº‹ä»¶</span></div><div class="line">                .observeOn(Schedulers.single())<span class="comment">//åˆ‡æ¢mapA</span></div><div class="line">                .map(integer -&gt; &#123;</div><div class="line">                    Log.e(<span class="string">"rxjava"</span>, <span class="string">"mapA---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    <span class="keyword">return</span> <span class="string">"num"</span> + integer;</div><div class="line">                &#125;)</div><div class="line">                .observeOn(AndroidSchedulers.mainThread())<span class="comment">//åˆ‡æ¢mapB</span></div><div class="line">                .map(s -&gt; &#123;</div><div class="line">                    Log.e(<span class="string">"rxjava"</span>, <span class="string">"mapBçº¿ç¨‹---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    <span class="keyword">return</span> Integer.parseInt(s.substring(<span class="number">3</span>, s.length()));</div><div class="line">                &#125;)</div><div class="line">                .observeOn(Schedulers.computation())<span class="comment">//åˆ‡æ¢Observeræ‰§è¡Œçº¿ç¨‹</span></div><div class="line">                .subscribeOn(Schedulers.io())<span class="comment">//å†æ­¤æŒ‡å®šå‘å¸ƒçº¿ç¨‹ä¸ºio</span></div><div class="line">                .subscribe(<span class="keyword">new</span> Observer&lt;Integer&gt;() &#123;</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">                        Log.e(<span class="string">"rxjava"</span>, <span class="string">"onSubscribe---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Integer integer)</span> </span>&#123;</div><div class="line">                        Log.e(<span class="string">"rxjava"</span>, <span class="string">"onNext---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">                        Log.e(<span class="string">"rxjava"</span>, <span class="string">"onError---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">                        Log.e(<span class="string">"rxjava"</span>, <span class="string">"onComplete---&gt;"</span> + Thread.currentThread().getName());</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>  logcat</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">rxjava: onSubscribe---&gt;main<span class="comment">//Observerçš„onSubscribeå›è°ƒå’Œå‘å¸ƒäº‹ä»¶çš„çº¿ç¨‹ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡subscribeOn()ï¼Œè‹¥æœªæŒ‡å®šï¼Œåˆ™åœ¨</span></div><div class="line">rxjava: emitter.onNext()---&gt;main<span class="comment">//ç¬¬ä¸€æ¬¡subscribeOn()</span></div><div class="line">rxjava: emitter.onNext()---&gt;main</div><div class="line">rxjava: mapA---&gt;RxSingleScheduler-<span class="number">1</span><span class="comment">//æœ€è¿‘ä¸€æ¬¡observeOnï¼ˆï¼‰æŒ‡å®šçº¿ç¨‹ï¼Œè‹¥æœªæŒ‡å®šï¼Œé»˜è®¤å’ŒsubscribeOnçš„ä¸€è‡´ï¼Œè‹¥subscribeOnä¹ŸæœªæŒ‡å®šï¼Œé»˜è®¤æ˜¯Schedulers.trampoline()</span></div><div class="line">rxjava: emitter.onNext()---&gt;main</div><div class="line">rxjava: mapA---&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">rxjava: mapA---&gt;RxSingleScheduler-<span class="number">1</span></div><div class="line">rxjava: mapBçº¿ç¨‹---&gt;main<span class="comment">//æœ€è¿‘ä¸€æ¬¡observeOnï¼ˆï¼‰æŒ‡å®šçº¿ç¨‹</span></div><div class="line">rxjava: mapBçº¿ç¨‹---&gt;main</div><div class="line">rxjava: mapBçº¿ç¨‹---&gt;main</div><div class="line">rxjava: onNext---&gt;RxComputationThreadPool-<span class="number">1</span><span class="comment">//Observerçš„onNextï¼Œç”±æœ€è¿‘ä¸€æ¬¡çš„observeOnï¼ˆï¼‰æŒ‡å®š</span></div><div class="line">rxjava: onNext---&gt;RxComputationThreadPool-<span class="number">1</span></div><div class="line">rxjava: onNext---&gt;RxComputationThreadPool-<span class="number">1</span></div><div class="line">rxjava: onComplete---&gt;RxComputationThreadPool-<span class="number">1</span><span class="comment">//Observerçš„onCompleteï¼Œç”±æœ€è¿‘ä¸€æ¬¡çš„observeOnï¼ˆï¼‰</span></div></pre></td></tr></table></figure><p> ç»“è®ºï¼š</p><ul><li>å¤šä¸ªsubscribeOn()ä»¥ç¬¬ä¸€ä¸ªä¸ºä¸»</li><li>å¤šä¸ªobserveOnï¼ˆï¼‰æŒ‡å®šä»¥ä¸‹æ“ä½œæ‰§è¡Œçº¿ç¨‹</li><li>è‹¥ä¸æŒ‡å®šobserveOnï¼ˆï¼‰ï¼Œé»˜è®¤æŒ‰subscribeOn()æŒ‡å®šçš„çº¿ç¨‹ä¸€è‡´</li><li>è‹¥ä¸æŒ‡å®šsubscribeOn()ï¼Œé»˜è®¤æ˜¯Schedulers.trampoline()ï¼ˆåœ¨å½“å‰çº¿ç¨‹ï¼Œåœä¸‹ä¹‹å‰ä»»åŠ¡ï¼Œå…ˆæ‰§è¡Œæœ¬æ¬¡ä»»åŠ¡ï¼‰</li><li>æ³¨æ„ï¼šObserverçš„onSubscribe(Disposable d)å›è°ƒï¼Œä»¥subscribeOn()ä¸ºä¸»ï¼Œè€Œä¸æ˜¯ä»¥observeOnï¼ˆï¼‰ä¸ºä¸»</li></ul><p>å…¶ä»–ä¸‰ä¸ªå›è°ƒonNextï¼ŒonErrorï¼ŒonCompleteä»¥observeOnï¼ˆï¼‰ä¸ºä¸»</p><h4 id="å®ä¾‹å››Schedulers-trampoline-ï¼š"><a href="#å®ä¾‹å››Schedulers-trampoline-ï¼š" class="headerlink" title="å®ä¾‹å››Schedulers.trampoline()ï¼š"></a>å®ä¾‹å››Schedulers.trampoline()ï¼š</h4><p><img src="https://upload-images.jianshu.io/upload_images/6773051-6d40d0cbdb0bd590.jpg?imageMogr2/auto-orient/" alt=""></p><p>log</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">System.out: å‘å°„çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">0</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">0</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">1</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">1</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">2</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">2</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">3</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">3</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">4</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxCachedThreadScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">4</span></div><div class="line"><span class="comment">//å¯ä»¥çœ‹åˆ°</span></div><div class="line"><span class="comment">//Schedulers.trampoline()æŒ‡å®šConsumerå›è°ƒæ‰§è¡Œçº¿ç¨‹å’Œå‘å¸ƒäº‹ä»¶çº¿ç¨‹ä¸€æ ·</span></div><div class="line"><span class="comment">//Schedulers.trampoline()çš„ä½œç”¨åœ¨å½“å‰çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œåˆ™ä¼šå°†å…¶æš‚åœï¼Œç­‰æ’å…¥è¿›æ¥çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œå†å°†æœªå®Œæˆçš„ä»»åŠ¡æ¥ç€æ‰§è¡Œã€‚</span></div></pre></td></tr></table></figure><p>ç»“è®ºï¼š</p><p>Schedulers.trampoline()çš„ä½œç”¨åœ¨å½“å‰çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œåˆ™ä¼šå°†å…¶æš‚åœï¼Œç­‰æ’å…¥è¿›æ¥çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œå†å°†æœªå®Œæˆçš„ä»»åŠ¡æ¥ç€æ‰§è¡Œã€‚ã€æœ¬å®ä¾‹çš„ä½“ç°ï¼šå½“observeæ¥å—çš„æ—¶å€™ï¼Œäº‹ä»¶åœæ­¢äº†å‘é€ã€‘</p><h4 id="å®ä¾‹äº”Schedulers-single"><a href="#å®ä¾‹äº”Schedulers-single" class="headerlink" title="å®ä¾‹äº”Schedulers.single()"></a>å®ä¾‹äº”Schedulers.single()</h4><p><img src="https://upload-images.jianshu.io/upload_images/6773051-7691bdd048bdcaad.jpg?imageMogr2/auto-orient/" alt=""></p><p>log</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">System.out: å‘å°„çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">0</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">1</span></div><div class="line">System.out: å‘å°„çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å‘å°„:<span class="number">2</span></div><div class="line"></div><div class="line">System.out: å¤„ç†çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å¤„ç†:<span class="number">0</span></div><div class="line">System.out: å¤„ç†çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å¤„ç†:<span class="number">1</span></div><div class="line">System.out: å¤„ç†çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;å¤„ç†:<span class="number">2</span></div><div class="line"></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">0</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">1</span></div><div class="line">System.out: æ¥æ”¶çº¿ç¨‹:RxSingleScheduler-<span class="number">1</span>----&gt;æ¥æ”¶:<span class="number">2</span></div><div class="line"><span class="comment">//å‘å¸ƒå’Œæ¥å—éƒ½æ˜¯singleçº¿ç¨‹</span></div><div class="line"><span class="comment">//æ¥æ”¶åœ¨Schedulers.single()çš„çº¿ç¨‹å•ä¾‹ä¸­æ’é˜Ÿæ‰§è¡Œï¼Œå½“æ­¤çº¿ç¨‹ä¸­æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå…¶ä»–ä»»åŠ¡å°†ä¼šæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºä¾æ¬¡æ‰§è¡Œ  </span></div><div class="line"><span class="comment">//æ‰€ä»¥å¯ä»¥è¾¾åˆ°ã€‚ å®Œå…¨å‘å°„---å®Œå…¨å¤„ç†---å®Œå…¨æ¥å—çš„æµç¨‹</span></div></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/12638513424f" target="_blank" rel="external">å‚è€ƒè¿æ¥</a></p>]]></content>
      
      <categories>
          
          <category> Rxjava </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rxjava </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Rxjava2.0-çŸ¥è¯†ç¢ç‰‡(ä¸€)</title>
      <link href="/2018/07/23/Rxjava2-0-%E7%9F%A5%E8%AF%86%E7%A2%8E%E7%89%87%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <content type="html"><![CDATA[<p>Observable.create(ObservableOnSubscribe)å’Œsubscribe()åŸºæœ¬ä½¿ç”¨</p><a id="more"></a><h3 id="Observable-create-ObservableOnSubscribe-çš„ä½¿ç”¨"><a href="#Observable-create-ObservableOnSubscribe-çš„ä½¿ç”¨" class="headerlink" title="Observable.create(ObservableOnSubscribe)çš„ä½¿ç”¨"></a>Observable.create(ObservableOnSubscribe)çš„ä½¿ç”¨</h3><p>è·å¾—ä¸€ä¸ªObservableæœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œé€šè¿‡æˆ‘ä»¬ä¸‹é¢çš„åŠ¨å›¾å¯ä»¥çœ‹åˆ°</p><p><img src="https://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/Observable.gif" alt="è·å–Observableçš„æ–¹å¼"></p><p>ä»Šå¤©çš„ç¢ç‰‡åŒ–æ•´ç†ï¼Œå°±åªæ•´ç†æœ€æ™®é€šçš„ä¸€ç§æ–¹å¼<code>Observable.create(ObservableOnSubscribe)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * ObservableEmitter:Emitteræ˜¯å‘å°„å™¨çš„æ„æ€ï¼Œ</div><div class="line"> * å®ƒå¯ä»¥å‘å‡ºä¸‰ç§ç±»å‹çš„äº‹ä»¶ï¼Œ</div><div class="line"> * é€šè¿‡è°ƒç”¨emitterçš„onNext(T value)ã€onComplete()å’ŒonError(Throwable error)å°±å¯ä»¥åˆ†åˆ«å‘å‡ºnextäº‹ä»¶ã€completeäº‹ä»¶å’Œerroräº‹ä»¶ã€‚</div><div class="line"> * å‘å°„æ»¡è¶³è§„åˆ™ï¼š</div><div class="line"> * 1ï¼ŒObservableå¯ä»¥å‘é€æ— é™ä¸ªonNext, Observerä¹Ÿå¯ä»¥æ¥æ”¶æ— é™ä¸ªonNext</div><div class="line"> * 2ï¼Œå‘é€äº†ä¸€ä¸ªonCompleteå, Observableçš„onCompleteæˆ–è€…onErrorä¹‹åçš„äº‹ä»¶å°†ä¼šç»§ç»­å‘é€, è€ŒObserveræ”¶åˆ°onComplete/onErroräº‹ä»¶ä¹‹åå°†ä¸å†ç»§ç»­æ¥æ”¶äº‹ä»¶.</div><div class="line"> * 3ï¼ŒObservableå¯ä»¥å‘é€æ— é™ä¸ªonNextå¯ä»¥ä¸å‘é€onCompleteæˆ–onError.</div><div class="line"> * 4ï¼ŒObservableä¸å¯ä»¥å‘é€å¤šä¸ªonCompleteå’Œå¤šä¸ªonErrorï¼ˆonCompleteå’ŒonErroråŠ ä¸€èµ·åªèƒ½å‘å°„ä¸€æ¬¡ï¼‰</div><div class="line"> * 5ï¼ŒObservableå‘å°„å¤šä¸ªonCompleteä¸æŠ¥é”™ï¼ˆåªæ”¶åˆ°ç¬¬ä¸€ä¸ªonCompleteå°±ä¸å†æ¥å—äº†ï¼‰ã€‚å‘å°„å¤šä¸ªonErrorä¼šæŠ¥é”™</div><div class="line"> */</div><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjava</span><span class="params">()</span> </span>&#123;</div><div class="line">    Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;String&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            emitter.onNext(<span class="string">"hello"</span>);</div><div class="line">            emitter.onNext(<span class="string">"rxjava"</span>);</div><div class="line">            emitter.onComplete();</div><div class="line">            emitter.onNext(<span class="string">"æ— æ³•æ¥å—"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;).subscribe(<span class="keyword">new</span> Observer&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onSubscribe"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onNext:value="</span> + s);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onError:error"</span> + e.getMessage());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">            System.out.println(<span class="string">"onComplete"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>logcatï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">onSubscribe</div><div class="line">onNext:value=hello</div><div class="line">onNext:value=rxjava</div><div class="line">onComplete</div></pre></td></tr></table></figure><h3 id="å‘é€è§„åˆ™"><a href="#å‘é€è§„åˆ™" class="headerlink" title="å‘é€è§„åˆ™"></a>å‘é€è§„åˆ™</h3><ul><li>å‘å°„æ»¡è¶³è§„åˆ™ï¼š</li><li>1ï¼ŒObservableå¯ä»¥å‘é€æ— é™ä¸ªonNext, Observerä¹Ÿå¯ä»¥æ¥æ”¶æ— é™ä¸ªonNext</li><li>2ï¼Œå‘é€äº†ä¸€ä¸ªonCompleteå, Observableçš„onCompleteæˆ–è€…onErrorä¹‹åçš„äº‹ä»¶å°†ä¼šç»§ç»­å‘é€, è€ŒObserveræ”¶åˆ°onComplete/onErroräº‹ä»¶ä¹‹åå°†ä¸å†ç»§ç»­æ¥æ”¶äº‹ä»¶.</li><li>3ï¼ŒObservableå¯ä»¥å‘é€æ— é™ä¸ªonNextå¯ä»¥ä¸å‘é€onCompleteæˆ–onError.</li><li>4ï¼ŒObservableä¸å¯ä»¥å‘é€å¤šä¸ªonCompleteå’Œå¤šä¸ªonErrorï¼ˆonCompleteå’ŒonErroråŠ ä¸€èµ·åªèƒ½å‘å°„ä¸€æ¬¡ï¼‰</li><li>5ï¼ŒObservableå‘å°„å¤šä¸ªonCompleteä¸æŠ¥é”™ï¼ˆåªæ”¶åˆ°ç¬¬ä¸€ä¸ªonCompleteå°±ä¸å†æ¥å—äº†ï¼‰ã€‚å‘å°„å¤šä¸ªonErrorä¼šæŠ¥é”™</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/1008453-7133ff9a13dd9a59.png?imageMogr2/auto-orient/" alt="å‡è®¾äº‹ä»¶æµå›¾"></p><p>è¿™é‡Œçš„<code>ä¸Šæ¸¸</code>å’Œ<code>ä¸‹æ¸¸</code>å°±åˆ†åˆ«å¯¹åº”ç€RxJavaä¸­çš„<code>Observable</code>å’Œ<code>Observer</code>ï¼Œå®ƒä»¬ä¹‹é—´çš„è¿æ¥å°±å¯¹åº”ç€<code>subscribe()</code></p><p>ä»¥ä¸Šå‡ ä¸ªè§„åˆ™ç”¨ç¤ºæ„å›¾è¡¨ç¤ºå¦‚ä¸‹:</p><table><thead><tr><th></th><th>ç¤ºæ„å›¾</th></tr></thead><tbody><tr><td><strong>åªå‘é€onNextäº‹ä»¶</strong></td><td><img src="https://upload-images.jianshu.io/upload_images/1008453-2526f7824c53a47e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/580" alt="img">next</td></tr><tr><td><strong>å‘é€onCompleteäº‹ä»¶</strong></td><td><img src="https://upload-images.jianshu.io/upload_images/1008453-bdb581480fc9379b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/595" alt="img">complete</td></tr><tr><td><strong>å‘é€onErroräº‹ä»¶</strong></td><td><img src="https://upload-images.jianshu.io/upload_images/1008453-b731e6294f342d66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/595" alt="img">error</td></tr></tbody></table><p><a href="https://www.jianshu.com/p/464fa025229e" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a></p><h3 id="onSubscribe-Disposable-d-çš„å‚æ•°Disposable"><a href="#onSubscribe-Disposable-d-çš„å‚æ•°Disposable" class="headerlink" title="onSubscribe(Disposable d)çš„å‚æ•°Disposable"></a>onSubscribe(Disposable d)çš„å‚æ•°Disposable</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rxjava</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observable.create(<span class="keyword">new</span> ObservableOnSubscribe&lt;Integer&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;Integer&gt; emitter)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">                emitter.onNext(<span class="number">1</span>);</div><div class="line">                emitter.onNext(<span class="number">2</span>);</div><div class="line">                emitter.onNext(<span class="number">3</span>);</div><div class="line">                emitter.onNext(<span class="number">4</span>);</div><div class="line">                emitter.onNext(<span class="number">5</span>);</div><div class="line">                emitter.onComplete();</div><div class="line">            &#125;</div><div class="line">        &#125;).subscribe(<span class="keyword">new</span> Observer&lt;Integer&gt;() &#123;</div><div class="line">            <span class="keyword">public</span> Disposable mDisposable;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onSubscribe"</span>);</div><div class="line">                <span class="keyword">this</span>.mDisposable = d;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Integer integer)</span> </span>&#123;</div><div class="line">                <span class="keyword">if</span> (integer == <span class="number">3</span>) &#123;</div><div class="line">                    System.out.println(<span class="string">"onNext:isDisposed="</span> + mDisposable.isDisposed());</div><div class="line">                    mDisposable.dispose();</div><div class="line">                    System.out.println(<span class="string">"onNext:isDisposed="</span> + mDisposable.isDisposed());</div><div class="line">                &#125;</div><div class="line">                System.out.println(<span class="string">"onNext:valuse="</span> + integer);</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onError"</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">                System.out.println(<span class="string">"onComplete"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p><strong>logcatï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">onSubscribe</div><div class="line">onNext:valuse=<span class="number">1</span></div><div class="line">onNext:valuse=<span class="number">2</span></div><div class="line">onNext:isDisposed=<span class="keyword">false</span></div><div class="line">onNext:isDisposed=<span class="keyword">true</span></div><div class="line">onNext:valuse=<span class="number">3</span></div></pre></td></tr></table></figure><p>ç”±ä»£ç å¯çœ‹å‡ºï¼š</p><ul><li><code>onSubscribe</code>æ–¹æ³•æœ€å…ˆè°ƒç”¨ï¼Œå¹¶ä¸”åªè°ƒç”¨ä¸€æ¬¡</li><li><code>Disposable.dispose()</code>è°ƒç”¨åï¼Œ<code>onNext</code>å°†æ¥å—ä¸åˆ°å‘å‡ºçš„4ï¼Œ5äº‹ä»¶ï¼ˆ<strong>ä½†æ˜¯emitter.onNext(4);</strong><br>â€‹                <strong>emitter.onNext(5)ç¡®å®æ‰§è¡Œäº†ï¼›</strong></li><li>Disposableçš„ç”¨å¤„ä¸æ­¢è¿™äº›, åé¢è®²è§£åˆ°äº†çº¿ç¨‹çš„è°ƒåº¦ä¹‹å, æˆ‘ä»¬ä¼šå‘ç°å®ƒçš„é‡è¦æ€§.åç»­è¡¥å……</li></ul><h3 id="subscribe-çš„å¤šä¸ªé‡è½½çš„æ–¹æ³•"><a href="#subscribe-çš„å¤šä¸ªé‡è½½çš„æ–¹æ³•" class="headerlink" title="subscribe()çš„å¤šä¸ªé‡è½½çš„æ–¹æ³•"></a><code>subscribe()</code>çš„å¤šä¸ªé‡è½½çš„æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Disposable <span class="title">subscribe</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"><span class="number">2</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Disposable <span class="title">subscribe</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; onNext)</span> </span>&#123;&#125;</div><div class="line"><span class="number">3</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Disposable <span class="title">subscribe</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; onNext, Consumer&lt;? <span class="keyword">super</span> Throwable&gt; onError)</span> </span>&#123;&#125; </div><div class="line"><span class="number">4</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Disposable <span class="title">subscribe</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; onNext, Consumer&lt;? <span class="keyword">super</span> Throwable&gt; onError, Action onComplete)</span> </span>&#123;&#125;</div><div class="line"><span class="number">5</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Disposable <span class="title">subscribe</span><span class="params">(Consumer&lt;? <span class="keyword">super</span> T&gt; onNext, Consumer&lt;? <span class="keyword">super</span> Throwable&gt; onError, Action onComplete, Consumer&lt;? <span class="keyword">super</span> Disposable&gt; onSubscribe)</span> </span>&#123;&#125;</div><div class="line"><span class="number">6</span>,<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(Observer&lt;? <span class="keyword">super</span> T&gt; observer)</span> </span>&#123;&#125;</div></pre></td></tr></table></figure><ul><li>ä¸å¸¦ä»»ä½•å‚æ•°çš„<code>subscribe()</code> è¡¨ç¤ºä¸‹æ¸¸ä¸å…³å¿ƒä»»ä½•äº‹ä»¶,ä½ ä¸Šæ¸¸å°½ç®¡å‘ä½ çš„æ•°æ®å»å§, ä¸‹æ¸¸æ— æ³•æ¥å—</li><li>å¸¦æœ‰ä¸€ä¸ª<code>Consumer</code>å‚æ•°çš„æ–¹æ³•è¡¨ç¤ºä¸‹æ¸¸åªå…³å¿ƒonNextäº‹ä»¶, å…¶ä»–çš„äº‹ä»¶æˆ‘å‡è£…æ²¡çœ‹è§, å› æ­¤æˆ‘ä»¬å¦‚æœåªéœ€è¦onNextäº‹ä»¶å¯ä»¥è¿™ä¹ˆå†™</li><li><code>Observer</code>å‚æ•°ï¼Œå¦‚ä¾‹å­ï¼Œæ¯”è¾ƒå®Œæ•´çš„onSubscribeï¼ŒonNextï¼ŒonCompleteï¼ŒonError</li><li>å¦‚æœæˆ‘ä»¬ä¸éœ€è¦å…¶ä»–å›è°ƒï¼Œå¯é€‰æ‹©æˆ‘ä»¬éœ€è¦çš„<code>Consumer</code> çš„å…·ä½“å‚æ•°</li></ul><p><a href="https://www.jianshu.com/p/464fa025229e" target="_blank" rel="external">å‚è€ƒé“¾æ¥</a></p>]]></content>
      
      <categories>
          
          <category> Rxjava </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rxjava </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SharedPreferencesçš„ç¼ºé™·</title>
      <link href="/2018/07/19/SharedPreferences%E7%9A%84%E7%BC%BA%E9%99%B7/"/>
      <content type="html"><![CDATA[<p>SharedPreferencesåœ¨Androidä½¿ç”¨éå¸¸æ™®éï¼Œæœ¬æ–‡è®°å½•ä¸€ä¸‹å®ƒçš„ä¸è¶³ä¹‹å¤„å’Œä½¿ç”¨æ³¨æ„äº‹é¡¹</p><a id="more"></a><h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p><code>SharedPreferences</code>æ˜¯Android SDKæä¾›çš„å·¥å…·ï¼Œå¯ä»¥å­˜å‚¨åº”ç”¨çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¼šä»¥é”®å€¼å¯¹çš„å½¢å¼ä¿å­˜åœ¨<code>/sdcard/data/data/packageName/shared_prefs/</code>è·¯å¾„ä¸‹çš„ä¸€ä¸ª<code>xml</code>æ–‡ä»¶ä¸­ã€‚å®ƒæä¾›äº†å¤šç§æ•°æ®ç±»å‹çš„å­˜å‚¨ï¼ŒåŒ…æ‹¬ï¼š<code>int</code>ã€<code>long</code>ã€<code>boolean</code>ã€<code>float</code>ã€<code>String</code>ä»¥åŠ<code>Set&lt;String&gt;</code>ã€‚</p><h4 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><ul><li><code>context.getSharedPreference(name, mode);</code></li><li><code>PreferenceManager.getDefaultSharedPreferences(context);</code></li></ul><p>è¿™ä¸¤ç§æ–¹å¼å…¶å®å…·ä½“å®ç°æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡ä¸€ä¸ªæ˜¯å¼€å‘è€…è‡ªå·±å®šä¹‰åå­—ï¼Œå¦ä¸€ä¸ªæ˜¯ä½¿ç”¨åŒ…å+â€_preferenceâ€ä½œä¸ºå­˜å‚¨æ–‡ä»¶åã€‚</p><h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><p>è‹¥æˆ‘ä»¬å¤§é‡ä½¿ç”¨<code>PreferenceManager.getDefaultSharedPreferences(context);</code>ï¼Œå°†å„ç§é…ç½®é¡¹å…¨éƒ¨å­˜å‚¨åˆ°ä¸€ä¸ªspä¸­ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼š<strong>è¯¥æ–‡ä»¶è¿‡å¤§ï¼Œè¯»å–é…ç½®é¡¹è¿‡æ…¢</strong></p><p>æ‰€ä»¥æ¨èï¼Œæ ¹æ®æƒ…å†µï¼Œå°†ä¸åŒçš„é…ç½®æ–‡ä»¶ä¿å­˜åœ¨ä¸åŒçš„spä¸­ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ä½¿ç”¨é»˜è®¤çš„spï¼Œå¯¼è‡´åŒä¸€ä¸ªspæ–‡ä»¶è¿‡å¤§</p><ol><li>ç¬¬ä¸€æ¬¡ä»spä¸­è·å–å€¼çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½é˜»å¡ä¸»çº¿ç¨‹ï¼Œä½¿ç•Œé¢å¡é¡¿ã€æ‰å¸§ã€‚</li><li>è§£æspçš„æ—¶å€™ä¼šäº§ç”Ÿå¤§é‡çš„ä¸´æ—¶å¯¹è±¡ï¼Œå¯¼è‡´é¢‘ç¹GCï¼Œå¼•èµ·ç•Œé¢å¡é¡¿ã€‚</li><li>è¿™äº›keyå’Œvalueä¼šæ°¸è¿œå­˜åœ¨äºå†…å­˜ä¹‹ä¸­ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚</li></ol><h4 id="å…¶ä»–æ³¨æ„"><a href="#å…¶ä»–æ³¨æ„" class="headerlink" title="å…¶ä»–æ³¨æ„"></a>å…¶ä»–æ³¨æ„</h4><ul><li>è¢«åŠ è½½è¿›æ¥çš„è¿™äº›å¤§å¯¹è±¡ï¼Œä¼šæ°¸è¿œå­˜åœ¨äºå†…å­˜ä¹‹ä¸­ï¼Œä¸ä¼šè¢«é‡Šæ”¾ã€‚</li></ul><p>ContextImplè¿™ä¸ªç±»ï¼Œåœ¨getSharedPreferenceçš„æ—¶å€™ä¼šæŠŠæ‰€æœ‰çš„spæ”¾åˆ°ä¸€ä¸ªé™æ€å˜é‡é‡Œé¢ç¼“å­˜èµ·æ¥ï¼š</p><p><strong>static</strong>çš„sSharedPrefsCacheï¼Œå®ƒä¿å­˜äº†ä½ æ‰€æœ‰ä½¿ç”¨çš„sp</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@GuardedBy</span>(<span class="string">"ContextImpl.class"</span>)</div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> ArrayMap&lt;String, ArrayMap&lt;File, SharedPreferencesImpl&gt;&gt;sSharedPrefsCache;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> ArrayMap&lt;File, SharedPreferencesImpl&gt; <span class="title">getSharedPreferencesCacheLocked</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (sSharedPrefsCache == <span class="keyword">null</span>) &#123;</div><div class="line">        sSharedPrefsCache = <span class="keyword">new</span> ArrayMap&lt;&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> String packageName = getPackageName();</div><div class="line">    ArrayMap&lt;File, SharedPreferencesImpl&gt; packagePrefs = sSharedPrefsCache.get(packageName);</div><div class="line">    <span class="keyword">if</span> (packagePrefs == <span class="keyword">null</span>) &#123;</div><div class="line">        packagePrefs = <span class="keyword">new</span> ArrayMap&lt;&gt;();</div><div class="line">        sSharedPrefsCache.put(packageName, packagePrefs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> packagePrefs;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>å­˜å‚¨JSONç­‰ç‰¹æ®Šç¬¦å·å¾ˆå¤šçš„value</li></ul><p>åœ¨spé‡Œé¢å­˜jsonæˆ–è€…HTMLï¼›è¿™ä¹ˆåšä¸æ˜¯ä¸å¯ä»¥ï¼Œä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªjsonç›¸å¯¹è¾ƒå¤§ï¼Œé‚£ä¹ˆä¹Ÿä¼šå¼•èµ·spè¯»å–é€Ÿåº¦çš„æ€¥å‰§ä¸‹é™ã€‚</p><p>JSONæˆ–è€…HTMLæ ¼å¼å­˜æ”¾åœ¨spé‡Œé¢çš„æ—¶å€™ï¼Œéœ€è¦è½¬ä¹‰ï¼Œè¿™æ ·ä¼šå¸¦æ¥å¾ˆå¤š &amp; è¿™ç§ç‰¹æ®Šç¬¦å·ï¼Œspåœ¨è§£æç¢°åˆ°è¿™ä¸ªç‰¹æ®Šç¬¦å·çš„æ—¶å€™ä¼šè¿›è¡Œç‰¹æ®Šçš„å¤„ç†ï¼Œå¼•å‘é¢å¤–çš„å­—ç¬¦ä¸²æ‹¼æ¥ä»¥åŠå‡½æ•°è°ƒç”¨å¼€é”€ã€‚è€ŒJSONæœ¬æ¥å°±æ˜¯å¯ä»¥ç”¨æ¥åšé…ç½®æ–‡ä»¶çš„ï¼Œä½ å¹²å˜›åˆæŠŠå®ƒæ”¾åœ¨spé‡Œé¢å‘¢ï¼Ÿ</p><ul><li>å¤šæ¬¡editå¤šæ¬¡apply</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">SharedPreferences sp = getSharedPreferences(<span class="string">"test"</span>, MODE_PRIVATE);</div><div class="line">sp.edit().putString(<span class="string">"test1"</span>, <span class="string">"sss"</span>).apply();</div><div class="line">sp.edit().putString(<span class="string">"test2"</span>, <span class="string">"sss"</span>).apply();</div><div class="line">sp.edit().putString(<span class="string">"test3"</span>, <span class="string">"sss"</span>).apply();</div><div class="line">sp.edit().putString(<span class="string">"test4"</span>, <span class="string">"sss"</span>).apply();</div></pre></td></tr></table></figure><p>æ¯æ¬¡editéƒ½ä¼šåˆ›å»ºä¸€ä¸ªEditorå¯¹è±¡ï¼Œé¢å¤–å ç”¨å†…å­˜ï¼›å½“ç„¶å¤šåˆ›å»ºå‡ ä¸ªå¯¹è±¡ä¹Ÿå½±å“ä¸äº†å¤šå°‘ï¼›ä½†æ˜¯ï¼Œå¤šæ¬¡applyä¹Ÿä¼šå¡ç•Œé¢ä½ é€ å—ï¼Ÿ</p><p>æœ‰ç«¥é‹ä¼šè¯´ï¼Œapplyä¸æ˜¯åœ¨åˆ«çš„çº¿ç¨‹äº›ç£ç›˜çš„å—ï¼Œæ€ä¹ˆå¯èƒ½å¡ç•Œé¢ï¼Ÿæˆ‘å¸¦ä½ ä»”ç»†çœ‹ä¸€ä¸‹æºç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">apply</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">final</span> MemoryCommitResult mcr = commitToMemory();</div><div class="line">    <span class="keyword">final</span> Runnable awaitCommit = <span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    mcr.writtenToDiskLatch.await();</div><div class="line">                &#125; <span class="keyword">catch</span> (InterruptedException ignored) &#123;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">    QueuedWork.add(awaitCommit);</div><div class="line"></div><div class="line">    Runnable postWriteRunnable = <span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                awaitCommit.run();</div><div class="line">                QueuedWork.remove(awaitCommit);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">    SharedPreferencesImpl.<span class="keyword">this</span>.enqueueDiskWrite(mcr, postWriteRunnable);</div><div class="line">    notifyListeners(mcr);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ³¨æ„ä¸¤ç‚¹ï¼Œç¬¬ä¸€ï¼ŒæŠŠä¸€ä¸ªå¸¦æœ‰awaitçš„runnableæ·»åŠ è¿›äº†QueueWorkç±»çš„ä¸€ä¸ªé˜Ÿåˆ—ï¼›ç¬¬äºŒï¼ŒæŠŠè¿™ä¸ªå†™å…¥ä»»åŠ¡é€šè¿‡enqueueDiskWriteä¸¢ç»™äº†ä¸€ä¸ª<strong>åªæœ‰å•ä¸ªçº¿ç¨‹</strong>çš„çº¿ç¨‹æ± æ‰§è¡Œã€‚</p><p>åˆ°è¿™é‡Œä¸€åˆ‡éƒ½OKï¼Œåœ¨å­çº¿ç¨‹é‡Œé¢å†™å…¥ä¸ä¼šå¡UIã€‚ä½†æ˜¯ï¼Œä½ å»ActivityThreadç±»çš„handleStopActivityé‡Œçœ‹ä¸€çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleStopActivity</span><span class="params">(IBinder token, <span class="keyword">boolean</span> show, <span class="keyword">int</span> configChanges, <span class="keyword">int</span> seq)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// çœç•¥æ— å…³ã€‚ã€‚</span></div><div class="line">    <span class="comment">// Make sure any pending writes are now committed.ï¼ˆç¡®ä¿æ‰€æœ‰å»¶è¿Ÿå†™å…¥å®Œæˆï¼‰</span></div><div class="line">    <span class="keyword">if</span> (!r.isPreHoneycomb()) &#123;</div><div class="line">        QueuedWork.waitToFinish();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// çœç•¥æ— å…³ã€‚ã€‚</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¦‚æœåœ¨Activity Stopçš„æ—¶å€™ï¼Œå·²ç»å†™å…¥å®Œæ¯•äº†ï¼Œé‚£ä¹ˆä¸‡äº‹å¤§å‰ï¼Œä¸ä¼šæœ‰ä»»ä½•ç­‰å¾…ï¼Œè¿™ä¸ªå‡½æ•°ä¼šç«‹é©¬è¿”å›ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨äº†å¤ªå¤šæ¬¡çš„applyï¼Œé‚£ä¹ˆæ„å‘³ç€å†™å…¥é˜Ÿåˆ—ä¼šæœ‰å¾ˆå¤šå†™å…¥ä»»åŠ¡ï¼Œè€Œé‚£é‡Œå°±åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å†™ã€‚å½“Appè§„æ¨¡å¾ˆå¤§çš„æ—¶å€™ï¼Œè¿™ç§æƒ…å†µç®€ç›´å°±å¤ªå¸¸è§äº†</p><p>è™½ç„¶applyæ˜¯åœ¨å­çº¿ç¨‹æ‰§è¡Œçš„ï¼Œä½†æ˜¯è¯·ä¸è¦æ— èŠ‚åˆ¶åœ°applyï¼›commitæˆ‘å°±ä¸å¤šè¯´äº†å§ï¼Ÿç›´æ¥åœ¨å½“å‰çº¿ç¨‹å†™å…¥ï¼Œå¦‚æœä½ åœ¨ä¸»çº¿ç¨‹å¹²è¿™ä¸ª</p><ul><li>SPå¤šè¿›ç¨‹ä¸å¯é </li></ul><p>spæœ‰ä¸€ä¸ªè²Œä¼¼å¯ä»¥æä¾›ã€Œè·¨è¿›ç¨‹ã€åŠŸèƒ½çš„FLAGâ€”â€”MODE_MULTI_PROCESS</p><p>æ–‡æ¡£ä¹Ÿè¯´äº†ï¼Œè¿™ç©æ„åœ¨æŸäº›Androidç‰ˆæœ¬ä¸Šä¸å¯é ï¼Œå¹¶ä¸”æœªæ¥ä¹Ÿä¸ä¼šæä¾›ä»»ä½•æ”¯æŒï¼Œè¦æ˜¯ç”¨è·¨è¿›ç¨‹æ•°æ®ä¼ è¾“éœ€è¦ä½¿ç”¨ç±»ä¼¼ContentProviderçš„ä¸œè¥¿ã€‚è€Œä¸”ï¼ŒSharedPreferenceçš„æ–‡æ¡£ä¹Ÿç‰¹åˆ«è¯´æ˜ï¼š</p><p><code>Note: This class does not support use across multiple processes.</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> SharedPreferences <span class="title">getSharedPreferences</span><span class="params">(File file, <span class="keyword">int</span> mode)</span> </span>&#123;</div><div class="line">    checkMode(mode);</div><div class="line">    SharedPreferencesImpl sp;</div><div class="line">    <span class="keyword">synchronized</span> (ContextImpl.class) &#123;</div><div class="line">        <span class="keyword">final</span> ArrayMap&lt;File, SharedPreferencesImpl&gt; cache = getSharedPreferencesCacheLocked();</div><div class="line">        sp = cache.get(file);</div><div class="line">        <span class="keyword">if</span> (sp == <span class="keyword">null</span>) &#123;</div><div class="line">            sp = <span class="keyword">new</span> SharedPreferencesImpl(file, mode);</div><div class="line">            cache.put(file, sp);</div><div class="line">            <span class="keyword">return</span> sp;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ((mode &amp; Context.MODE_MULTI_PROCESS) != <span class="number">0</span> ||</div><div class="line">        getApplicationInfo().targetSdkVersion &lt; android.os.Build.VERSION_CODES.HONEYCOMB) &#123;</div><div class="line">        <span class="comment">// If somebody else (some other process) changed the prefs</span></div><div class="line">        <span class="comment">// file behind our back, we reload it.  This has been the</span></div><div class="line">        <span class="comment">// historical (if undocumented) behavior.</span></div><div class="line">        sp.startReloadIfChangedUnexpectedly();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> sp;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™ä¸ªflagä¿è¯äº†å•¥ï¼Ÿä¿è¯äº†<strong>åœ¨API 11ä»¥å‰</strong>çš„ç³»ç»Ÿä¸Šï¼Œå¦‚æœspå·²ç»è¢«è¯»å–è¿›å†…å­˜ï¼Œå†æ¬¡è·å–è¿™ä¸ªspçš„æ—¶å€™ï¼Œå¦‚æœæœ‰è¿™ä¸ªflagï¼Œä¼šé‡æ–°è¯»ä¸€éæ–‡ä»¶ï¼Œä»…æ­¤è€Œå·²</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ol><li>ä¸è¦å­˜æ”¾å¤§çš„keyå’Œvalueï¼ä¼šå¼•èµ·ç•Œé¢å¡ã€é¢‘ç¹GCã€å ç”¨å†…å­˜ç­‰ç­‰</li><li>æ¯«ä¸ç›¸å…³çš„é…ç½®é¡¹å°±ä¸è¦ä¸¢åœ¨ä¸€èµ·äº†ï¼æ–‡ä»¶è¶Šå¤§è¯»å–è¶Šæ…¢ï¼Œé˜²æ­¢å…¨éƒ¨æ”¾è¿›defalutçš„spï¼</li><li>è¯»å–é¢‘ç¹çš„keyå’Œä¸æ˜“å˜åŠ¨çš„keyå°½é‡ä¸è¦æ”¾åœ¨ä¸€èµ·ï¼Œå½±å“é€Ÿåº¦ã€‚ï¼ˆå¦‚æœæ•´ä¸ªæ–‡ä»¶å¾ˆå°ï¼Œé‚£ä¹ˆå¿½ç•¥å§ï¼Œä¸ºäº†è¿™ç‚¹æ€§èƒ½æ·»åŠ ç»´æŠ¤æˆæœ¬å¾—ä¸å¿å¤±ï¼‰</li><li>ä¸è¦ä¹±editå’Œapplyï¼Œæ¯æ¬¡editä¼šåˆ›å»ºæ–°çš„EditorImplå¯¹è±¡ï¼Œå°½é‡æ‰¹é‡ä¿®æ”¹ä¸€æ¬¡æäº¤ï¼</li><li>å°½é‡ä¸è¦å­˜æ”¾JSONå’ŒHTMLï¼Œè¿™ç§åœºæ™¯è¯·ç›´æ¥ä½¿ç”¨jsonï¼ˆæ–‡ä»¶å­˜å–ï¼‰ï¼</li><li>Commitå‘ç”Ÿåœ¨UIçº¿ç¨‹ä¸­ï¼Œapplyå‘ç”Ÿåœ¨å·¥ä½œçº¿ç¨‹ä¸­ï¼Œå¯¹äºæ•°æ®çš„æäº¤æœ€å¥½æ˜¯æ‰¹é‡æ“ä½œç»Ÿä¸€æäº¤ã€‚è™½ç„¶applyå‘ç”Ÿåœ¨å·¥ä½œçº¿ç¨‹ï¼ˆä¸ä¼šå› ä¸ºIOé˜»å¡UIçº¿ç¨‹ï¼‰ä½†æ˜¯å¦‚æœæ·»åŠ ä»»åŠ¡è¾ƒå¤šä¹Ÿæœ‰å¯èƒ½å¸¦æ¥å…¶ä»–ä¸¥é‡åæœï¼ˆå‚ç…§ActivityThreadæºç ä¸­handleStopActivityæ–¹æ³•å®ç°ï¼‰ã€‚</li><li>è·¨è¿›ç¨‹é€šä¿¡ä¸å¯é </li></ol>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>shadowsocksæœåŠ¡ç«¯éƒ¨ç½²</title>
      <link href="/2018/07/18/shadowsocks%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%83%A8%E7%BD%B2/"/>
      <content type="html"><![CDATA[<p>åŸºäºUbuntu 16.04çš„ShadowsocksæœåŠ¡ç«¯å®‰è£…</p><a id="more"></a><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3><h5 id="1ï¼Œé¦–å…ˆæ£€æŸ¥ä¸‹Python-ç‰ˆæœ¬ï¼Œè¦æœ‰-2-6-or-2-7"><a href="#1ï¼Œé¦–å…ˆæ£€æŸ¥ä¸‹Python-ç‰ˆæœ¬ï¼Œè¦æœ‰-2-6-or-2-7" class="headerlink" title="1ï¼Œé¦–å…ˆæ£€æŸ¥ä¸‹Python ç‰ˆæœ¬ï¼Œè¦æœ‰ 2.6 or 2.7."></a>1ï¼Œé¦–å…ˆæ£€æŸ¥ä¸‹Python ç‰ˆæœ¬ï¼Œè¦æœ‰ 2.6 or 2.7.</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">python</span> <span class="selector-tag">--version</span></div><div class="line"><span class="selector-tag">Python</span> 2<span class="selector-class">.7</span><span class="selector-class">.4</span></div></pre></td></tr></table></figure><h5 id="2ï¼Œå®‰è£…pythonåŒ…ç®¡ç†å™¨"><a href="#2ï¼Œå®‰è£…pythonåŒ…ç®¡ç†å™¨" class="headerlink" title="2ï¼Œå®‰è£…pythonåŒ…ç®¡ç†å™¨"></a>2ï¼Œå®‰è£…pythonåŒ…ç®¡ç†å™¨</h5><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-<span class="built_in">get</span> install <span class="keyword">python</span>-pip</div></pre></td></tr></table></figure><h5 id="3ï¼Œå®‰è£…shadowsocks"><a href="#3ï¼Œå®‰è£…shadowsocks" class="headerlink" title="3ï¼Œå®‰è£…shadowsocks"></a>3ï¼Œå®‰è£…shadowsocks</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip <span class="keyword">install</span> shadowsocks</div></pre></td></tr></table></figure><h5 id="4ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#4ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="4ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶"></a>4ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶</h5><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/shadowsocks/<span class="built_in">config</span>.json</div></pre></td></tr></table></figure><figure class="highlight monkey"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"server"</span>:<span class="string">"0.0.0.0"</span>,</div><div class="line">    <span class="string">"server_port"</span>:<span class="number">8388</span>,</div><div class="line">    <span class="string">"local_address"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="string">"local_port"</span>:<span class="number">1080</span>,</div><div class="line">    <span class="string">"password"</span>:<span class="string">"yourpsw"</span>,</div><div class="line">    <span class="string">"timeout"</span>:<span class="number">300</span>,</div><div class="line">    <span class="string">"method"</span>:<span class="string">"bf-cfb"</span>,</div><div class="line">    <span class="string">"fast_open"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">"workers"</span>: <span class="number">10</span></div><div class="line">&#125;</div><div class="line">æ³¨æ„ï¼š</div><div class="line">server <span class="number">0</span>ï¼Œ<span class="number">0</span>ï¼Œ<span class="number">0</span>ï¼Œ<span class="number">0</span>ï¼ˆå…¶ä»–å¯èƒ½å‡ºé—®é¢˜ï¼‰</div><div class="line"><span class="function"><span class="keyword">method</span> <span class="title">bf</span>-<span class="title">cfb</span>ï¼ˆå…¶ä»–å¯èƒ½å‡ºé—®é¢˜ï¼‰</span></div></pre></td></tr></table></figure><h5 id="5ï¼Œå¼€å¯"><a href="#5ï¼Œå¼€å¯" class="headerlink" title="5ï¼Œå¼€å¯"></a>5ï¼Œå¼€å¯</h5><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo ssserver -c /etc/shadowsocks/<span class="built_in">config</span>.json</div></pre></td></tr></table></figure><h5 id="6ï¼Œè®¾ç½®ä¸ºå¼€æœºå¯åŠ¨"><a href="#6ï¼Œè®¾ç½®ä¸ºå¼€æœºå¯åŠ¨" class="headerlink" title="6ï¼Œè®¾ç½®ä¸ºå¼€æœºå¯åŠ¨"></a>6ï¼Œè®¾ç½®ä¸ºå¼€æœºå¯åŠ¨</h5><ul><li><h6 id="ç¼–è¾‘"><a href="#ç¼–è¾‘" class="headerlink" title="ç¼–è¾‘"></a>ç¼–è¾‘</h6></li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim /etc/rc.<span class="keyword">local</span></div></pre></td></tr></table></figure><ul><li><h6 id="ç„¶ååœ¨exit-0ä¹‹å‰åŠ å…¥"><a href="#ç„¶ååœ¨exit-0ä¹‹å‰åŠ å…¥" class="headerlink" title="ç„¶ååœ¨exit 0ä¹‹å‰åŠ å…¥"></a>ç„¶ååœ¨exit 0ä¹‹å‰åŠ å…¥</h6><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo ssserver -c /etc/shadowsocks/<span class="built_in">config</span>.json</div></pre></td></tr></table></figure></li><li><h6 id="é‡å¯"><a href="#é‡å¯" class="headerlink" title="é‡å¯"></a>é‡å¯</h6></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">â— reboot</div></pre></td></tr></table></figure><ul><li><h6 id="é‡å¯åæŸ¥çœ‹è¿›ç¨‹"><a href="#é‡å¯åæŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="é‡å¯åæŸ¥çœ‹è¿›ç¨‹"></a>é‡å¯åæŸ¥çœ‹è¿›ç¨‹</h6></li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ps</span> aux | <span class="keyword">grep</span> shadowsocks</div></pre></td></tr></table></figure><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://blog.csdn.net/sjtu_mc/article/details/79207427" target="_blank" rel="external">å‚è€ƒ1</a></p><p><a href="https://github.com/shadowsocks/shadowsocks/wiki/Shadowsocks-%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" target="_blank" rel="external">å‚è€ƒ2</a></p><p><a href="https://hceasy.com/2013/12/shadowsocks-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%83%A8%E7%BD%B2/" target="_blank" rel="external">å‚è€ƒ3</a></p>]]></content>
      
      <categories>
          
          <category> Dev </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dev </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mysqlå…³è”é˜¿é‡Œäº‘dms</title>
      <link href="/2018/06/14/mysql%E5%85%B3%E8%81%94%E9%98%BF%E9%87%8C%E4%BA%91dms/"/>
      <content type="html"><![CDATA[<p>å°†è¿œç¨‹æœåŠ¡å™¨ä¸­çš„mysqlç»‘å®šåˆ°é˜¿é‡Œäº‘DMSä¸­</p><a id="more"></a><h4 id="é˜¿é‡Œäº‘DMSç»‘å®šmysql"><a href="#é˜¿é‡Œäº‘DMSç»‘å®šmysql" class="headerlink" title="é˜¿é‡Œäº‘DMSç»‘å®šmysql"></a>é˜¿é‡Œäº‘DMSç»‘å®šmysql</h4><p><img src="https://img-blog.csdn.net/20180608174133433?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Zlbmdhbml0/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="æŸ¥çœ‹æˆªå›¾"></p><h4 id="æ•°æ®ç®¡ç†DMSç™»å½•äº‘æœåŠ¡å™¨çš„IPæ®µï¼ˆç»å…¸ç½‘ç»œï¼‰ï¼š"><a href="#æ•°æ®ç®¡ç†DMSç™»å½•äº‘æœåŠ¡å™¨çš„IPæ®µï¼ˆç»å…¸ç½‘ç»œï¼‰ï¼š" class="headerlink" title="æ•°æ®ç®¡ç†DMSç™»å½•äº‘æœåŠ¡å™¨çš„IPæ®µï¼ˆç»å…¸ç½‘ç»œï¼‰ï¼š"></a><strong>æ•°æ®ç®¡ç†DMSç™»å½•äº‘æœåŠ¡å™¨çš„IPæ®µï¼ˆç»å…¸ç½‘ç»œï¼‰ï¼š</strong></h4><p><a href="https://help.aliyun.com/knowledge_detail/51251.html" target="_blank" rel="external">DMSçš„ipæ®µ</a></p><p>120.55.177.0/24</p><p>121.43.18.0/24</p><p>101.37.74.0/24</p><p>10.153.176.106/24</p><p>10.137.42.136/24</p><p>11.193.54.0/24</p><p>æ•°æ®ç®¡ç†DMSç™»å½•äº‘æœåŠ¡å™¨çš„IPæ®µï¼ˆVPCï¼‰ï¼š</p><p>100.104.175.0/24</p><p>100.104.72.0/24</p><p>100.104.5.0/24</p><p>100.104.205.0/24</p><p><strong>æ·»åŠ ç™½åå•</strong><br>1ï¼Œç™»å½•mysqlï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -h host -u username -<span class="selector-tag">p</span> password</div></pre></td></tr></table></figure><p>2ï¼Œåˆ‡æ¢è‡³mysqlåº“ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">mysql</span>;</div></pre></td></tr></table></figure><p>3 æŸ¥çœ‹å½“å‰å…è®¸ç™»å½•IPåŠç”¨æˆ·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> Host,<span class="keyword">User</span> <span class="keyword">from</span> <span class="keyword">user</span>;</div></pre></td></tr></table></figure><p>4 åˆ é™¤ä¸å¿…è¦è€Œè¡¨ä¸­å­˜åœ¨çš„IPå’Œç”¨æˆ·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> <span class="keyword">User</span>=<span class="string">'username'</span> <span class="keyword">and</span> Host=<span class="string">'host'</span>;</div></pre></td></tr></table></figure><p>(hostå€¼ä¸ºâ€œ%â€æˆ–ç©ºè¡¨ç¤ºæ‰€æœ‰IPéƒ½å¯ç™»å½•ï¼Œä¸€èˆ¬æ¥è¯´æ­¤ç±»è¡Œéœ€è¦åˆ æ‰)</p><p>5 å¢åŠ éœ€è¦è€Œè¡¨ä¸­æ²¡æœ‰çš„IPå’Œç”¨æˆ·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'username'</span>@<span class="string">'host'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'password'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</div></pre></td></tr></table></figure><p>6 ä½¿æ›´æ–°çš„é…ç½®ç”Ÿæ•ˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</div></pre></td></tr></table></figure><h4 id="ç™»å½•mysqlå¤±è´¥é—®é¢˜"><a href="#ç™»å½•mysqlå¤±è´¥é—®é¢˜" class="headerlink" title="ç™»å½•mysqlå¤±è´¥é—®é¢˜"></a>ç™»å½•mysqlå¤±è´¥é—®é¢˜</h4><p><strong>é”™è¯¯ ERROR 1045 (28000): Access denied for user â€˜rootâ€™@â€™localhostâ€™ (using password: YE</strong>S)</p><ul><li>vim /etc/my.cnf(æ³¨ï¼šwindowsä¸‹ä¿®æ”¹çš„æ˜¯my.ini)</li></ul><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">[mysqld]</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="attr">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span></div><div class="line"></div><div class="line"><span class="comment"># ä¸€èˆ¬é…ç½®é€‰é¡¹</span></div><div class="line"><span class="attr">basedir</span> = /usr/local/mysql</div><div class="line"><span class="attr">datadir</span> = /usr/local/mysql/data</div><div class="line"><span class="attr">port</span> = <span class="number">3306</span></div><div class="line"><span class="attr">socket</span> = /tmp/mysql.sock</div><div class="line"><span class="attr">character-set-server=utf8</span></div><div class="line"><span class="comment">#åœ¨æ­¤æ·»åŠ ã€ä¸»æ„æ˜¯åœ¨[mysqld]å†…éƒ¨ã€‘</span></div><div class="line">skip-grant-tables</div><div class="line"></div><div class="line"><span class="attr">back_log</span> = <span class="number">300</span></div><div class="line"><span class="attr">max_connections</span> = <span class="number">1000</span></div><div class="line"><span class="attr">max_connect_errors</span> = <span class="number">50</span></div><div class="line"><span class="attr">table_open_cache</span> = <span class="number">4096</span></div><div class="line"><span class="attr">max_allowed_packet</span> = <span class="number">32</span>M</div><div class="line"><span class="comment">#binlog_cache_size = 4M</span></div></pre></td></tr></table></figure><p>:wq ä¿å­˜</p><ul><li>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦é‡å¯MySQLï¼š</li></ul><p><a href="https://www.cnblogs.com/adolfmc/p/5497974.html" target="_blank" rel="external">å„ä¸ªå¹³å°é‡å¯mysqlçš„æ–¹å¼</a></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">service mysqld restart</span></div></pre></td></tr></table></figure><ul><li>é‡å¯ä¹‹åè¾“å…¥#mysqlå³å¯è¿›å…¥mysqlã€‚</li></ul><ul><li>æ¥ä¸‹æ¥å°±æ˜¯ç”¨sqlæ¥ä¿®æ”¹rootçš„å¯†ç </li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; use mysql<span class="comment">;</span></div><div class="line">mysql&gt; update user set password=password(<span class="string">"ä½ çš„æ–°å¯†ç "</span>) where user=<span class="string">"root"</span><span class="comment">;</span></div><div class="line">mysql&gt; flush privileges<span class="comment">;</span></div><div class="line">mysql&gt; quit</div><div class="line"></div><div class="line">åˆ°è¿™é‡Œrootè´¦æˆ·å°±å·²ç»é‡ç½®æˆæ–°çš„å¯†ç äº†ã€‚</div></pre></td></tr></table></figure><ul><li>5.ç¼–è¾‘my.cnf,å»æ‰åˆšæ‰æ·»åŠ çš„å†…å®¹ï¼Œç„¶åé‡å¯MySQLã€‚</li></ul><h6 id="æŸ¥çœ‹å½“å‰mysqlç”¨æˆ·è¡¨"><a href="#æŸ¥çœ‹å½“å‰mysqlç”¨æˆ·è¡¨" class="headerlink" title="æŸ¥çœ‹å½“å‰mysqlç”¨æˆ·è¡¨"></a>æŸ¥çœ‹å½“å‰mysqlç”¨æˆ·è¡¨</h6><p>hostä¸º% ä»£è¡¨ä»»æ„åŸŸåä¸‹éƒ½å¯ä»¥è®¿é—®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="section">mysql&gt; select Host,User from user;</span></div><div class="line">+-----------------+-----------+</div><div class="line"><span class="section">| Host            | User      |</span></div><div class="line">+-----------------+-----------+</div><div class="line">| %               | dms       |</div><div class="line">| 120.55.177.0/24 | dms       |</div><div class="line">| localhost       | mysql.sys |</div><div class="line"><span class="section">| localhost       | root      |</span></div><div class="line">+-----------------+-----------+</div><div class="line">4 rows in set (0.00 sec)</div></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Dev </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dev </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ReactNativeç¢ç‰‡æ•´ç†ä¹‹Props</title>
      <link href="/2018/04/28/ReactNative%E7%A2%8E%E7%89%87%E6%95%B4%E7%90%86%E4%B9%8BProps/"/>
      <content type="html"><![CDATA[<p>propsçš„å±æ€§éƒ½æ˜¯çˆ¶ç»„ä»¶ä¼ é€’çš„ï¼Œæ‰€ä»¥æ— æ³•ä¿®æ”¹å®ƒï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŒ‡å®šé»˜è®¤propï¼›</p><a id="more"></a><h3 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h3><p>å¤§å¤šæ•°ç»„ä»¶åˆ›å»ºçš„æ—¶å°±å¯ä»¥ä½¿ç”¨å„ç§å‚æ•°æ¥å®šåˆ¶ï¼ˆå¯ä»¥ç†è§£ä¸ºAndroidè‡ªå®šä¹‰Viewçš„ä¼ å€¼ï¼‰ã€‚ä½†è¿™æ˜¯ä¸å‡†ç¡®çš„ï¼Œpropsåœ¨RNä¸­ä»£è¡¨ç€å±æ€§ï¼Œæ˜¯ä¸ºäº†æè¿°ä¸€ä¸ªç»„ä»¶çš„ç‰¹å¾è€Œå­˜åœ¨ï¼Œå®ƒæ˜¯ç”±çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„ï¼ˆè°ƒç”¨æ–¹ä¼ å…¥ï¼‰è€Œä¸”ä¸€ç»æŒ‡å®šï¼Œåœ¨è¢«æŒ‡å®šçš„ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåˆ™ä¸åœ¨æ”¹å˜ï¼ˆè¿™ä¸stateä¸åŒï¼‰ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨çˆ¶ç»„ä»¶ä¸­å®šä¹‰å­ç»„ä»¶çš„å±æ€§ï¼Œä½†ä¸å¯ä»¥æ·»åŠ é»˜è®¤å±æ€§ï¼ˆå¯ä»¥åœ¨å­ç»„ä»¶ä¸­æ·»åŠ é»˜è®¤å±æ€§ï¼‰ï¼Œpropsé™¤äº†ä¼ é€’å±æ€§å€¼ï¼Œè¿˜æœ‰çº¦æŸä½œç”¨â€¦</p><h3 id="æ™®é€šä½¿ç”¨"><a href="#æ™®é€šä½¿ç”¨" class="headerlink" title="æ™®é€šä½¿ç”¨"></a>æ™®é€šä½¿ç”¨</h3><p>ä»¥å¸¸è§çš„åŸºç¡€ç»„ä»¶<code>Image</code>ä¸ºä¾‹ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªå›¾ç‰‡æ—¶ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªåä¸º<code>source</code>çš„ prop æ¥æŒ‡å®šè¦æ˜¾ç¤ºçš„å›¾ç‰‡çš„åœ°å€ï¼Œä»¥åŠä½¿ç”¨åä¸º<code>style</code>çš„ prop æ¥æ§åˆ¶å…¶å°ºå¯¸ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Image &#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Bananas</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">let</span> pic = &#123;</div><div class="line">      <span class="attr">uri</span>: <span class="string">'https://upload.wikimedia.org/wikipedia/commons/d/de/Bananavarieties.jpg'</span></div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      <span class="xml"><span class="tag">&lt;<span class="name">Image</span> <span class="attr">source</span>=<span class="string">&#123;pic&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;width:</span> <span class="attr">193</span>, <span class="attr">height:</span> <span class="attr">110</span>&#125;&#125; /&gt;</span></span></div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯propçš„æœ€ç®€å•çš„ç†è§£ï¼ŒåŸºç¡€ç»„ä»¶<code>Image</code>çš„<code>style</code>å’Œ<code>resource</code>éƒ½æ˜¯å®ƒçš„<code>prop</code>å±æ€§</p><h3 id="è‡ªå®šä¹‰Props"><a href="#è‡ªå®šä¹‰Props" class="headerlink" title="è‡ªå®šä¹‰Props"></a>è‡ªå®šä¹‰Props</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">    View,</div><div class="line">    StyleSheet,</div><div class="line">    Alert,</div><div class="line">    TouchableOpacity,</div><div class="line">    Text,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyText</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="comment">// æ„é€ </span></div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//æŒ‡å®šé»˜è®¤props</span></div><div class="line">    <span class="keyword">static</span> defaultProps = &#123;</div><div class="line">        <span class="attr">myText</span>: <span class="string">'é»˜è®¤å€¼'</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></div><div class="line">                Alert.alert('Alert')</div><div class="line">            &#125;&#125;&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                    hello &#123;this.props.myText&#125;!</div><div class="line">                <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;View style=&#123;&#123;alignItems: 'center'&#125;&#125;&gt;</div><div class="line">                &lt;MyText myText='æµ‹è¯•'/&gt;</div><div class="line">                &lt;MyText myText='android'/&gt;</div><div class="line">                &lt;MyText myText='ios'/&gt;</div><div class="line">                &#123;/*ä¼ å…¥æœªæŒ‡å®šçš„pros*/&#125;</div><div class="line">                &lt;MyText test='hello'/&gt;</div><div class="line">                &#123;/*æœªä¼ å…¥pros*/&#125;</div><div class="line">                &lt;MyText /&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    continer: &#123;</div><div class="line">        color: '#ffffff',</div><div class="line">        fontSize: 17,</div><div class="line">        backgroundColor: '#00a056',</div><div class="line">        margin: 20,</div><div class="line">        padding: 10,</div><div class="line">        shadowColor: '#00a056',</div><div class="line">        shadowOffset: &#123;width: 3, height: 3&#125;,</div><div class="line">        shadowOpacity: 0.5,</div><div class="line">        shadowRadius: 4</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1ftpkp21prij30bc0m1q2z.jpg" width="200"></p><h3 id="propsçº¦æŸ"><a href="#propsçº¦æŸ" class="headerlink" title="propsçº¦æŸ"></a>propsçº¦æŸ</h3><p>ä½¿ç”¨PropTypes å·²ç»è¢«å–æ¶ˆäº†</p><p><a href="https://blog.csdn.net/allangold/article/details/78843333" target="_blank" rel="external">react nativeå…³äº ä»reactä¸­å¼•å…¥PropTypesæŠ¥é”™çš„é—®é¢˜</a></p><h3 id="æ–¹æ³•ä¸­è°ƒç”¨this-propsçš„é—®é¢˜"><a href="#æ–¹æ³•ä¸­è°ƒç”¨this-propsçš„é—®é¢˜" class="headerlink" title="æ–¹æ³•ä¸­è°ƒç”¨this.propsçš„é—®é¢˜"></a>æ–¹æ³•ä¸­è°ƒç”¨this.propsçš„é—®é¢˜</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123;</div><div class="line">    View,</div><div class="line">    StyleSheet,</div><div class="line">    Alert,</div><div class="line">    TouchableOpacity,</div><div class="line">    Text,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyText</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="comment">// æ„é€ </span></div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//æŒ‡å®šé»˜è®¤props</span></div><div class="line">    <span class="keyword">static</span> defaultProps = &#123;</div><div class="line">        <span class="attr">name</span>: <span class="string">'å†¯è‹±ä¿Š'</span>,</div><div class="line">        <span class="attr">age</span>: <span class="number">1</span>,</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//ç‚¹å‡»å¼¹å‡ºä¼ å…¥çš„ä¿¡æ¯</span></div><div class="line">    _onClickEvent() &#123;</div><div class="line">        Alert.alert(<span class="keyword">this</span>.props.name, <span class="string">"å¹´çºª"</span> + <span class="keyword">this</span>.props.age)</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;this._onClickEvent&#125;</span>&gt;</span></span></div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                    hello &#123;this.props.name&#125;ä½ çš„å¹´çºªæ˜¯&#123;this.props.age&#125;!</div><div class="line">                <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;View style=&#123;&#123;alignItems: 'center'&#125;&#125;&gt;</div><div class="line">                &lt;MyText name='åˆ˜å¾·å' age=&#123;20&#125;/&gt;</div><div class="line">                &lt;MyText age=&#123;18&#125;/&gt;</div><div class="line">                &lt;MyText name='åˆ˜å¾·å' age=&#123;22&#125;/&gt;</div><div class="line">                &lt;MyText name='åˆ˜å¾·å' age=&#123;30&#125;/&gt;</div><div class="line"></div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    continer: &#123;</div><div class="line">        color: '#ffffff',</div><div class="line">        fontSize: 17,</div><div class="line">        backgroundColor: '#00a056',</div><div class="line">        margin: 20,</div><div class="line">        padding: 10,</div><div class="line">        shadowColor: '#00a056',</div><div class="line">        shadowOffset: &#123;width: 3, height: 3&#125;,</div><div class="line">        shadowOpacity: 0.5,</div><div class="line">        shadowRadius: 4</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1ftplzf9renj30bc0m174y.jpg" width="200"></p><p><a href="https://www.jianshu.com/p/ce970791aba4" target="_blank" rel="external">React Nativeç»‘å®šthis(bind(this))</a></p><p><a href="https://blog.csdn.net/sinat_34693148/article/details/72631956" target="_blank" rel="external">ã€React Nativeã€‘React Nativeçš„bindæ–¹æ³•</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">_onClickEvent() &#123;</div><div class="line">    Alert.alert(<span class="keyword">this</span>.props.name, <span class="string">"å¹´çºª"</span> + <span class="keyword">this</span>.props.age)</div><div class="line">&#125;</div><div class="line"><span class="comment">//ä¿®æ”¹ä¸ºï¼š</span></div><div class="line">render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">        <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> this._onClickEvent()&#125;&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                hello &#123;this.props.name&#125;ä½ çš„å¹´çºªæ˜¯&#123;this.props.age&#125;!</div><div class="line">            <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">    )</div><div class="line">&#125;</div><div class="line"><span class="comment">//æˆ–è€…</span></div><div class="line">render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span>&#123;</span></div><div class="line">                Alert.alert(this.props.name, "å¹´çºª" + this.props.age)</div><div class="line">            &#125;&#125;&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                    hello &#123;this.props.name&#125;ä½ çš„å¹´çºªæ˜¯&#123;this.props.age&#125;!</div><div class="line">                <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line"><span class="comment">//æˆ–è€…</span></div><div class="line">render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;this._onClickEvent.bind(this)&#125;</span>&gt;</span></span></div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                    hello &#123;this.props.name&#125;ä½ çš„å¹´çºªæ˜¯&#123;this.props.age&#125;!</div><div class="line">                <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line"><span class="comment">//æˆ–è€… ç®­å¤´å‡½æ•°å®Œæˆbind</span></div><div class="line"> render() &#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            <span class="xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">onPress</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></div><div class="line">                this._onClickEvent('hello')</div><div class="line">            &#125;&#125;&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.continer&#125;</span>&gt;</span></div><div class="line">                    hello &#123;this.props.name&#125;ä½ çš„å¹´çºªæ˜¯&#123;this.props.age&#125;!</div><div class="line">                <span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></div><div class="line">        )</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p><strong>å…³äºReactNativeçš„thisæ›´å¤šå†…å®¹åé¢ä¼šå†æ•´ç†</strong></p><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://reactnative.cn/docs/props.html" target="_blank" rel="external">ReactNativeä¸­æ–‡ç½‘</a></p>]]></content>
      
      <categories>
          
          <category> RN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RN </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æµ…æDalvikå’ŒARTçš„åŒºåˆ«</title>
      <link href="/2018/03/05/%E6%B5%85%E6%9E%90Dalvik%E5%92%8CART%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <content type="html"><![CDATA[<p>Dalvikæ˜¯Googleå…¬å¸è‡ªå·±è®¾è®¡ç”¨äºAndroidå¹³å°çš„è™šæ‹Ÿæœºï¼ŒDalvikç»è¿‡ä¼˜åŒ–ï¼Œæ›´åŠ é€‚åˆAndroidå¹³å°ï¼ˆå…·ä½“ä¼˜ç‚¹è§ä¸‹é¢å’ŒJVMæ¯”è¾ƒï¼‰ã€‚</p><p>2014å¹´6æœˆè°·æ­ŒI/Oå¤§ä¼šä¸Šï¼ŒAndroid L(5.0)æ”¹åŠ¨å¹…åº¦æ¯”è¾ƒå¤§ï¼Œåˆ é™¤äº†Dalvikï¼Œè€Œæ˜¯ç”¨ARTä»£æ›¿ã€‚</p><p>ä¹‹å‰å¯¹æœ¬å—çš„çŸ¥è¯†ç†è§£æ¯”è¾ƒé›¶æ•£ï¼Œå†æ­¤æœ¬æ–‡æ€»ç»“ä¸‹Dalvikå’ŒARTçš„åŸç†ï¼Œå’ŒäºŒè€…çš„åŒºåˆ«ï¼Œä»¥åŠJvmå’ŒDalvikçš„åŒºåˆ«ï¼Œä»¥åŠAndroidçš„Apkç¼–è¯‘æ‰“åŒ…çš„æµç¨‹</p><a id="more"></a><h3 id="Dalvikçš„ç›¸å…³çŸ¥è¯†"><a href="#Dalvikçš„ç›¸å…³çŸ¥è¯†" class="headerlink" title="Dalvikçš„ç›¸å…³çŸ¥è¯†"></a>Dalvikçš„ç›¸å…³çŸ¥è¯†</h3><ul><li><strong>Google</strong>å…¬å¸è‡ªå·±è®¾è®¡<strong>ç”¨äºAndroidå¹³å°</strong>çš„<strong>javaè™šæ‹Ÿæœº</strong></li><li>æ”¯æŒ.dexï¼ˆå³Dalvik Executableï¼‰æ ¼å¼çš„javaåº”ç”¨ç¨‹åºè¿è¡Œ</li><li>åŸºäºå¯„å­˜å™¨ï¼Œå¯„å­˜å™¨CPUçš„ä¸€éƒ¨åˆ†ï¼ˆé€‚åˆå†…å­˜å’Œå¤„ç†å™¨æœ‰é™çš„ç³»ç»Ÿï¼‰</li><li>å…è®¸æœ‰é™çš„å†…å­˜åŒæ—¶è¿è¡Œå¤šä¸ªDalvikè™šæ‹Ÿæœºçš„å®ä¾‹</li><li>æ¯ä¸ªDalvikåº”ç”¨ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„Linuxè¿›ç¨‹æ‰§è¡Œï¼Œé˜²æ­¢ä¸€ä¸ªç¨‹åºå´©æºƒå¯¼è‡´æ‰€æœ‰ç¨‹åºå´©æºƒ</li></ul><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fp1zktmabmj30hm0r6780.jpg" alt=""></p><h3 id="Jvmçš„ç›¸å…³çŸ¥è¯†"><a href="#Jvmçš„ç›¸å…³çŸ¥è¯†" class="headerlink" title="Jvmçš„ç›¸å…³çŸ¥è¯†"></a>Jvmçš„ç›¸å…³çŸ¥è¯†</h3><ul><li>åŸºäºæ ˆï¼ˆå†…å­˜çš„ä¸€éƒ¨åˆ†ï¼‰</li><li>javacæŠŠç¨‹åºæºç ç¼–è¯‘æˆJAVAå­—èŠ‚ç åï¼ŒJVMé€šè¿‡é€æ¡è§£é‡Šå­—èŠ‚ç ç¿»è¯‘æˆæœºå™¨æŒ‡ä»¤</li></ul><h3 id="Dalvikå’ŒJvmçš„åŒºåˆ«ä¸è”ç³»"><a href="#Dalvikå’ŒJvmçš„åŒºåˆ«ä¸è”ç³»" class="headerlink" title="Dalvikå’ŒJvmçš„åŒºåˆ«ä¸è”ç³»"></a>Dalvikå’ŒJvmçš„åŒºåˆ«ä¸è”ç³»</h3><h4 id="å›¾è¡¨åŒºåˆ«"><a href="#å›¾è¡¨åŒºåˆ«" class="headerlink" title="å›¾è¡¨åŒºåˆ«"></a>å›¾è¡¨åŒºåˆ«</h4><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">æœ¬è´¨</th><th style="text-align:center">å­—èŠ‚ç æ–‡ä»¶</th><th style="text-align:center">æ•ˆç‡</th></tr></thead><tbody><tr><td style="text-align:center">Dalvik</td><td style="text-align:center">åŸºäºå¯„å­˜å™¨</td><td style="text-align:center">ä¸€ä¸ª.Dexæ–‡ä»¶</td><td style="text-align:center">é«˜</td></tr><tr><td style="text-align:center">Jvm</td><td style="text-align:center">åŸºäºæ ˆ</td><td style="text-align:center">å¤šä¸ª.classæ–‡ä»¶</td><td style="text-align:center">ä½</td></tr></tbody></table><h4 id="é¦–è¦åŒºåˆ«"><a href="#é¦–è¦åŒºåˆ«" class="headerlink" title="é¦–è¦åŒºåˆ«"></a>é¦–è¦åŒºåˆ«</h4><ul><li>DVMåŸºäºå¯„å­˜å™¨ï¼ŒJvmåŸºäºæ ˆï¼ŒåŸºäºå¯„å­˜å™¨çš„ç¼–è¯‘èŠ±è´¹æ—¶é—´æ›´çŸ­ï¼ˆåœ¨.dexå­—èŠ‚ç ä¸­ï¼Œå˜é‡ä¼šèµ‹å€¼ç»™65535ä¸ªå¯ç”¨å¯„å­˜å™¨ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼ŒDalvikæŒ‡ä»¤ç›´æ¥æ“ä½œè¿™äº›å¯„å­˜å™¨ï¼Œè€Œä¸æ˜¯è®¿é—®å †æ ˆä¸­çš„å…ƒç´ ã€‚ï¼‰</li><li>dexå­—èŠ‚ç æ›´é€‚åˆäºå†…å­˜å’Œå¤„ç†å™¨é€Ÿåº¦æœ‰é™çš„ç³»ç»Ÿ</li><li>åŸºäºå¯„å­˜å™¨çš„Dalvikå®ç°è™½ç„¶ç‰ºç‰²äº†ä¸€äº›<strong>å¹³å°æ— å…³æ€§</strong>ï¼Œä½†æ˜¯å®ƒåœ¨ä»£ç çš„æ‰§è¡Œæ•ˆç‡ä¸Šè¦æ›´èƒœä¸€ç­¹ã€‚</li><li>æ¯ä¸€ä¸ªAndroid çš„Appæ˜¯ç‹¬ç«‹è·‘åœ¨ä¸€ä¸ªVMä¸­çš„ã€‚å› æ­¤ä¸€ä¸ªApp crashåªä¼šå½±å“åˆ°è‡ªèº«çš„VMï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–ã€‚Dalvikç»è¿‡ä¼˜åŒ–ï¼Œå…è®¸åœ¨æœ‰é™çš„å†…å­˜ä¸­åŒæ—¶è¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºçš„å®ä¾‹ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ª Dalvikåº”ç”¨ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„Linuxè¿›ç¨‹æ‰§è¡Œã€‚</li></ul><h4 id="å­—èŠ‚ç åŒºåˆ«"><a href="#å­—èŠ‚ç åŒºåˆ«" class="headerlink" title="å­—èŠ‚ç åŒºåˆ«"></a>å­—èŠ‚ç åŒºåˆ«</h4><ul><li>JVMå­—èŠ‚ç ç”±.classç»„æˆï¼Œæ¯ä¸ªjavaæ–‡ä»¶å¯¹åº”ä¸€ä¸ª.class</li><li>DVMå­—èŠ‚ç åªåŒ…å«ä¸€ä¸ª.dexæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ç¨‹åºä¸­æ‰€æœ‰çš„ç±»</li></ul><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fp1zfxzxttj30jq0o8tau.jpg" alt="å›¾è§£.classå’Œ.dexæ–‡ä»¶ç”Ÿæˆè¿‡ç¨‹"></p><p><strong>Dalvikå¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯å°ã€‚Android SDKä¸­æœ‰ä¸€ä¸ªå«dxçš„å·¥å…·è´Ÿè´£å°†Javaå­—èŠ‚ç è½¬æ¢ä¸ºDalvikå­—èŠ‚ç ã€‚</strong></p><p>ç®€å•æ¥è®²ï¼Œdexæ ¼å¼æ–‡ä»¶å°±æ˜¯å°†å¤šä¸ªclassæ–‡ä»¶ä¸­å…¬æœ‰çš„éƒ¨åˆ†ç»Ÿä¸€å­˜æ”¾ï¼Œå»é™¤å†—ä½™ä¿¡æ¯ã€‚</p><h3 id="ARTçš„ç›¸å…³çŸ¥è¯†ï¼ˆAndroid-Runtimeï¼‰"><a href="#ARTçš„ç›¸å…³çŸ¥è¯†ï¼ˆAndroid-Runtimeï¼‰" class="headerlink" title="ARTçš„ç›¸å…³çŸ¥è¯†ï¼ˆAndroid Runtimeï¼‰"></a>ARTçš„ç›¸å…³çŸ¥è¯†ï¼ˆAndroid Runtimeï¼‰</h3><p>Android Runtimeï¼ˆç¼©å†™ä¸º ARTï¼‰ï¼Œæ˜¯ä¸€ç§åœ¨Androidæ“ä½œç³»ç»Ÿä¸Šçš„è¿è¡Œç¯å¢ƒï¼Œç”±Googleå…¬å¸ç ”å‘ï¼Œå¹¶åœ¨2013å¹´ä½œä¸ºAndroid 4.4ç³»ç»Ÿä¸­çš„ä¸€é¡¹æµ‹è¯•åŠŸèƒ½æ­£å¼å¯¹å¤–å‘å¸ƒï¼Œåœ¨Android 5.0åŠåç»­Androidç‰ˆæœ¬ä¸­ä½œä¸ºæ­£å¼çš„è¿è¡Œæ—¶åº“å–ä»£äº†ä»¥å¾€çš„Dalvikè™šæ‹Ÿæœºã€‚ARTèƒ½å¤ŸæŠŠåº”ç”¨ç¨‹åºçš„å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œæ˜¯Androidæ‰€ä½¿ç”¨çš„ä¸€ç§æ–°çš„è™šæ‹Ÿæœºã€‚å®ƒä¸Dalvikçš„ä¸»è¦ä¸åŒåœ¨äºï¼šDalviké‡‡ç”¨çš„æ˜¯JITæŠ€æœ¯ï¼Œè€ŒARTé‡‡ç”¨Ahead-of-timeï¼ˆAOTï¼‰æŠ€æœ¯ã€‚ ARTåŒæ—¶ä¹Ÿæ”¹å–„äº†æ€§èƒ½ã€åƒåœ¾å›æ”¶(Garbage Collection)ã€åº”ç”¨ç¨‹åºé™¤é”™ä»¥åŠæ€§èƒ½åˆ†æã€‚</p><p>JITæœ€æ—©åœ¨Android 2.2ç³»ç»Ÿä¸­å¼•è¿›åˆ°Dalvikè™šæ‹Ÿæœºä¸­ï¼Œåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼ŒJITé€šè¿‡è¿›è¡Œè¿ç»­çš„æ€§èƒ½åˆ†ææ¥ä¼˜åŒ–ç¨‹åºä»£ç çš„æ‰§è¡Œï¼Œåœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒDalvikè™šæ‹Ÿæœºåœ¨ä¸æ–­çš„è¿›è¡Œå°†å­—èŠ‚ç ç¼–è¯‘æˆæœºå™¨ç çš„å·¥ä½œã€‚ ä¸Dalvikè™šæ‹Ÿæœºä¸åŒçš„æ˜¯ï¼ŒARTå¼•å…¥äº†AOTè¿™ç§é¢„ç¼–è¯‘æŠ€æœ¯ï¼Œåœ¨åº”ç”¨ç¨‹åºå®‰è£…çš„è¿‡ç¨‹ä¸­ï¼ŒARTå°±å·²ç»å°†æ‰€æœ‰çš„å­—èŠ‚ç é‡æ–°ç¼–è¯‘æˆäº†æœºå™¨ç ã€‚åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ— éœ€è¿›è¡Œå®æ—¶çš„ç¼–è¯‘å·¥ä½œï¼Œåªéœ€è¦è¿›è¡Œç›´æ¥è°ƒç”¨ã€‚å› æ­¤ï¼ŒARTæå¤§çš„æé«˜äº†åº”ç”¨ç¨‹åºçš„è¿è¡Œæ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†æ‰‹æœºçš„ç”µé‡æ¶ˆè€—ï¼Œæé«˜äº†ç§»åŠ¨è®¾å¤‡çš„ç»­èˆªèƒ½åŠ›ï¼Œåœ¨åƒåœ¾å›æ”¶ç­‰æœºåˆ¶ä¸Šä¹Ÿæœ‰äº†è¾ƒå¤§çš„æå‡ã€‚ ä¸ºäº†ä¿è¯å‘ä¸‹å…¼å®¹ï¼ŒARTä½¿ç”¨äº†ç›¸åŒçš„Dalvikå­—èŠ‚ç æ–‡ä»¶ï¼ˆdexï¼‰ï¼Œå³åœ¨åº”ç”¨ç¨‹åºç›®å½•ä¸‹ä¿ç•™äº†dexæ–‡ä»¶ä¾›æ—§ç¨‹åºè°ƒç”¨ç„¶è€Œ.odexæ–‡ä»¶åˆ™æ›¿æ¢æˆäº†å¯æ‰§è¡Œä¸å¯é“¾æ¥æ ¼å¼ï¼ˆELFï¼‰å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸€æ—¦ä¸€ä¸ªç¨‹åºè¢«ARTçš„dex2oatå‘½ä»¤ç¼–è¯‘ï¼Œé‚£ä¹ˆè¿™ä¸ªç¨‹åºå°†ä¼šæŒ‡é€šè¿‡ELFå¯æ‰§è¡Œæ–‡ä»¶æ¥è¿è¡Œã€‚å› æ­¤ï¼Œç›¸å¯¹äºDalvikè™šæ‹Ÿæœºæ¨¡å¼ï¼ŒARTæ¨¡å¼ä¸‹Androidåº”ç”¨ç¨‹åºçš„å®‰è£…éœ€è¦æ¶ˆè€—æ›´å¤šçš„æ—¶é—´ï¼ŒåŒæ—¶ä¹Ÿä¼šå ç”¨æ›´å¤§çš„å‚¨å­˜ç©ºé—´ï¼ˆæŒ‡å†…éƒ¨å‚¨å­˜ï¼Œç”¨äºå‚¨å­˜ç¼–è¯‘åçš„ä»£ç ï¼‰,ä½†èŠ‚çœäº†å¾ˆå¤šDalvikè™šæ‹Ÿæœºç”¨äºå®æ—¶ç¼–è¯‘çš„æ—¶é—´ã€‚</p><p>Googleå…¬å¸åœ¨Android 4.4ä¸­å¸¦æ¥çš„ARTæ¨¡å¼ä»…ä»…æ˜¯ARTçš„ä¸€ä¸ªé¢„è§ˆç‰ˆï¼Œç³»ç»Ÿé»˜è®¤ä»ç„¶ä½¿ç”¨çš„æ˜¯Dalvikè™šæ‹Ÿæœºï¼Œ4.4ä¸Šé¢æä¾›çš„é¢„è§ˆç‰ˆARTç›¸å¯¹äºAndroid 5.0ä»¥åçš„ARTè¿è¡Œæ—¶åº“æœ‰è¾ƒå¤§çš„ä¸åŒï¼Œå°¤å…¶ä½“ç°åœ¨å…¼å®¹æ€§ä¸Šã€‚</p><p>æ€»ç»“ä¸€ä¸‹ä¸Šè¯‰å†…å®¹ï¼š</p><ul><li>Android 4.4ç³»ç»Ÿåå‡ºç°ï¼ˆé¢„è§ˆç‰ˆï¼‰ï¼Œç³»ç»Ÿé»˜è®¤ä»ç„¶ä½¿ç”¨çš„æ˜¯Dalvikè™šæ‹Ÿæœºï¼Œ5.0ä»¥åæ˜¯æ­£å¼ç‰ˆå–ä»£äº†Dalvikè™šæ‹Ÿæœº</li><li>ARTèƒ½å¤ŸæŠŠåº”ç”¨ç¨‹åºçš„å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œæ˜¯Androidæ‰€ä½¿ç”¨çš„ä¸€ç§æ–°çš„è™šæ‹Ÿæœº</li><li>ä¸ºäº†ä¿è¯å‘ä¸‹å…¼å®¹ï¼ŒARTä½¿ç”¨äº†ç›¸åŒçš„Dalvikå­—èŠ‚ç æ–‡ä»¶ï¼ˆdexï¼‰ï¼ˆè€Œåœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä¼šé€šè¿‡dex2oatå·¥å…·ç”ŸæˆOATæ–‡ä»¶ï¼Œå…·ä½“è§ä¸‹é¢åˆ†æï¼‰</li></ul><h3 id="Androidè¿è¡Œæ—¶ARTåŠ è½½OATæ–‡ä»¶è¿‡ç¨‹åˆ†æ"><a href="#Androidè¿è¡Œæ—¶ARTåŠ è½½OATæ–‡ä»¶è¿‡ç¨‹åˆ†æ" class="headerlink" title="Androidè¿è¡Œæ—¶ARTåŠ è½½OATæ–‡ä»¶è¿‡ç¨‹åˆ†æ"></a>Androidè¿è¡Œæ—¶ARTåŠ è½½OATæ–‡ä»¶è¿‡ç¨‹åˆ†æ</h3><p><a href="http://blog.csdn.net/luoshengyang/article/details/39307813" target="_blank" rel="external">æŸ¥çœ‹å…¶ä»–åšå®¢åˆ†æ</a></p><ul><li>ARTæ ¸å¿ƒæ˜¯OATæ–‡ä»¶</li><li>æ˜¯APKåœ¨å®‰è£…çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé€šè¿‡dex2oatå·¥å…·ç”Ÿæˆä¸€ä¸ªOATæ–‡ä»¶</li><li>APKå®‰è£…è¿‡ç¨‹ä¸­ç”Ÿæˆçš„OATæ–‡ä»¶çš„è¾“å…¥åªæœ‰ä¸€ä¸ªDEXæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¥è‡ªäºæ‰“åŒ…åœ¨è¦å®‰è£…çš„APKæ–‡ä»¶é‡Œé¢çš„classes.dexæ–‡ä»¶ï¼ˆå®é™…ä¸Šï¼Œä¸€ä¸ªOATæ–‡ä»¶æ˜¯å¯ä»¥ç”±è‹¥å¹²ä¸ªDEXç”Ÿæˆçš„ï¼‰</li><li>OATæ–‡ä»¶æ˜¯ä¸€ç§Androidç§æœ‰ELF</li><li>å®ƒä¸ä»…åŒ…å«æœ‰ä»DEXæ–‡ä»¶ç¿»è¯‘è€Œæ¥çš„æœ¬åœ°æœºå™¨æŒ‡ä»¤ï¼Œè¿˜åŒ…å«æœ‰åŸæ¥çš„DEXæ–‡ä»¶å†…å®¹</li></ul><h3 id="Dalvikå’ŒARTçš„åŒºåˆ«ä¸è”ç³»"><a href="#Dalvikå’ŒARTçš„åŒºåˆ«ä¸è”ç³»" class="headerlink" title="Dalvikå’ŒARTçš„åŒºåˆ«ä¸è”ç³»"></a>Dalvikå’ŒARTçš„åŒºåˆ«ä¸è”ç³»</h3><ul><li>Dalvikå’ŒARTä½¿ç”¨çš„çš„éƒ½æ˜¯.dexå­—èŠ‚ç ï¼Œäº‹å®ä¸Šæˆ‘ä»¬æŠŠapkè§£å‹åç¡®å®åªæœ‰classes.dexæ–‡ä»¶ï¼Œä½†æ˜¯åœ¨ARTè™šæ‹Ÿæœºåœ¨å®‰è£…è¿‡ç¨‹ä¸­é€šè¿‡dex2oatå·¥å…·å°†ä¸€ä¸ªæˆ–è€…è¯ºå¹²ä¸ªdexç”Ÿæˆä¸€ä¸ªOATæ–‡ä»¶</li><li>ARTï¼ˆAhead-of-time   AOTé¢„ç¼–è¯‘æŠ€æœ¯ï¼‰ï¼šåº”ç”¨ç¨‹åºåœ¨<strong>å®‰è£…è¿‡ç¨‹</strong>ä¸­ï¼ŒARTå°†æ‰€æœ‰çš„å­—èŠ‚ç é‡æ–°ç¼–è¯‘æˆäº†æœºå™¨ç ï¼Œæ‰€ä»¥åº”ç”¨ç¨‹åº<strong>è¿è¡Œä¸­</strong>æ— éœ€è¿›è¡Œå®æ—¶ç¼–è¯‘å·¥ä½œï¼Œåªéœ€è¦è¿›è¡Œç›´æ¥è°ƒç”¨ï¼Œå› æ­¤ï¼ŒARTæå¤§çš„æé«˜äº†åº”ç”¨ç¨‹åºçš„è¿è¡Œæ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†æ‰‹æœºçš„ç”µé‡æ¶ˆè€—ï¼Œæé«˜äº†ç§»åŠ¨è®¾å¤‡çš„ç»­èˆªèƒ½åŠ›ï¼Œåœ¨åƒåœ¾å›æ”¶ç­‰æœºåˆ¶ä¸Šä¹Ÿæœ‰äº†è¾ƒå¤§çš„æå‡ï¼Œä½†æ˜¯å®‰è£…éœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼ˆå­˜å‚¨ç¼–è¯‘åçš„ä»£ç ï¼‰å’Œæ—¶é—´ï¼ŒèŠ‚çœäº†å¾ˆå¤šDalvikè™šæ‹Ÿæœºç”¨äºå®æ—¶ç¼–è¯‘çš„æ—¶é—´</li><li>Dalvikï¼ˆJust-in-time  JITå³æ—¶ç¼–è¯‘æŠ€æœ¯ï¼‰ï¼šï¼ˆjvmä¹Ÿæ˜¯JITå³æ—¶ç¼–è¯‘ï¼‰ï¼Œåœ¨Dalvikä¸‹ï¼Œ<strong>åº”ç”¨æ¯æ¬¡è¿è¡Œ</strong>éƒ½éœ€è¦é€šè¿‡å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰å°†<strong>å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç </strong>ï¼Œå³æ¯æ¬¡éƒ½è¦ç¼–è¯‘åŠ è¿è¡Œã€‚è™½ç„¶å®‰è£…è¿‡ç¨‹æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯æ‹–æ…¢äº†åº”ç”¨æ¯æ¬¡å¯åŠ¨çš„é€Ÿåº¦</li></ul><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">ç¼–è¯‘æŠ€æœ¯</th><th style="text-align:center">ï¼ˆæ—¶æœºï¼‰å­—èŠ‚ç ç¼–è¯‘æœºå™¨ç </th><th style="text-align:center">å ç”¨ç©ºé—´</th><th>å®‰è£…æ—¶é—´</th><th style="text-align:center">è¿è¡Œæ•ˆç‡ï¼ˆï¼‰</th></tr></thead><tbody><tr><td style="text-align:center">Dalvik</td><td style="text-align:center">JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰</td><td style="text-align:center">é¦–æ¬¡å®‰è£…æ—¶</td><td style="text-align:center">å°</td><td>å¿«</td><td style="text-align:center">æ…¢</td></tr><tr><td style="text-align:center">ART</td><td style="text-align:center">AOTï¼ˆé¢„ç¼–è¯‘æŠ€æœ¯ï¼‰</td><td style="text-align:center">åº”ç”¨æ¯æ¬¡å¯åŠ¨æ—¶</td><td style="text-align:center">å¤§ï¼ˆ10-20%ï¼‰</td><td>æ»¡</td><td style="text-align:center">å¿«</td></tr></tbody></table><h3 id="å‡ å¼ æˆªå›¾æ€»ç»“"><a href="#å‡ å¼ æˆªå›¾æ€»ç»“" class="headerlink" title="å‡ å¼ æˆªå›¾æ€»ç»“"></a>å‡ å¼ æˆªå›¾æ€»ç»“</h3><p><a href="http://blog.csdn.net/jason0539/article/details/50440669" target="_blank" rel="external">æŸ¥çœ‹åŸæ–‡</a></p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fp230bcp69j31ie11m4e4.jpg" alt=""></p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fp230q7envj31hw0l277h.jpg" alt=""></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ThreadLocalçš„ç†è§£</title>
      <link href="/2018/03/02/ThreadLocal%E7%9A%84%E7%90%86%E8%A7%A3/"/>
      <content type="html"><![CDATA[<p>ThreadLocalç›¸å…³æ•´ç†</p><a id="more"></a><p>JDK1.2æä¾›</p><ul><li>æ ¹æ®JDKæ–‡æ¡£ä¸­çš„è§£é‡Šï¼š</li></ul><p>ThreadLocalçš„ä½œç”¨æ˜¯æä¾›çº¿ç¨‹å†…çš„å±€éƒ¨å˜é‡ï¼Œè¿™ç§å˜é‡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è®¿é—®æ—¶èƒ½å¤Ÿä¿è¯å„ä¸ªçº¿ç¨‹é‡Œå˜é‡çš„ç‹¬ç«‹æ€§ã€‚</p><p>å½“ä½¿ç”¨ThreadLocalç»´æŠ¤å˜é‡æ—¶ï¼ŒThreadLocalä¸ºæ¯ä¸ªä½¿ç”¨è¯¥å˜é‡çš„çº¿ç¨‹æä¾›ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹æ”¹å˜è¯¥å˜é‡çš„å‰¯æœ¬ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹æ‰€å¯¹åº”çš„å‰¯æœ¬ã€‚</p><h3 id="ThreadLocalçš„ä½¿ç”¨ï¼š"><a href="#ThreadLocalçš„ä½¿ç”¨ï¼š" class="headerlink" title="ThreadLocalçš„ä½¿ç”¨ï¼š"></a>ThreadLocalçš„ä½¿ç”¨ï¼š</h3><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1foyhets3pvj31kw15p4ac.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç”¨ThreadLocalå­˜æ”¾äº†ä¸€ä¸ªStringå­—ç¬¦ä¸²ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹setæ•°å€¼åï¼Œåªåœ¨å½“å‰çº¿ç¨‹ç®¡ç”¨ï¼Œæ‰€ä»¥è¯´ï¼Œå¦‚åŒä¸Šè¿°æ‰€è¯´çš„</p><ul><li>ä¸€ä¸ªThreadLocalå¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«</li><li>æ¯ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªThreadLocalçš„set getæ“ä½œåªé’ˆå¯¹å½“å‰çº¿ç¨‹ç®¡ç”¨</li></ul><h3 id="ThreadLocalçš„åŸç†ä»¥åŠæºç ä»‹ç»"><a href="#ThreadLocalçš„åŸç†ä»¥åŠæºç ä»‹ç»" class="headerlink" title="ThreadLocalçš„åŸç†ä»¥åŠæºç ä»‹ç»"></a>ThreadLocalçš„åŸç†ä»¥åŠæºç ä»‹ç»</h3><p>å¤§æ¦‚äº†è§£äº†ThreadLocalå¦‚ä½•ä½¿ç”¨ï¼Œé‚£ä¹ˆè¯·é—®ï¼ŒThreadLocalå¦‚ä½•ä¿è¯ä¸åŒçº¿ç¨‹çš„ç‹¬ç«‹æ€§çš„å‘¢ï¼Ÿ</p><h4 id="ThreadLocalå‡ ä¸ªå†…éƒ¨æ–¹æ³•"><a href="#ThreadLocalå‡ ä¸ªå†…éƒ¨æ–¹æ³•" class="headerlink" title="ThreadLocalå‡ ä¸ªå†…éƒ¨æ–¹æ³•"></a>ThreadLocalå‡ ä¸ªå†…éƒ¨æ–¹æ³•</h4><h5 id="protected-T-initialValue-ï¼ˆå¦‚æœä¸æƒ³åˆå§‹å€¼è¿”å›nullï¼Œéœ€è¦é‡å†™initialValueæ–¹æ³•ï¼‰"><a href="#protected-T-initialValue-ï¼ˆå¦‚æœä¸æƒ³åˆå§‹å€¼è¿”å›nullï¼Œéœ€è¦é‡å†™initialValueæ–¹æ³•ï¼‰" class="headerlink" title="protected T initialValue()ï¼ˆå¦‚æœä¸æƒ³åˆå§‹å€¼è¿”å›nullï¼Œéœ€è¦é‡å†™initialValueæ–¹æ³•ï¼‰"></a><strong>protected T initialValue()</strong>ï¼ˆå¦‚æœä¸æƒ³åˆå§‹å€¼è¿”å›nullï¼Œéœ€è¦é‡å†™initialValueæ–¹æ³•ï¼‰</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> T <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1foyhxjqs0qj31kw0zyn9s.jpg" alt="å¦‚æœä¸æƒ³åˆå§‹å€¼è¿”å›nullï¼Œéœ€è¦é‡å†™initialValueæ–¹æ³•"></p><h5 id="public-T-get-ï¼ˆè¯¥æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹å˜é‡å‰¯æœ¬ã€‚å¦‚æœè¿™æ˜¯çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™åˆ›å»ºå¹¶åˆå§‹åŒ–æ­¤å‰¯æœ¬ã€‚ï¼‰"><a href="#public-T-get-ï¼ˆè¯¥æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹å˜é‡å‰¯æœ¬ã€‚å¦‚æœè¿™æ˜¯çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™åˆ›å»ºå¹¶åˆå§‹åŒ–æ­¤å‰¯æœ¬ã€‚ï¼‰" class="headerlink" title="public T get()ï¼ˆè¯¥æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹å˜é‡å‰¯æœ¬ã€‚å¦‚æœè¿™æ˜¯çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™åˆ›å»ºå¹¶åˆå§‹åŒ–æ­¤å‰¯æœ¬ã€‚ï¼‰"></a><strong>public T get()</strong>ï¼ˆè¯¥æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹å˜é‡å‰¯æœ¬ã€‚å¦‚æœè¿™æ˜¯çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™åˆ›å»ºå¹¶åˆå§‹åŒ–æ­¤å‰¯æœ¬ã€‚ï¼‰</h5><p>/**</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> * Returns the value in the current thread's copy of this</div><div class="line"> * thread-local variable.  If the variable has no value for the</div><div class="line"> * current thread, it is first initialized to the value returned</div><div class="line"> * by an invocation of the &#123;@link #initialValue&#125; method.</div><div class="line"> *</div><div class="line"> * @return the current thread's value of this thread-local</div><div class="line"> */</div><div class="line">public T get() &#123;</div><div class="line">    Thread t = Thread.currentThread();</div><div class="line">    ThreadLocalMap map = getMap(t);</div><div class="line">    if (map != null) &#123;</div><div class="line">        ThreadLocalMap.Entry e = map.getEntry(this);</div><div class="line">        if (e != null)</div><div class="line">            return (T)e.value;</div><div class="line">    &#125;</div><div class="line">    return setInitialValue();</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="public-void-set-T-value"><a href="#public-void-set-T-value" class="headerlink" title="public void set(T value)"></a><strong>public void set(T value)</strong></h5><p>/**</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"> * Sets the current thread's copy of this thread-local variable</div><div class="line"> * to the specified value.  Most subclasses will have no need to</div><div class="line"> * override this method, relying solely on the &#123;@link #initialValue&#125;</div><div class="line"> * method to set the values of thread-locals.</div><div class="line"> *</div><div class="line"> * @param value the value to be stored in the current thread's copy of</div><div class="line"> *        this thread-local.</div><div class="line"> */</div><div class="line">public void set(T value) &#123;</div><div class="line">    Thread t = Thread.currentThread();</div><div class="line">    ThreadLocalMap map = getMap(t);</div><div class="line">    if (map != null)</div><div class="line">        map.set(this, value);</div><div class="line">    else</div><div class="line">        createMap(t, value);</div><div class="line">&#125;</div></pre></td></tr></table></figure><ol><li>ç”±getå’Œsetæºç å¯ä»¥çœ‹å‡ºï¼Œæ•°æ®çš„å­˜å–éƒ½æ˜¯å…ˆè·å–ThreadLocalMapå¯¹è±¡ï¼Œä»<strong>ThreadLocalMap</strong>å­˜å–</li><li>ThreadLocalMapæ˜¯ä¸€ä¸ªmapï¼Œå®ƒçš„keyï¼Œå°±æ˜¯threadLocalæœ¬èº«ï¼Œå€¼å°±æ˜¯å­˜æ”¾çš„å˜é‡å‰¯æœ¬</li><li><strong>æ¯ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªæœ¬åœ°å˜é‡çš„mapï¼Œæ¯ä¸ªå¯ä»¥å­˜æ”¾å¤šä¸ªçº¿ç¨‹æœ¬åœ°å˜é‡ï¼ˆå³ä¸åŒçš„ThreadLocalï¼‰</strong></li></ol><h5 id="public-void-remove-ï¼ˆjdk1-5åå‡ºç°ï¼‰"><a href="#public-void-remove-ï¼ˆjdk1-5åå‡ºç°ï¼‰" class="headerlink" title="public void remove()ï¼ˆjdk1.5åå‡ºç°ï¼‰"></a><strong>public void remove()</strong>ï¼ˆjdk1.5åå‡ºç°ï¼‰</h5><p>/**</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">* Removes the current thread's value for this thread-local</div><div class="line">* variable.  If this thread-local variable is subsequently</div><div class="line">* &#123;@linkplain #get read&#125; by the current thread, its value will be</div><div class="line">* reinitialized by invoking its &#123;@link #initialValue&#125; method,</div><div class="line">* unless its value is &#123;@linkplain #set set&#125; by the current thread</div><div class="line">* in the interim.  This may result in multiple invocations of the</div><div class="line">* &lt;tt&gt;initialValue&lt;/tt&gt; method in the current thread.</div><div class="line">*</div><div class="line">* @since 1.5</div><div class="line">*/</div><div class="line">public void remove() &#123;</div><div class="line">    ThreadLocalMap m = getMap(Thread.currentThread());</div><div class="line">    if (m != null)</div><div class="line">        m.remove(this);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>é€šè¿‡removeæºç å¯ä»¥çœ‹åˆ°ï¼Œ</p><ol><li>å…ˆé€šè¿‡ThreadLocalçš„getMapï¼ˆThread.currentThread()ï¼‰æ–¹æ³•æ‹¿åˆ°å½“å‰çº¿ç¨‹çš„ThreadLocalMap</li><li>ç„¶åå†åœ¨å½“å‰çº¿ç¨‹çš„ThreadLocalMapä¸­getï¼Œsetï¼Œremove</li></ol><p>å…³äºremoveéœ€è¦çŸ¥é“çš„å‡ ç‚¹ï¼š</p><ul><li>ä¸ºä»€ä¹ˆç§»é™¤æŸä¸ªThreadLocalçš„å€¼ï¼š</li></ul><p>ç›®çš„æ˜¯å‡å°‘å†…å­˜ç¼“å­˜ï¼Œremoveä¹‹åå¦‚æœå†æ¬¡è®¿é—®æ­¤çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼ï¼Œå°†è¿”å›initiValueåˆå§‹å€¼</p><p>çº¿ç¨‹ç»“æŸåï¼Œè¯¥çº¿ç¨‹å¯¹åº”çš„æ‰€æœ‰å±€éƒ¨å˜é‡å°†è‡ªåŠ¨è¢«åƒåœ¾å›æ”¶ï¼Œä½†æ˜¯æ˜¾ç¤ºè°ƒç”¨removeæ¸…æ¥šçº¿ç¨‹å±€éƒ¨å˜é‡ä¸æ˜¯å¿…é¡»æ“ä½œï¼Œä½†æ˜¯å¯ä»¥åŠ å¿«å†…å­˜å›æ”¶çš„é€Ÿåº¦</p><h3 id="ThreadLocalå’ŒåŒæ­¥æœºåˆ¶synchonziedçš„åŒºåˆ«"><a href="#ThreadLocalå’ŒåŒæ­¥æœºåˆ¶synchonziedçš„åŒºåˆ«" class="headerlink" title="ThreadLocalå’ŒåŒæ­¥æœºåˆ¶synchonziedçš„åŒºåˆ«"></a>ThreadLocalå’ŒåŒæ­¥æœºåˆ¶synchonziedçš„åŒºåˆ«</h3><ul><li>ThreadLocalï¼šä»¥ç©ºé—´æ¢æ—¶é—´</li><li>synchonziedï¼šä»¥æ—¶é—´æ¢ç©ºé—´</li></ul><p>synchonziedåŒæ­¥æœºåˆ¶ï¼š</p><p>ä¸ºå¤šçº¿ç¨‹å¯¹ç›¸åŒèµ„æºçš„å¹¶å‘è®¿é—®æ§åˆ¶ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¹‹é—´çš„æ•°æ®å…±äº«ï¼Œ<strong>åŒæ­¥ä¼šå¸¦æ¥å·¨å¤§çš„æ€§èƒ½å¼€é”€ï¼Œæ‰€ä»¥åŒæ­¥æ“ä½œåº”è¯¥æ˜¯ç»†ç²’åº¦çš„ï¼ˆå¯¹è±¡ä¸­çš„ä¸åŒå…ƒç´ ä½¿ç”¨ä¸åŒçš„é”ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå¯¹è±¡ä¸€ä¸ªé”ï¼‰</strong>ï¼Œä»¥æ—¶é—´æ¢ç©ºé—´çš„æ„æ€æ˜¯ï¼š<strong>ä½¿ç”¨åŒæ­¥çœŸæ­£çš„é£é™©æ˜¯å¤æ‚æ€§å’Œå¯èƒ½ç ´åèµ„æºå®‰å…¨,è€Œä¸æ˜¯æ€§èƒ½ã€‚</strong></p><p>ThreadLocalçº¿ç¨‹å±€éƒ¨å˜é‡æœºåˆ¶ï¼š</p><p>ç©ºé—´æ¢å–æ—¶é—´ï¼Œä¸åŒçº¿ç¨‹è®¿é—®åŒä¸€ThreadLocalï¼Œæ•°æ®çš„å­˜å–æ˜¯å½“å‰çº¿ç¨‹çš„æ•°æ®å‰¯æœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒçº¿ç¨‹åœ¨æŸä¸€æ—¶é—´è®¿é—®åˆ°çš„å¹¶ä¸æ˜¯åŒä¸€å¯¹è±¡ï¼Œæ‰€ä»¥æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å ç”¨å†…å­˜æ¯”è¾ƒå¤§ï¼Œå½“çº¿ç¨‹ç»“æŸä¹‹åï¼Œremoveä¼šåŠ å¿«å†…å­˜çš„å›æ”¶é€Ÿåº¦ã€‚</p><p>Synchronizedç€é‡äºçº¿ç¨‹é—´çš„æ•°æ®å…±äº«ï¼Œè€ŒThreadLocalåˆ™ç€é‡äºçº¿ç¨‹é—´çš„æ•°æ®éš”ç¦»ã€‚ </p><h3 id="ThreadLocalçš„å¼Šç«¯ï¼ˆå†…å­˜æ³„éœ²ï¼‰"><a href="#ThreadLocalçš„å¼Šç«¯ï¼ˆå†…å­˜æ³„éœ²ï¼‰" class="headerlink" title="ThreadLocalçš„å¼Šç«¯ï¼ˆå†…å­˜æ³„éœ²ï¼‰"></a>ThreadLocalçš„å¼Šç«¯ï¼ˆå†…å­˜æ³„éœ²ï¼‰</h3><h4 id="å†…å­˜æ³„éœ²åŸå› "><a href="#å†…å­˜æ³„éœ²åŸå› " class="headerlink" title="å†…å­˜æ³„éœ²åŸå› "></a>å†…å­˜æ³„éœ²åŸå› </h4><p>ThreadLocalMapä½¿ç”¨ThreadLocalçš„å¼±å¼•ç”¨ä½œä¸ºkeyï¼Œå¦‚æœä¸€ä¸ªThreadLocalæ²¡æœ‰å¤–éƒ¨çš„å¼ºå¼•ç”¨ï¼Œé‚£ä¹ˆåœ¨ç³»ç»ŸGCçš„æ—¶å€™ï¼Œè¿™ä¸ªThreadLocalå°±ä¼šè¢«å›æ”¶æ‰</p><p>ThreadLocalè¢«å›æ”¶æ‰ä¹‹åï¼Œé‚£ä¹ˆå½“å‰Threadçš„ThreadLocalMapä¸­é—´å°±ä¼šå‡ºç°keyä¸ºnullçš„Entry</p><p>keyä¸ºnullçš„è¯å°±æ„å‘³ç€ï¼Œæ²¡æœ‰åŠæ³•è®¿é—®è¿™äº›keyå¯¹åº”çš„å€¼ï¼Œå°±ä¼šå­˜åœ¨ä»¥ä¸‹çš„è¿™æ ·ä¸€ä¸ªå¼ºå¼•ç”¨é“¾</p><p>value â€”Entryâ€”TreadLocalMapâ€“Thread</p><h4 id="å†…å­˜æ³„éœ²è§£å†³"><a href="#å†…å­˜æ³„éœ²è§£å†³" class="headerlink" title="å†…å­˜æ³„éœ²è§£å†³"></a>å†…å­˜æ³„éœ²è§£å†³</h4><p><code>ThreadLocalMap</code>çš„è®¾è®¡ä¸­å·²ç»è€ƒè™‘åˆ°è¿™ç§æƒ…å†µï¼Œä¹ŸåŠ ä¸Šäº†ä¸€äº›é˜²æŠ¤æªæ–½ï¼šåœ¨<code>ThreadLocal</code>çš„<code>get()</code>,<code>set()</code>,<code>remove()</code>çš„æ—¶å€™éƒ½ä¼šæ¸…é™¤çº¿ç¨‹<code>ThreadLocalMap</code>é‡Œæ‰€æœ‰<code>key</code>ä¸º<code>null</code>çš„<code>value</code>ã€‚</p><h4 id="ä»¥ä¸‹æ“ä½œä¼šå¯¼è‡´å†…å­˜æ³„éœ²"><a href="#ä»¥ä¸‹æ“ä½œä¼šå¯¼è‡´å†…å­˜æ³„éœ²" class="headerlink" title="ä»¥ä¸‹æ“ä½œä¼šå¯¼è‡´å†…å­˜æ³„éœ²"></a>ä»¥ä¸‹æ“ä½œä¼šå¯¼è‡´å†…å­˜æ³„éœ²</h4><ol><li><p>ä½¿ç”¨staticçš„ThreadLocalï¼Œå»¶é•¿äº†<code>ThreadLocal</code>çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯¼è‡´æŸä¸ªçº¿ç¨‹Threadç»“æŸåï¼Œä½†æ˜¯Threadå†…éƒ¨çš„ThreadLocalMapä¸­å­˜åœ¨è¿™ä¸ªé™æ€çš„ThreadLocalï¼Œå¯¼è‡´ThreadLocalMapæ²¡æ³•è¢«å›æ”¶ï¼Œå¯¼è‡´è¯¥Threadæ²¡æ³•è¢«å›æ”¶</p></li><li><p>åˆ†é…ä½¿ç”¨äº†<code>ThreadLocal</code>åˆä¸å†è°ƒç”¨<code>get()</code>,<code>set()</code>,<code>remove()</code>æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚å› ä¸ºå¦‚ä¸Šæ‰€è¯´</p><p><code>get()</code>,<code>set()</code>,<code>remove()</code>ä¼šæ¸…ç†çº¿ç¨‹ThreadLocalMapé‡Œæ‰€æœ‰keyä¸ºnullçš„value</p></li></ol><h3 id="Androidä¸­ThreadLocalçš„ä½“ç°"><a href="#Androidä¸­ThreadLocalçš„ä½“ç°" class="headerlink" title="Androidä¸­ThreadLocalçš„ä½“ç°"></a>Androidä¸­ThreadLocalçš„ä½“ç°</h3><h4 id="Handleræ¶ˆæ¯æœºåˆ¶"><a href="#Handleræ¶ˆæ¯æœºåˆ¶" class="headerlink" title="Handleræ¶ˆæ¯æœºåˆ¶"></a>Handleræ¶ˆæ¯æœºåˆ¶</h4><p>ç†Ÿæ‚‰Handleræœºåˆ¶çš„éƒ½çŸ¥é“</p><p>åœ¨ActivityThreadçš„mainæ–¹æ³•ä¸­Looper.prepareMainLooper();æˆ–è€…åœ¨è‡ªå·±åˆ›å»ºçš„çº¿ç¨‹ä¸­Looper.pepare()çš„æ—¶å€™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">(<span class="keyword">boolean</span> quitAllowed)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (sThreadLocal.get() != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Only one Looper may be created per thread"</span>);</div><div class="line">    &#125;</div><div class="line">    sThreadLocal.set(<span class="keyword">new</span> Looper(quitAllowed));</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åˆ›å»ºäº†ä¸€ä¸ªLooperå¯¹è±¡å¹¶ä½¿ç”¨sThreadLocalçš„setæ–¹æ³•è¿›è¡Œä¿å­˜</p><p>å¹¶ä¸”è¿™ä¸ªThreadLocalåœ¨Looperç±»ä¸­æ˜¯é™æ€çš„ï¼Œå¦‚ä¸‹</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1foylpjjmbuj31jg0w6k0i.jpg" alt=""></p><p>é‚£å°±æ˜¯è¯´ï¼Œè¿™ä¸ªé™æ€çš„ThreadLocalï¼Œå¯ä»¥ä¾›ä»»ä½•çº¿ç¨‹è®¿é—®ï¼Œä½†æ˜¯ä»»æ„çº¿ç¨‹ä¸­å–å‡ºæ¥çš„looperï¼Œéƒ½åªæ˜¯çº¿ç¨‹å±€éƒ¨å˜é‡ï¼Œéƒ½æ˜¯åœ¨å‰¯æœ¬</p><p>æ‰€ä»¥è¯´ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªlooperï¼Œ</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1foylttuf5dj31i40ectj5.jpg" alt=""></p><p><strong>å¯¹äºThreadLocalçš„æ€»ç»“ï¼Œæš‚æ—¶æ•´ç†åˆ°è¿™é‡Œï¼Œåç»­è¡¥å…… â™¨</strong></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>3.Xçš„gradleä¾èµ–implementation</title>
      <link href="/2018/01/24/3-x%E7%9A%84gradle%E4%BE%9D%E8%B5%96implementation/"/>
      <content type="html"><![CDATA[<p>ä¾èµ–æ–¹å¼æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬è¿™é‡Œåªå¼„æ¸…æ¥šimplementationå’ŒCompileçš„åŒºåˆ«ï¼Œå°±å¥½äº†</p><a id="more"></a><h3 id="implementationå’ŒCompileçš„åŒºåˆ«"><a href="#implementationå’ŒCompileçš„åŒºåˆ«" class="headerlink" title="implementationå’ŒCompileçš„åŒºåˆ«"></a>implementationå’ŒCompileçš„åŒºåˆ«</h3><p>å…ˆçœ‹ä¸‹å›¾</p><p><img src="https://upload-images.jianshu.io/upload_images/2139461-fdab3438f31ddfe5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/361" alt="ä¾èµ–åŒºåˆ«"></p><p>å‡è®¾ï¼š</p><p><strong>LibraryAâ€”â€“â€”â€“implementationâ€”â€”â€”LibraryC</strong></p><p>App Module æ— æ³•ä½¿ç”¨LibraryC</p><p><strong>LibraryBâ€”â€“â€”â€“compileâ€”â€”â€”LibraryD</strong></p><p>App Module å¯ä»¥ä½¿ç”¨LibraryD</p><h3 id="å¥½å¤„"><a href="#å¥½å¤„" class="headerlink" title="å¥½å¤„"></a>å¥½å¤„</h3><ul><li>å¯ä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦</li><li>éšè—å¯¹å¤–ä¸å¿…è¦çš„æ¥å£</li></ul><p>ä¸ºä»€ä¹ˆèƒ½å¤ŸåŠ å¿«ç¼–è¯‘é€Ÿåº¦å‘¢</p><p>è¿™å¯¹äºå¤§å‹é¡¹ç›®å«æœ‰å¤šä¸ª<code>Moudle</code>æ¨¡å—çš„ï¼Œ ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œæ¯”å¦‚æˆ‘ä»¬æ”¹åŠ¨ <code>LibraryC</code> æ¥å£çš„ç›¸å…³ä»£ç ï¼Œè¿™æ—¶å€™ç¼–è¯‘åªéœ€è¦å•ç‹¬ç¼–è¯‘<code>LibraryA</code>æ¨¡å—å°±è¡Œï¼Œ å¦‚æœä½¿ç”¨çš„æ˜¯<code>api</code>æˆ–è€…æ—§æ—¶ä»£çš„<code>compile</code>ï¼Œç”±äº<code>App Moudle</code> ä¹Ÿå¯ä»¥è®¿é—®åˆ° <code>LibraryC</code>,æ‰€ä»¥ <code>App Moudle</code>éƒ¨åˆ†ä¹Ÿéœ€è¦é‡æ–°ç¼–è¯‘ã€‚</p><h3 id="å…¶ä»–å‡ ç§æ–¹å¼"><a href="#å…¶ä»–å‡ ç§æ–¹å¼" class="headerlink" title="å…¶ä»–å‡ ç§æ–¹å¼"></a>å…¶ä»–å‡ ç§æ–¹å¼</h3><p><strong>é¦–å…ˆæ˜¯2.xç‰ˆæœ¬çš„ä¾èµ–æ–¹å¼ï¼š</strong></p><ol><li>Compile</li><li>Provided</li><li>APK</li><li>Test compile</li><li>Debug compile</li><li>Release compile</li></ol><p><strong>å†æ¥çœ‹çœ‹3.0çš„</strong></p><ol><li>Implementation</li><li>API</li><li>Compile only</li><li>Runtime only</li><li>Unit Test implementation</li><li>Test implementation</li><li>Debug implementation</li><li>Release implementation</li></ol><p><strong>2.xç‰ˆæœ¬ä¾èµ–çš„å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„è¯´æ˜ï¼Œæ‹¬å·é‡Œå¯¹åº”çš„æ˜¯3.0ç‰ˆæœ¬çš„ä¾èµ–æ–¹å¼ã€‚</strong></p><h4 id="compileï¼ˆapiï¼‰"><a href="#compileï¼ˆapiï¼‰" class="headerlink" title="compileï¼ˆapiï¼‰"></a>compileï¼ˆapiï¼‰</h4><p>è¿™ç§æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œä½¿ç”¨è¯¥æ–¹å¼ä¾èµ–çš„åº“å°†ä¼š<strong>å‚ä¸ç¼–è¯‘å’Œæ‰“åŒ…</strong>ã€‚<br>å½“æˆ‘ä»¬ä¾èµ–ä¸€äº›ç¬¬ä¸‰æ–¹çš„åº“æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°com.android.supportå†²çªçš„é—®é¢˜ï¼Œå°±æ˜¯å› ä¸ºå¼€å‘è€…ä½¿ç”¨çš„compileä¾èµ–çš„com.android.supportåŒ…ï¼Œè€Œä»–æ‰€ä¾èµ–çš„åŒ…ä¸æˆ‘ä»¬æœ¬åœ°æ‰€ä¾èµ–çš„com.android.supportåŒ…ç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥All com.android.support libraries must use the exact same version specification (mixing versions can lead to runtime crashesè¿™ä¸ªé”™è¯¯ã€‚</p><p><a href="https://blog.csdn.net/yuzhiqiang_1993/article/details/78214812" target="_blank" rel="external">supportåŒ…å†²çª</a></p><h4 id="providedï¼ˆcompileOnlyï¼‰"><a href="#providedï¼ˆcompileOnlyï¼‰" class="headerlink" title="providedï¼ˆcompileOnlyï¼‰"></a>providedï¼ˆcompileOnlyï¼‰</h4><p><strong>åªåœ¨ç¼–è¯‘æ—¶æœ‰æ•ˆï¼Œä¸ä¼šå‚ä¸æ‰“åŒ…</strong><br>å¯ä»¥åœ¨è‡ªå·±çš„moudleä¸­ä½¿ç”¨è¯¥æ–¹å¼ä¾èµ–ä¸€äº›æ¯”å¦‚com.android.supportï¼Œgsonè¿™äº›ä½¿ç”¨è€…å¸¸ç”¨çš„åº“ï¼Œé¿å…å†²çªã€‚</p><h4 id="apkï¼ˆruntimeOnlyï¼‰"><a href="#apkï¼ˆruntimeOnlyï¼‰" class="headerlink" title="apkï¼ˆruntimeOnlyï¼‰"></a>apkï¼ˆruntimeOnlyï¼‰</h4><p>åªåœ¨ç”Ÿæˆapkçš„æ—¶å€™å‚ä¸æ‰“åŒ…ï¼Œç¼–è¯‘æ—¶ä¸ä¼šå‚ä¸ï¼Œå¾ˆå°‘ç”¨ã€‚</p><h4 id="testCompileï¼ˆtestImplementationï¼‰"><a href="#testCompileï¼ˆtestImplementationï¼‰" class="headerlink" title="testCompileï¼ˆtestImplementationï¼‰"></a>testCompileï¼ˆtestImplementationï¼‰</h4><p>testCompile åªåœ¨å•å…ƒæµ‹è¯•ä»£ç çš„ç¼–è¯‘ä»¥åŠæœ€ç»ˆæ‰“åŒ…æµ‹è¯•apkæ—¶æœ‰æ•ˆã€‚</p><h4 id="debugCompileï¼ˆdebugImplementationï¼‰"><a href="#debugCompileï¼ˆdebugImplementationï¼‰" class="headerlink" title="debugCompileï¼ˆdebugImplementationï¼‰"></a>debugCompileï¼ˆdebugImplementationï¼‰</h4><p>debugCompile åªåœ¨debugæ¨¡å¼çš„ç¼–è¯‘å’Œæœ€ç»ˆçš„debug apkæ‰“åŒ…æ—¶æœ‰æ•ˆ</p><h4 id="releaseCompileï¼ˆreleaseImplementationï¼‰"><a href="#releaseCompileï¼ˆreleaseImplementationï¼‰" class="headerlink" title="releaseCompileï¼ˆreleaseImplementationï¼‰"></a>releaseCompileï¼ˆreleaseImplementationï¼‰</h4><p>Release compile ä»…ä»…é’ˆå¯¹Release æ¨¡å¼çš„ç¼–è¯‘å’Œæœ€ç»ˆçš„Release apkæ‰“åŒ…ã€‚</p><p><strong>å‚è€ƒï¼š</strong></p><p><a href="https://blog.csdn.net/yuzhiqiang_1993/article/details/78366985?locationNum=6&amp;fps=1" target="_blank" rel="external">Android Studio3.xæ–°çš„ä¾èµ–æ–¹å¼ï¼ˆimplementationã€apiã€compileOnlyï¼‰</a></p><p>### </p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è°ˆè°ˆå¯åŠ¨æµç¨‹</title>
      <link href="/2017/12/29/%E8%B0%88%E8%B0%88%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/"/>
      <content type="html"><![CDATA[]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ReactNativeå­¦ä¹ ä¸€</title>
      <link href="/2017/12/25/ReactNative%20start/"/>
      <content type="html"><![CDATA[<p>ReactNative å­¦ä¹ ä¸€</p><a id="more"></a><h2 id="1ï¼Œä¸ºä»€ä¹ˆå­¦ä¹ ReactNative"><a href="#1ï¼Œä¸ºä»€ä¹ˆå­¦ä¹ ReactNative" class="headerlink" title="1ï¼Œä¸ºä»€ä¹ˆå­¦ä¹ ReactNative"></a>1ï¼Œä¸ºä»€ä¹ˆå­¦ä¹ ReactNative</h2><h3 id="å¥½å¤„"><a href="#å¥½å¤„" class="headerlink" title="å¥½å¤„"></a>å¥½å¤„</h3><ul><li>å› ä¸ºç°åœ¨è®¸å¤šä¸»æµçš„åº”ç”¨éƒ½æœ‰React Nativeçš„å½±å­ï¼Œå®ƒå¯¹æ¯”åŸç”Ÿå¼€å‘æ›´ä¸ºçµæ´»ï¼Œå¯¹æ¯”H5ä½“éªŒæ›´ä¸ºé«˜æ•ˆï¼Œè€Œä¸”è·¨å¹³å°çš„æ”¯æŒç‰¹æ€§ã€‚</li></ul><ul><li>ç›¸å¯¹ionicè¿™ç±»PhoneGapï¼Œå®ƒæ•ˆç‡æ›´é«˜ï¼Œå’ŒåŸç”Ÿä¹‹é—´çš„äº¤äº’æ›´æ–¹ä¾¿ã€‚</li></ul><ul><li>å¤šä¸ªç‰ˆæœ¬è¿­ä»£åçš„ä»Šå¤©ï¼Œå®ƒå·²ç»æ‹¥æœ‰äº†ä¸°å¯Œç¬¬ä¸‰æ–¹æ’ä»¶æ”¯æŒã€‚</li></ul><ul><li>React Nativeè§£å†³ä¸äº†çš„ï¼Œå¯ä»¥é€šè¿‡å„ä½ç†Ÿæ‚‰çš„åŸç”Ÿæ¥è§£å†³ã€‚</li></ul><ul><li>æ›´æ–¹ä¾¿çš„çƒ­æ›´æ–°ã€‚</li></ul><h3 id="åå¤„"><a href="#åå¤„" class="headerlink" title="åå¤„"></a>åå¤„</h3><ul><li>å°½ç®¡æ˜¯è·¨å¹³å°ï¼Œä½†æ˜¯ä¸åŒå¹³å°Apiçš„ç‰¹æ€§ä¸æ˜¾ç¤ºå¹¶ä¸ä¸€å®šä¸€è‡´ã€‚</li><li>ç›¸å¯¹å¢å¤§äº†appçš„ä½“ç§¯ã€‚</li><li>è°ƒè¯•â€™ç›¸å¯¹â€˜éº»çƒ¦ã€‚</li><li>Androidä¸Šçš„å…¼å®¹æ€§é—®é¢˜ã€‚</li></ul><h3 id="æ€»çš„æ¥è¯´"><a href="#æ€»çš„æ¥è¯´" class="headerlink" title="æ€»çš„æ¥è¯´"></a>æ€»çš„æ¥è¯´</h3><p>React Nativeé€‚åˆä½œä¸ºé¡¹ç›®ä¸­çš„è¡¥å……ï¼Œè€Œä¸æ˜¯ä½œä¸ºæ ¸å¿ƒå»å¼€å‘APPã€‚</p><h2 id="2ï¼Œæ­å»ºå¼€å‘ç¯å¢ƒ"><a href="#2ï¼Œæ­å»ºå¼€å‘ç¯å¢ƒ" class="headerlink" title="2ï¼Œæ­å»ºå¼€å‘ç¯å¢ƒ"></a>2ï¼Œæ­å»ºå¼€å‘ç¯å¢ƒ</h2><ul><li><p>Webstromï¼ˆå·ç§°webå¼€å‘ç¥å™¨ï¼Œç›®å‰å¯¹å‰ç«¯çš„äº†è§£æœ‰é™ï¼Œå› ä¸ºå’Œandroid stuidoå¸ˆå‡ºåŒé—¨ï¼Œæ‰€ä»¥ä¸å•†é‡ç›´æ¥é€‰ç”¨ä»–ï¼Œå½“ç„¶stomä¹Ÿè¯•äº†è¯•ï¼Œä½†æ˜¯å¿«æ·é”®ä¸å¦‚Webstromç†Ÿæ‚‰ï¼‰</p></li><li><p>HomeBrewï¼ˆMacç³»ç»Ÿçš„åŒ…ç®¡ç†å™¨ï¼Œç”¨äºå®‰è£…NodeJSå’Œä¸€äº›å…¶ä»–å¿…éœ€çš„å·¥å…·è½¯ä»¶</p></li><li><p>Nodeï¼ˆåŸºäº Chrome V8 å¼•æ“çš„ JavaScript è¿è¡Œç¯å¢ƒï¼‰</p></li><li><p>Androd Studioï¼ˆå®‰å“è€æœ¬å®¶æ²¡å•¥è¯´çš„ï¼‰</p></li><li><p>ReactNativeçš„å‘½ä»¤è¡Œå·¥å…·ï¼ˆreact-native-cliï¼ŒReact Nativeçš„å‘½ä»¤è¡Œå·¥å…·ç”¨äºæ‰§è¡Œåˆ›å»ºã€åˆå§‹åŒ–ã€æ›´æ–°é¡¹ç›®ã€è¿è¡Œæ‰“åŒ…æœåŠ¡ï¼ˆpackagerï¼‰ç­‰ä»»åŠ¡</p><p><a href="https://reactnative.cn/docs/0.31/getting-started.html#content" target="_blank" rel="external">è¯¦ç»†æ­å»ºæ­¥éª¤æŸ¥çœ‹ReactNativeä¸­æ–‡ç½‘</a></p></li></ul><p>ä¸€æ­¥ä¸€æ­¥å®‰è£…å®Œæ¯•åï¼Œæ²¡é”™ï¼Œä½ å·²ç»èµ·é£äº†ï¼›</p><h2 id="3ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®"><a href="#3ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®" class="headerlink" title="3ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®"></a>3ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®</h2><ul><li><p>ç»ˆç«¯cdåˆ°ä½ æƒ³åˆå§‹åŒ–é¡¹ç›®çš„æ–‡ä»¶å¤¹</p></li><li><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-<span class="keyword">native</span> init FirstRNApp</div></pre></td></tr></table></figure></li><li><p>ç„¶åä¼šå‘ç°åˆ›å»ºäº†ä¸€ä¸ªFirstRNAppæ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯åˆ›å»ºçš„ç¬¬ä¸€ä¸ªé¡¹ç›®</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3673902-0affa2b6b71fc650.jpeg?imageMogr2/auto-orient/" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1foabtgnbqjj30bc0k20ua.jpg" alt="é¡¹ç›®ç›®å½•"></p><h2 id="å‡ ä¸ªå…³é”®çš„æ–‡ä»¶"><a href="#å‡ ä¸ªå…³é”®çš„æ–‡ä»¶" class="headerlink" title="å‡ ä¸ªå…³é”®çš„æ–‡ä»¶"></a>å‡ ä¸ªå…³é”®çš„æ–‡ä»¶</h2><ul><li><strong>android</strong>æ–‡ä»¶å¤¹ï¼Œå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨android studioæ‰“å¼€çš„androidé¡¹ç›®ã€‚</li><li><strong>ios</strong>æ–‡ä»¶å¤¹ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨xcodeæ‰“å¼€çš„iosé¡¹ç›®ã€‚</li><li><strong>index.android.js</strong>ï¼Œè¿™æ˜¯androidçš„React Nativeå…¥å£æ–‡ä»¶ã€‚</li><li><strong>index.ios.js</strong>ï¼Œè¿™æ˜¯iosçš„React Nativeå…¥å£æ–‡ä»¶ã€‚</li><li><strong>package.json</strong>ï¼Œç±»ä¼¼android studioçš„build.gradleï¼Œä½ ä¾èµ–çš„åº“éƒ½å†™åœ¨é‡Œé¢ã€‚</li><li><strong>node_module</strong>æ–‡ä»¶å¤¹ï¼Œä½ ä¾èµ–çš„åº“ä¸‹è½½ä¸‹æ¥éƒ½å­˜æ”¾åœ¨é‡Œé¢ï¼Œå±äºgitçš„å¿½ç•¥æ–‡ä»¶ï¼Œä½ è¦æ‰¾çš„ä¾èµ–åº“æºç ä¹Ÿåœ¨é‡Œé¢ï¼ŒåŒ…æ‹¬Reactå’ŒReact Nativeã€‚</li><li><strong>jscode</strong>æ–‡ä»¶å¤¹ï¼Œæ˜¯è‡ªå·±åˆ›å»ºçš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾è‡ªå·±å†™çš„jsæ–‡ä»¶ã€‚</li></ul><h3 id="éœ€è¦æ³¨æ„çš„ç‚¹"><a href="#éœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„ç‚¹"></a>éœ€è¦æ³¨æ„çš„ç‚¹</h3><p><strong>package.json</strong></p><p>ç±»ä¼¼äºandroid studioä¸­çš„build.gradleæ·»åŠ è¿œç¨‹ä¾èµ–ï¼Œä¸åŒçš„æ˜¯ï¼Œpackage.jsonå¤§å¤šæ•°æ—¶å€™ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ ¹ç›®å½•é€šè¿‡å‘½ä»¤è¡Œï¼Œ<code>npm install xxxxxx --save</code> å°±å¯ä»¥ä¾èµ–ä¸€ä¸ªåº“äº†ã€‚</p><p><strong>install</strong>ä¹‹åï¼Œåº“çš„ä¾èµ–ä¿¡æ¯ï¼Œè‡ªåŠ¨è¢«å†™åˆ°package.jsoné‡Œé¢ï¼Œå¯¹åº”çš„åº“ä¹Ÿä¼šè¢«ä¸‹è½½åˆ°node_moduleæ–‡ä»¶å¤¹ä¸­ï¼Œç±»ä¼¼android studioä¾èµ–åæŠŠaaråŒæ­¥åˆ°æœ¬åœ°ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1foabyhxltmj30xe0m6n04.jpg" alt="package.json"></p><hr><p><strong>node_module</strong></p><p><strong>node_module</strong>æ˜¯ä¸€ä¸ªå¿½ç•¥æ–‡ä»¶ï¼Œæäº¤çš„æ—¶å€™ä¸éœ€è¦æäº¤åˆ°gitä¸Šï¼Œç±»ä¼¼android studioè¿œç¨‹ä¾èµ–ä¸‹æ¥çš„aarï¼Œä¹Ÿä¸ä¼šæäº¤åˆ°gitä¸Šã€‚å…¶ä»–äººåœ¨ä½¿ç”¨React Nativeé¡¹ç›®æ—¶ï¼Œåªéœ€è¦npm installï¼Œå·¥ç¨‹å°±ä¼šæ ¹æ®package.jsonï¼Œå»åŒæ­¥ä¸‹è½½å„ä¸ªä¾èµ–åº“åˆ°node_moduleã€‚</p><p><strong>æ³¨</strong>ï¼šæœ‰æ—¶å€™è¿˜éœ€è¦è¿è¡Œ<code>react-native link</code> æˆ– <code>react-native link xxx</code>ï¼Œè¿™æ˜¯å› ä¸ºæœ‰äº›ç¬¬ä¸‰æ–¹åº“æ˜¯é€šè¿‡åŸç”Ÿä»£ç åŠ React Nativeå®ç°çš„ï¼Œé€šè¿‡è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥è‡ªåŠ¨æŠŠç›¸å…³çš„é…ç½®ä»£ç ï¼Œè‡ªåŠ¨æ·»åŠ åˆ°androidå’Œioså·¥ç¨‹ä¸­ã€‚</p><hr><h2 id="è¿è¡Œè¿™ä¸ªé¡¹ç›®"><a href="#è¿è¡Œè¿™ä¸ªé¡¹ç›®" class="headerlink" title="è¿è¡Œè¿™ä¸ªé¡¹ç›®"></a>è¿è¡Œè¿™ä¸ªé¡¹ç›®</h2><p>ä½œä¸ºå®‰å“ç«¯æœ‰ä¸¤ç§æ–¹å¼ï¼Œiosä¹ŸåŒæ ·æœ‰ä¸¤ç§</p><ul><li><p>cdåˆ°é¡¹ç›®æ ¹ç›®å½•</p></li><li><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-<span class="keyword">native</span> run-androidã€react-<span class="keyword">native</span> run-iosã€‘</div></pre></td></tr></table></figure></li><li><p>æˆ–è€…ç”¨android stuidoç›´æ¥æ‰“å¼€é¡¹ç›®ä¸­çš„androidæ–‡ä»¶å¤¹ï¼ˆä¸Šé¢æœ‰è¯´è¿‡ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹æ‰“å¼€çš„å®‰å“é¡¹ç›®ï¼‰</p></li></ul><h3 id="é‡åˆ°çš„å°å‘"><a href="#é‡åˆ°çš„å°å‘" class="headerlink" title="é‡åˆ°çš„å°å‘"></a>é‡åˆ°çš„å°å‘</h3><h4 id="1ï¼Œæ— æ³•ä»èµ„äº§çš„index-android-bundleä¸­åŠ è½½è„šæœ¬ã€‚ç¡®ä¿ä½ çš„åŒ…è¢«æ­£ç¡®æ‰“åŒ…æˆ–è€…ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªpackageræœåŠ¡å™¨"><a href="#1ï¼Œæ— æ³•ä»èµ„äº§çš„index-android-bundleä¸­åŠ è½½è„šæœ¬ã€‚ç¡®ä¿ä½ çš„åŒ…è¢«æ­£ç¡®æ‰“åŒ…æˆ–è€…ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªpackageræœåŠ¡å™¨" class="headerlink" title="1ï¼Œæ— æ³•ä»èµ„äº§çš„index.android.bundleä¸­åŠ è½½è„šæœ¬ã€‚ç¡®ä¿ä½ çš„åŒ…è¢«æ­£ç¡®æ‰“åŒ…æˆ–è€…ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªpackageræœåŠ¡å™¨"></a>1ï¼Œ<strong>æ— æ³•ä»èµ„äº§çš„index.android.bundleä¸­åŠ è½½è„šæœ¬ã€‚ç¡®ä¿ä½ çš„åŒ…è¢«æ­£ç¡®æ‰“åŒ…æˆ–è€…ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªpackageræœåŠ¡å™¨</strong></h4><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1foac7mc3cuj30re0zowmx.jpg" alt="bundleæ— æ³•åŠ è½½æŠ¥é”™"></p><p><strong>æœç´¢äº†ä¸€æ³¢ï¼Œè¿™ä¸ªé”™è¯¯å¾ˆå¸¸è§ï¼Œè§£å†³çš„åŠæ³•ä¹Ÿå¾ˆå¸¸è§ï¼Œå¦‚ä¸‹</strong></p><ul><li>æ‰“å¼€è‡ªå·±çš„é¡¹ç›®æ–‡ä»¶å¤¹,åœ¨Android/app/src/mainç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç©ºçš„assetsæ–‡ä»¶å¤¹</li><li>cdåˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ</li></ul><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-<span class="keyword">native</span> bundle --platform android --dev <span class="keyword">false</span> --entry-<span class="keyword">file</span> index.android.js --bundle-output android<span class="regexp">/app/</span>src<span class="regexp">/main/</span>assets<span class="regexp">/index.android.bundle --assets-dest android/</span>app<span class="regexp">/src/m</span>ain<span class="regexp">/res</span></div></pre></td></tr></table></figure><ul><li>äº‹å®è¯æ˜å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜</li><li>è§£å†³æˆ‘çš„é—®é¢˜çš„æ˜¯ä¸‹é¢è¿™è¡Œ</li></ul><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-<span class="keyword">native</span> bundle --platform android --dev <span class="keyword">false</span> --entry-<span class="keyword">file</span> index.js --bundle-output android<span class="regexp">/app/</span>src<span class="regexp">/main/</span>assets<span class="regexp">/index.android.bundle --assets-dest android/</span>app<span class="regexp">/src/m</span>ain<span class="regexp">/res</span></div></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1foacbagifbj31dc0b8wk6.jpg" alt="ä¸¤è€…çš„åŒºåˆ«"></p><p><strong>æˆ‘ä»¬å¯ä»¥å›å¤´çœ‹ä¸Šé¢åˆ›å»ºå®Œé¡¹ç›®çš„æˆªå›¾ï¼Œè€ç‰ˆçš„æ˜¯åˆ†åˆ«æœ‰index.android.jså’Œindex.ios.js</strong></p><p><strong>è€Œæˆ‘åˆ›å»ºçš„å´æ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œåªæœ‰ä¸€ä¸ªindex.js,ä¿®æ”¹å®Œä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºçš„assetsç›®å½•ä¸‹ä¼šç”Ÿæˆbundleçš„ä¸¤ä¸ªæ–‡ä»¶</strong></p><h2 id="è¿è¡ŒæˆåŠŸï¼ˆandroidç«¯ï¼‰"><a href="#è¿è¡ŒæˆåŠŸï¼ˆandroidç«¯ï¼‰" class="headerlink" title="è¿è¡ŒæˆåŠŸï¼ˆandroidç«¯ï¼‰"></a>è¿è¡ŒæˆåŠŸï¼ˆandroidç«¯ï¼‰</h2><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1foacebj37wj30n014oqco.jpg" alt="è¿è¡ŒæˆåŠŸæˆªå›¾"></p><p>ç›¸å…³èµ„æ–™</p><p>[æ‹çŒ«æœˆäº®åšå®¢]<a href="https://www.jianshu.com/p/97692b1c451d" target="_blank" rel="external">https://www.jianshu.com/p/97692b1c451d</a>)</p><p><a href="https://reactnative.cn/docs/0.31/getting-started.html#content" target="_blank" rel="external">ä¸­æ–‡ç½‘</a></p><p><a href="http://blog.csdn.net/DavisCZ/article/details/79072062" target="_blank" rel="external">æŠ¥é”™</a></p><p>æœ¬æ–‡ä»…ä½œä¸ªäººå­¦ä¹ æ€»ç»“ï¼Œå¦‚æœ‰å‡ºå…¥ä¸å¤Ÿä¸¥è°¨çš„åœ°æ–¹ï¼Œè¯·è”ç³»æ›´æ”¹ã€‚</p><p><strong>ReactNativeæ‰åˆšåˆšèµ·æ­¥å­¦ä¹ ï¼Œéº»çƒ¦å’Œå‘åç»­è¿˜ä¼šç»å¸¸ç¢°åˆ°ã€‚ä½†æ˜¯ï¼Œæ—¢ç„¶é€‰æ‹©äº†å­¦ä¹ ï¼Œå°±è¦åšæŒä¸‹æ¥ï¼</strong></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è°ˆè°ˆåŠ å¯†ç®—æ³•</title>
      <link href="/2017/12/20/%E8%B0%88%E8%B0%88%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
      <content type="html"><![CDATA[<p>åœ¨åº”ç”¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å’Œç§»åŠ¨ç«¯è¦é¢‘ç¹çš„è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œæ¶‰åŠåˆ°é‡è¦éšç§ä¿¡æ¯çš„æ—¶å€™ï¼Œå°±éœ€è¦è¿›è¡Œæ•°æ®åŠ å¯†ï¼Œï¼Œå³ä½¿ä¼ è¾“çš„è¿‡ç¨‹ä¸­è¢«æˆªå–ï¼Œä¹Ÿä¸ä¼šä¿¡æ¯æ³„æ¼ã€‚å¯¹äºåŠ å¯†ç®—æ³•ï¼Œä¸å°‘å¼€å‘è€…ä¹Ÿæ—©æœ‰è€³é—»ï¼Œä¾‹å¦‚ï¼šBase64ï¼ŒMD5ï¼ŒRSAï¼ŒAESï¼ŒDESåŠ å¯†ç­‰ç­‰ï¼Œä»Šå¤©å°±æ€»ç»“ä¸€ä¸‹åŠ å¯†ç®—æ³•</p><a id="more"></a><h4 id="å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†</h4><h5 id="å¯¹ç§°åŠ å¯†ï¼š"><a href="#å¯¹ç§°åŠ å¯†ï¼š" class="headerlink" title="å¯¹ç§°åŠ å¯†ï¼š"></a>å¯¹ç§°åŠ å¯†ï¼š</h5><p>å¯¹ç§°åŠ å¯†æ˜¯æœ€å¿«é€Ÿã€æœ€ç®€å•çš„ä¸€ç§åŠ å¯†æ–¹å¼ï¼ŒåŠ å¯†ï¼ˆencryptionï¼‰ä¸è§£å¯†ï¼ˆdecryptionï¼‰ç”¨çš„æ˜¯åŒæ ·çš„å¯†é’¥ï¼ˆsecret keyï¼‰ã€‚å¯¹ç§°åŠ å¯†æœ‰å¾ˆå¤šç§ç®—æ³•ï¼Œç”±äºå®ƒæ•ˆç‡å¾ˆé«˜ï¼Œæ‰€ä»¥è¢«å¹¿æ³›ä½¿ç”¨åœ¨å¾ˆå¤šåŠ å¯†åè®®çš„æ ¸å¿ƒå½“ä¸­ã€‚</p><p>å¯¹ç§°åŠ å¯†é€šå¸¸ä½¿ç”¨çš„æ˜¯ç›¸å¯¹è¾ƒå°çš„å¯†é’¥ï¼Œä¸€èˆ¬å°äº256 bitã€‚å› ä¸ºå¯†é’¥è¶Šå¤§ï¼ŒåŠ å¯†è¶Šå¼ºï¼Œä½†åŠ å¯†ä¸è§£å¯†çš„è¿‡ç¨‹è¶Šæ…¢ã€‚å¦‚æœä½ åªç”¨1 bitæ¥åšè¿™ä¸ªå¯†é’¥ï¼Œé‚£é»‘å®¢ä»¬å¯ä»¥å…ˆè¯•ç€ç”¨0æ¥è§£å¯†ï¼Œä¸è¡Œçš„è¯å°±å†ç”¨1è§£ï¼›ä½†å¦‚æœä½ çš„å¯†é’¥æœ‰1 MBå¤§ï¼Œé»‘å®¢ä»¬å¯èƒ½æ°¸è¿œä¹Ÿæ— æ³•ç ´è§£ï¼Œä½†åŠ å¯†å’Œè§£å¯†çš„è¿‡ç¨‹è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚å¯†é’¥çš„å¤§å°æ—¢è¦ç…§é¡¾åˆ°å®‰å…¨æ€§ï¼Œä¹Ÿè¦ç…§é¡¾åˆ°æ•ˆç‡ï¼Œæ˜¯ä¸€ä¸ªtrade-offã€‚</p><p><strong>å¯¹ç§°åŠ å¯†çš„ä¸€å¤§ç¼ºç‚¹</strong>æ˜¯å¯†é’¥çš„ç®¡ç†ä¸åˆ†é…ï¼Œæ¢å¥è¯è¯´ï¼Œå¦‚ä½•æŠŠå¯†é’¥å‘é€åˆ°éœ€è¦è§£å¯†ä½ çš„æ¶ˆæ¯çš„äººçš„æ‰‹é‡Œæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚åœ¨<strong>å‘é€å¯†é’¥çš„è¿‡ç¨‹ä¸­ï¼Œå¯†é’¥æœ‰å¾ˆå¤§çš„é£é™©ä¼šè¢«é»‘å®¢ä»¬æ‹¦æˆª</strong>ã€‚<strong>ç°å®ä¸­é€šå¸¸çš„åšæ³•æ˜¯å°†å¯¹ç§°åŠ å¯†çš„å¯†é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œç„¶åä¼ é€ç»™éœ€è¦å®ƒçš„äºº</strong>ã€‚</p><h5 id="éå¯¹ç§°åŠ å¯†ï¼š"><a href="#éå¯¹ç§°åŠ å¯†ï¼š" class="headerlink" title="éå¯¹ç§°åŠ å¯†ï¼š"></a>éå¯¹ç§°åŠ å¯†ï¼š</h5><p>éå¯¹ç§°åŠ å¯†ä¸ºæ•°æ®çš„åŠ å¯†ä¸è§£å¯†æä¾›äº†ä¸€ä¸ªéå¸¸å®‰å…¨çš„æ–¹æ³•ï¼Œå®ƒä½¿ç”¨äº†ä¸€å¯¹å¯†é’¥ï¼Œå…¬é’¥ï¼ˆpublic keyï¼‰å’Œç§é’¥ï¼ˆprivate keyï¼‰ã€‚<strong>ç§é’¥åªèƒ½ç”±ä¸€æ–¹å®‰å…¨ä¿ç®¡ï¼Œä¸èƒ½å¤–æ³„</strong>ï¼Œè€Œ<strong>å…¬é’¥åˆ™å¯ä»¥å‘ç»™ä»»ä½•è¯·æ±‚å®ƒçš„äºº</strong>ã€‚<strong>éå¯¹ç§°åŠ å¯†</strong>ä½¿ç”¨è¿™å¯¹<strong>å¯†é’¥ä¸­çš„ä¸€ä¸ªè¿›è¡ŒåŠ å¯†ï¼Œè€Œè§£å¯†åˆ™éœ€è¦å¦ä¸€ä¸ªå¯†é’¥</strong>ã€‚æ¯”å¦‚ï¼Œä½ å‘é“¶è¡Œè¯·æ±‚å…¬é’¥ï¼Œ<strong>é“¶è¡Œå°†å…¬é’¥å‘ç»™ä½ ï¼Œä½ ä½¿ç”¨å…¬é’¥å¯¹æ¶ˆæ¯åŠ å¯†ï¼Œé‚£ä¹ˆåªæœ‰ç§é’¥çš„æŒæœ‰äººâ€“é“¶è¡Œæ‰èƒ½å¯¹ä½ çš„æ¶ˆæ¯è§£å¯†</strong>ã€‚ä¸å¯¹ç§°åŠ å¯†ä¸åŒçš„æ˜¯ï¼Œé“¶è¡Œä¸éœ€è¦å°†ç§é’¥é€šè¿‡ç½‘ç»œå‘é€å‡ºå»ï¼Œå› æ­¤å®‰å…¨æ€§å¤§å¤§æé«˜ã€‚</p><p>ç›®å‰<strong>æœ€å¸¸ç”¨çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æ˜¯RSAç®—æ³•</strong>ï¼Œæ˜¯Rivest, Shamir, å’ŒAdlemanäº1978å¹´å‘æ˜</p><h5 id="å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†-1"><a href="#å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†-1" class="headerlink" title="å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†</h5><p>è™½ç„¶éå¯¹ç§°åŠ å¯†å¾ˆå®‰å…¨ï¼Œä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œå®ƒéå¸¸çš„æ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯è¦ç”¨å¯¹ç§°åŠ å¯†æ¥ä¼ é€æ¶ˆæ¯ï¼Œä½†å¯¹ç§°åŠ å¯†ä½¿ç”¨çš„å¯†é’¥ç”¨éå¯¹ç§°åŠ å¯†ï¼Œå‚è€ƒç½‘ä¸Šï¼Œçœ‹ä¸‹é¢çš„ä¸€ä¸ªä¾‹å­ï¼š</p><ol><li>é“å¤´éœ€è¦åœ¨é“¶è¡Œçš„ç½‘ç«™ä¸Šåšä¸€ç¬”äº¤æ˜“ï¼Œä»–çš„æ¸¸è§ˆå™¨ç”Ÿæˆäº†ä¸€ä¸ªéšæœºæ•°ä½œä¸ºå¯¹ç§°å¯†é’¥</li><li>é“å¤´çš„æ¸¸è§ˆå™¨å‘é“¶è¡Œè¯·æ±‚éå¯¹ç§°åŠ å¯†çš„å…¬é’¥</li><li>é“¶è¡Œå°†å…¬é’¥å‘é€ç»™é“å¤´</li><li>é“å¤´ç”¨è¿™ä¸ªå…¬é’¥å°†è‡ªå·±çš„å¯¹ç§°å¯†é’¥è¿›è¡ŒåŠ å¯†</li><li>é“å¤´å°†åŠ å¯†åçš„å¯¹ç§°å¯†é’¥å‘é€ç»™é“¶è¡Œ</li><li>é“¶è¡Œç”¨éå¯¹ç§°åŠ å¯†çš„ç§æœ‰å¯†é’¥å¯¹è¿™ä¸ªå¯¹ç§°å¯†é’¥è¿›è¡Œè§£å¯†è·å–åˆ°é“å¤´çš„å¯¹ç§°å¯†é’¥</li><li>é“å¤´ä¸é“¶è¡Œå¯ä»¥ä½¿ç”¨å¯¹ç§°å¯†é’¥æ¥å¯¹æ²Ÿé€šçš„å†…å®¹è¿›è¡ŒåŠ å¯†ä¸è§£å¯†äº†ã€‚</li></ol><h5 id="å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†æ€»ç»“"><a href="#å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†æ€»ç»“" class="headerlink" title="å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†æ€»ç»“"></a>å¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†æ€»ç»“</h5><ol><li>å¯¹ç§°åŠ å¯†åŠ å¯†ä¸è§£å¯†ä½¿ç”¨çš„æ˜¯åŒæ ·çš„å¯†é’¥ï¼Œæ‰€ä»¥é€Ÿåº¦å¿«ï¼Œä½†ç”±äºéœ€è¦å°†å¯†é’¥åœ¨ç½‘ç»œä¼ è¾“ï¼Œæ‰€ä»¥å®‰å…¨æ€§ä¸é«˜ã€‚</li><li>éå¯¹ç§°åŠ å¯†ä½¿ç”¨äº†ä¸€å¯¹å¯†é’¥ï¼Œå…¬é’¥ä¸ç§é’¥ï¼Œæ‰€ä»¥å®‰å…¨æ€§é«˜ï¼Œä½†åŠ å¯†ä¸è§£å¯†é€Ÿåº¦æ…¢ã€‚</li><li>è§£å†³çš„åŠæ³•æ˜¯å°†<strong>å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿ç”¨éå¯¹ç§°åŠ å¯†çš„å…¬é’¥è¿›è¡ŒåŠ å¯†</strong>ï¼Œç„¶åå‘é€å‡ºå»ï¼Œ<strong>æ¥æ”¶æ–¹ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†å¾—åˆ°å¯¹ç§°åŠ å¯†çš„å¯†é’¥</strong>ï¼Œç„¶ååŒæ–¹å¯ä»¥ä½¿ç”¨å¯¹ç§°åŠ å¯†æ¥è¿›è¡Œæ²Ÿé€šã€‚</li></ol><h4 id="éå¯¹ç§°åŠ å¯†ä¾‹å­"><a href="#éå¯¹ç§°åŠ å¯†ä¾‹å­" class="headerlink" title="éå¯¹ç§°åŠ å¯†ä¾‹å­"></a>éå¯¹ç§°åŠ å¯†ä¾‹å­</h4><ul><li>RSAï¼ˆå‚è€ƒ<a href="http://www.cnblogs.com/whoislcj/p/5470095.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼‰</li></ul><h4 id="å¯¹ç§°åŠ å¯†ä¾‹å­"><a href="#å¯¹ç§°åŠ å¯†ä¾‹å­" class="headerlink" title="å¯¹ç§°åŠ å¯†ä¾‹å­"></a>å¯¹ç§°åŠ å¯†ä¾‹å­</h4><ul><li>AESï¼ˆå‚è€ƒ<a href="http://www.cnblogs.com/whoislcj/p/5473030.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼‰</li></ul><ol><li>é¡¹ç›®ä¸­é™¤äº†ç™»é™†ï¼Œæ”¯ä»˜ç­‰æ¥å£é‡‡ç”¨rsaéå¯¹ç§°åŠ å¯†ï¼Œä¹‹å¤–çš„é‡‡ç”¨aeså¯¹ç§°åŠ å¯†</li><li>é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆè‹±è¯­ï¼šAdvanced Encryption Standardï¼Œç¼©å†™ï¼šAESï¼‰</li><li>è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„DES</li></ol><ul><li>DESï¼ˆå‚è€ƒ<a href="http://www.cnblogs.com/whoislcj/p/5580950.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼‰</li></ul><ol><li>DESåŠ å¯†ç®—æ³•å‡ºè‡ªIBM</li><li>è¿‘äº›å¹´ä½¿ç”¨è¶Šæ¥è¶Šå°‘</li><li>DESä½¿ç”¨56ä½å¯†é’¥ï¼Œä»¥ç°ä»£è®¡ç®—èƒ½åŠ›ï¼Œ24å°æ—¶å†…å³å¯è¢«ç ´è§£ã€‚</li></ol><ul><li>AESå’ŒDESå¯¹æ¯”</li></ul><ol><li>AESå®‰å…¨æ€§ã€æ•ˆç‡ã€çµæ´»æ€§è¦é«˜äºDES</li><li>å¯¹ç§°åŠ å¯†ä¼˜å…ˆé‡‡ç”¨AES</li></ol><h4 id="å…¶ä»–åŠ å¯†"><a href="#å…¶ä»–åŠ å¯†" class="headerlink" title="å…¶ä»–åŠ å¯†"></a>å…¶ä»–åŠ å¯†</h4><ul><li>MD5</li></ul><ol><li><p>ç‰¹ç‚¹ï¼šå•å‘åŠ å¯†ç®—æ³•ï¼Œæ˜¯ä¸å¯é€†çš„ä¸€ç§çš„åŠ å¯†æ–¹å¼</p></li><li><p>å‹ç¼©æ€§ï¼šä»»æ„é•¿åº¦çš„æ•°æ®ï¼Œç®—å‡ºçš„MD5å€¼é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ã€‚</p></li><li><p>å®¹æ˜“è®¡ç®—ï¼šä»åŸæ•°æ®è®¡ç®—å‡ºMD5å€¼å¾ˆå®¹æ˜“ã€‚</p></li><li><p>æŠ—ä¿®æ”¹æ€§ï¼šå¯¹åŸæ•°æ®è¿›è¡Œä»»ä½•æ”¹åŠ¨ï¼Œå“ªæ€•åªä¿®æ”¹1ä¸ªå­—èŠ‚ï¼Œæ‰€å¾—åˆ°çš„MD5å€¼éƒ½æœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p></li><li><p>å¼ºæŠ—ç¢°æ’ï¼šå·²çŸ¥åŸæ•°æ®å’Œå…¶MD5å€¼ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªå…·æœ‰ç›¸åŒMD5å€¼çš„æ•°æ®ï¼ˆå³ä¼ªé€ æ•°æ®ï¼‰æ˜¯éå¸¸å›°éš¾çš„ã€‚</p></li><li><p>åŠ å¤§MD5å®‰å…¨æ€§</p><ul><li><h6 id="è¿›è¡Œå¤šæ¬¡MD5åŠ å¯†"><a href="#è¿›è¡Œå¤šæ¬¡MD5åŠ å¯†" class="headerlink" title="è¿›è¡Œå¤šæ¬¡MD5åŠ å¯†"></a>è¿›è¡Œå¤šæ¬¡MD5åŠ å¯†</h6></li><li><h6 id="MD5åŠ ç›"><a href="#MD5åŠ ç›" class="headerlink" title="MD5åŠ ç›"></a>MD5åŠ ç›</h6><ul><li><h6 id="ç”¨stringæ˜æ–‡çš„hashcodeä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†"><a href="#ç”¨stringæ˜æ–‡çš„hashcodeä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†" class="headerlink" title="ç”¨stringæ˜æ–‡çš„hashcodeä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†"></a>ç”¨stringæ˜æ–‡çš„hashcodeä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†</h6></li><li><h6 id="éšæœºç”Ÿæˆä¸€ä¸²å­—ç¬¦ä¸²ä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†"><a href="#éšæœºç”Ÿæˆä¸€ä¸²å­—ç¬¦ä¸²ä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†" class="headerlink" title="éšæœºç”Ÿæˆä¸€ä¸²å­—ç¬¦ä¸²ä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†"></a>éšæœºç”Ÿæˆä¸€ä¸²å­—ç¬¦ä¸²ä½œä¸ºç›ï¼Œç„¶åè¿›è¡ŒMD5åŠ å¯†</h6></li></ul></li></ul></li></ol><ul><li>Base64</li></ul><ol><li>å¹³æ—¶å¼€å‘ä¸­é‡è§çš„å„ç§æ•°æ®åŠ å¯†æ–¹å¼ï¼Œæœ€ç»ˆéƒ½ä¼šå¯¹åŠ å¯†åçš„äºŒè¿›åˆ¶æ•°æ®è¿›è¡ŒBase64ç¼–ç ï¼Œèµ·åˆ°ä¸€ç§äºŒæ¬¡åŠ å¯†çš„æ•ˆæœ</li><li>å…¶å®å‘¢Base64ä»ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´çš„è¯ä¸æ˜¯ä¸€ç§åŠ å¯†ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç§ç¼–ç ç®—æ³•</li><li><a href="http://www.cnblogs.com/whoislcj/p/5887859.html" target="_blank" rel="external">æ›´å¤š</a></li></ol><p>æ‰€ä»¥ï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ•°æ®ä¼ é€åŠ å¯†ï¼Œæœ€å¤šä½¿ç”¨çš„æ˜¯éå¯¹ç§°RSAå’Œå¯¹ç§°AESï¼Œå‚è€ƒ<a href="http://blog.csdn.net/Chay_Chan/article/details/58605605" target="_blank" rel="external">è¿™é‡Œ</a></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34274472&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Androidç­¾å</title>
      <link href="/2017/07/02/Android%E7%AD%BE%E5%90%8D/"/>
      <content type="html"><![CDATA[<p>ç­¾åæ–‡ä»¶ç”Ÿæˆä¸é…ç½®</p><a id="more"></a><p>å½“æˆ‘ä»¬ä½¿ç”¨Android Studioè¿è¡Œappï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ¨¡å¼ï¼šdebugå’Œreleaseæ¨¡å¼ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰é…ç½®ç­¾åï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤çš„ç­¾åæ–‡ä»¶ï¼ˆä¸€èˆ¬åœ¨Macï¼š/Users/fengan/.android/debug.keystoreï¼‰ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦è‡ªå·±é…ç½®åº”ç”¨çš„ç­¾åæ–‡ä»¶</p><h3 id="åˆ›å»ºKeystore"><a href="#åˆ›å»ºKeystore" class="headerlink" title="åˆ›å»ºKeystore"></a>åˆ›å»ºKeystore</h3><h3 id="é…ç½®ä¿¡æ¯"><a href="#é…ç½®ä¿¡æ¯" class="headerlink" title="é…ç½®ä¿¡æ¯"></a>é…ç½®ä¿¡æ¯</h3><h3 id="ç­¾åV1å’ŒV2çš„åŒºåˆ«"><a href="#ç­¾åV1å’ŒV2çš„åŒºåˆ«" class="headerlink" title="ç­¾åV1å’ŒV2çš„åŒºåˆ«"></a>ç­¾åV1å’ŒV2çš„åŒºåˆ«</h3><h3 id="å¾®ä¿¡å¼€æ”¾å¹³å°å¡«å†™åº”ç”¨ç­¾åçš„è·å–"><a href="#å¾®ä¿¡å¼€æ”¾å¹³å°å¡«å†™åº”ç”¨ç­¾åçš„è·å–" class="headerlink" title="å¾®ä¿¡å¼€æ”¾å¹³å°å¡«å†™åº”ç”¨ç­¾åçš„è·å–"></a>å¾®ä¿¡å¼€æ”¾å¹³å°å¡«å†™åº”ç”¨ç­¾åçš„è·å–</h3><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://www.cnblogs.com/details-666/p/keystore.html" target="_blank" rel="external">é“¾æ¥ä¸€</a></p><p><a href="https://blog.csdn.net/francisbingo/article/details/78655848" target="_blank" rel="external">é“¾æ¥äºŒ</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>transientå…³é”®å­—çš„ä½œç”¨</title>
      <link href="/2017/03/15/transient%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E4%BD%9C%E7%94%A8/"/>
      <content type="html"><![CDATA[<p>transientçš„ç›¸å…³çŸ¥è¯†æ•´ç†</p><a id="more"></a><h3 id="transientçš„ç›¸å…³çŸ¥è¯†"><a href="#transientçš„ç›¸å…³çŸ¥è¯†" class="headerlink" title="transientçš„ç›¸å…³çŸ¥è¯†"></a>transientçš„ç›¸å…³çŸ¥è¯†</h3><h4 id="å®˜æ–¹è§£é‡Š"><a href="#å®˜æ–¹è§£é‡Š" class="headerlink" title="å®˜æ–¹è§£é‡Š"></a>å®˜æ–¹è§£é‡Š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Variables may be marked <span class="keyword">transient</span> to indicate that they are not part of the persistent state of an object.</div></pre></td></tr></table></figure><h4 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“ä¸€ä¸ªå¯¹è±¡åªè¦å®ç°äº†Serializableæ¥å£ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¢«åºåˆ—åŒ–ï¼Œé‚£ä¹ˆåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œè¿™ä¸ªç±»çš„æœ‰äº›å±æ€§éœ€è¦åºåˆ—å·ï¼Œè€Œå…¶ä»–å±æ€§ä¸éœ€è¦åºåˆ—åŒ–ï¼Œæ¯”å¦‚è¯´ï¼šä¸€ä¸ªç”¨æˆ·æœ‰ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å¯†ç æˆ–è€…é“¶è¡Œå¡å·ä¹‹ç±»ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œä¸å¸Œæœ›åœ¨ç½‘ç»œæ“ä½œï¼ˆä¸»è¦æ¶‰åŠåˆ°åºåˆ—åŒ–æ“ä½œï¼Œæœ¬åœ°åºåˆ—åŒ–ç¼“å­˜ä¹Ÿé€‚ç”¨ï¼‰ä¸­è¢«ä¼ è¾“ï¼Œè¿™äº›ä¿¡æ¯å¯¹åº”çš„å˜é‡å°±å¯ä»¥åŠ ä¸Štransientå…³é”®å­—ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªå­—æ®µçš„ç”Ÿå‘½å‘¨æœŸä»…å­˜äºè°ƒç”¨è€…çš„å†…å­˜ä¸­è€Œä¸ä¼šå†™åˆ°ç£ç›˜é‡ŒæŒä¹…åŒ–ã€‚</p><h4 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h4><p>å†æ¬¡ä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªå§¿åŠ¿ç‚¹ï¼š</p><p>çˆ¶ç±»åºåˆ—åŒ–</p><blockquote><p><strong>ä¸€ä¸ªæƒ…æ™¯</strong>ï¼šä¸€ä¸ªå­ç±»å®ç°äº†Serializableæ¥å£ï¼Œå®ƒçš„çˆ¶ç±»éƒ½æ²¡æœ‰å®ç°Serializableæ¥å£ï¼Œåºåˆ—åŒ–è¯¥å­ç±»å¯¹è±¡ï¼Œç„¶åååºåˆ—åŒ–åï¼Œè¾“å‡ºçˆ¶ç±»å®šä¹‰çš„æŸå˜é‡çš„æ•°å€¼ï¼Œè¯¥å˜é‡æ•°å€¼ä¸åºåˆ—åŒ–å‰ä¸åŒ</p></blockquote><p><strong>è§£å†³</strong>ï¼š<strong>è¦æƒ³å°†çˆ¶ç±»å¯¹è±¡ä¹Ÿåºåˆ—åŒ–ï¼Œå°±éœ€è¦è®©çˆ¶ç±»ä¹Ÿå®ç°Serializable æ¥å£</strong>ã€‚å¦‚æœçˆ¶ç±»ä¸å®ç°çš„è¯çš„ï¼Œå°± <strong>éœ€è¦æœ‰é»˜è®¤çš„æ— å‚çš„æ„é€ å‡½æ•°</strong>ã€‚åœ¨çˆ¶ç±»æ²¡æœ‰å®ç° Serializable æ¥å£æ—¶ï¼Œè™šæ‹Ÿæœºæ˜¯ä¸ä¼šåºåˆ—åŒ–çˆ¶å¯¹è±¡çš„ï¼Œè€Œä¸€ä¸ª Java å¯¹è±¡çš„æ„é€ å¿…é¡»å…ˆæœ‰çˆ¶å¯¹è±¡ï¼Œæ‰æœ‰å­å¯¹è±¡ï¼Œååºåˆ—åŒ–ä¹Ÿä¸ä¾‹å¤–ã€‚æ‰€ä»¥ååºåˆ—åŒ–æ—¶ï¼Œä¸ºäº†æ„é€ çˆ¶å¯¹è±¡ï¼Œåªèƒ½è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å‡½æ•°ä½œä¸ºé»˜è®¤çš„çˆ¶å¯¹è±¡ã€‚å› æ­¤å½“æˆ‘ä»¬å–çˆ¶å¯¹è±¡çš„å˜é‡å€¼æ—¶ï¼Œå®ƒçš„å€¼æ˜¯è°ƒç”¨çˆ¶ç±»æ— å‚æ„é€ å‡½æ•°åçš„å€¼ã€‚å¦‚æœä½ è€ƒè™‘åˆ°è¿™ç§åºåˆ—åŒ–çš„æƒ…å†µï¼Œåœ¨çˆ¶ç±»æ— å‚æ„é€ å‡½æ•°ä¸­å¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦åˆ™çš„è¯ï¼Œçˆ¶ç±»å˜é‡å€¼éƒ½æ˜¯é»˜è®¤å£°æ˜çš„å€¼ï¼Œå¦‚ int å‹çš„é»˜è®¤æ˜¯ 0ï¼Œstring å‹çš„é»˜è®¤æ˜¯ nullã€‚</p><p>Transient å…³é”®å­—çš„ä½œç”¨æ˜¯æ§åˆ¶å˜é‡çš„åºåˆ—åŒ–ï¼Œåœ¨å˜é‡å£°æ˜å‰åŠ ä¸Šè¯¥å…³é”®å­—ï¼Œå¯ä»¥é˜»æ­¢è¯¥å˜é‡è¢«åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œåœ¨è¢«ååºåˆ—åŒ–åï¼Œtransient å˜é‡çš„å€¼è¢«è®¾ä¸ºåˆå§‹å€¼ï¼Œå¦‚ int å‹çš„æ˜¯ 0ï¼Œå¯¹è±¡å‹çš„æ˜¯ nullã€‚</p><p><strong>ç‰¹æ€§ä½¿ç”¨æ¡ˆä¾‹</strong></p><p>æˆ‘ä»¬ç†Ÿæ‚‰ä½¿ç”¨ Transient å…³é”®å­—å¯ä»¥ä½¿å¾—å­—æ®µä¸è¢«åºåˆ—åŒ–ï¼Œé‚£ä¹ˆè¿˜æœ‰åˆ«çš„æ–¹æ³•å—ï¼Ÿæ ¹æ®çˆ¶ç±»å¯¹è±¡åºåˆ—åŒ–çš„è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸éœ€è¦è¢«åºåˆ—åŒ–çš„å­—æ®µæŠ½å–å‡ºæ¥æ”¾åˆ°çˆ¶ç±»ä¸­ï¼Œå­ç±»å®ç° Serializable æ¥å£ï¼Œçˆ¶ç±»ä¸å®ç°ï¼Œæ ¹æ®çˆ¶ç±»åºåˆ—åŒ–è§„åˆ™ï¼Œçˆ¶ç±»çš„å­—æ®µæ•°æ®å°†ä¸è¢«åºåˆ—åŒ–</p><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/8u215.png" alt=""></p><p>ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œattr1ã€attr2ã€attr3ã€attr5 éƒ½ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œæ”¾åœ¨çˆ¶ç±»ä¸­çš„å¥½å¤„åœ¨äºå½“æœ‰å¦å¤–ä¸€ä¸ª Child ç±»æ—¶ï¼Œattr1ã€attr2ã€attr3 ä¾ç„¶ä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œä¸ç”¨é‡å¤æŠ’å†™ transientï¼Œä»£ç ç®€æ´ã€‚</p><p><strong>å‚è€ƒï¼š</strong></p><p><a href="http://blog.csdn.net/janronehoo/article/details/7306900" target="_blank" rel="external">javaå­¦ä¹ â€”åºåˆ—åŒ–ä¸Transientå…³é”®å­—</a></p><p><a href="http://blog.csdn.net/hushaoxi/article/details/52385614" target="_blank" rel="external">Transientå…³é”®å­—ä½¿ç”¨åœºæ™¯</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ASä¸­çœ‹ä¸åˆ°æºç é—®é¢˜è§£å†³</title>
      <link href="/2017/03/13/Sources-for-%E2%80%98Android-API-xx-Platform%E2%80%99-not-found/"/>
      <content type="html"><![CDATA[<p>åœ¨Android Studioç¿»æºç å¤šæ—¶å€™ï¼Œæ˜æ˜ä¸‹è½½äº†å¯¹åº”çš„SDKï¼Œå´ç‚¹è¿›å»éƒ½æ˜¯.classçœ‹ä¸åˆ°æºç ï¼Œæœ¬æ–‡è®°å½•ä¸€ä¸‹è§£å†³åŠæ³•</p><a id="more"></a><p><strong>é¦–å…ˆç¡®ä¿ä¸‹è½½äº†å¯¹åº”çš„SDK</strong></p><ul><li>æ‰¾åˆ°ä»¥ä¸‹è·¯å¾„ï¼Œå¹¶æ‰“å¼€æ–‡ä»¶</li></ul><p>~/Library/Preferences/AndroidStudioXXX/options/jdk.table.xml</p><ul><li>ä¿®æ”¹å‰</li></ul><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/w3eyx.png" alt=""></p><ul><li>ä¿®æ”¹å</li></ul><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/ehg3w.png" alt=""></p><ul><li>é‡å¯AS</li></ul>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Webviewä½¿ç”¨æ€»ç»“</title>
      <link href="/2017/03/12/Webview%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/"/>
      <content type="html"><![CDATA[<p>WebViewç›¸å…³çŸ¥è¯†æ•´ç†</p><a id="more"></a><h3 id="WebViewä½¿ç”¨æ€»ç»“"><a href="#WebViewä½¿ç”¨æ€»ç»“" class="headerlink" title="WebViewä½¿ç”¨æ€»ç»“"></a>WebViewä½¿ç”¨æ€»ç»“</h3><p><strong>å‰è¨€ï¼š</strong></p><p>æœ€è¿‘ï¼Œä¿®æ”¹äº†é¡¹ç›®ä¸­ç½‘é¡µä¸­ç‚¹å‡»å›¾ç‰‡è·³è½¬æŸ¥çœ‹å¤§å›¾é¡µé¢çš„éœ€æ±‚ï¼Œæ¿€å‘äº†æˆ‘å½’çº³æ€»ç»“WebViewçš„æƒ³æ³•ï¼Œä»Šå¤©å†æ¬¡æ•´ç†ä¸€ä¸‹ã€‚</p><p>åŒ…å«ï¼šä½¿ç”¨è¿‡ç¨‹ï¼Œå…³é”®ç±»ï¼Œjsäº¤äº’ï¼Œæ³¨æ„äº‹é¡¹ï¼Œä»¥åŠå‡ ä¸ªå¸¸è§çš„éœ€æ±‚è§£å†³æ€è·¯ç­‰ã€‚</p><p>çŒ®ä¸Šä¸€å¼ æ¡†æ¶å›¾</p><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/kd4ef.jpg" alt=""></p><h3 id="åŸºæœ¬ç®€ä»‹"><a href="#åŸºæœ¬ç®€ä»‹" class="headerlink" title="åŸºæœ¬ç®€ä»‹"></a>åŸºæœ¬ç®€ä»‹</h3><h4 id="å†…æ ¸"><a href="#å†…æ ¸" class="headerlink" title="å†…æ ¸"></a>å†…æ ¸</h4><p>åœ¨4.4ä»¥å‰çš„ç‰ˆæœ¬æ˜¯WebKitçš„å†…æ ¸ï¼Œ4.4ä»¥åæ‰æ¢æˆchromiumçš„å†…æ ¸</p><p>å¯ä½¿ç”¨ç¬¬ä¸‰æ–¹WebViewç»„ä»¶Crosswalkå’ŒTBSæœåŠ¡ï¼Œå…·ä½“åŒºåˆ«åé¢å†æ•´ç†</p><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><ul><li>æ˜¾ç¤ºå’Œæ¸²æŸ“webé¡µé¢</li><li>ç›´æ¥åŠ è½½Htmlæ–‡ä»¶ï¼ˆç½‘ç»œæˆ–è€…æœ¬åœ°assertsï¼‰</li><li>ä¸jsäº’è°ƒ</li></ul><h4 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h4><ul><li>webView.onResume() ï¼›</li></ul><p>æ¿€æ´»WebViewä¸ºæ´»è·ƒçŠ¶æ€ï¼Œèƒ½æ­£å¸¸æ‰§è¡Œç½‘é¡µçš„å“åº”</p><ul><li>webView.onPause()ï¼›</li></ul><p>å½“é¡µé¢è¢«å¤±å»ç„¦ç‚¹è¢«åˆ‡æ¢åˆ°åå°ä¸å¯è§çŠ¶æ€ï¼Œéœ€è¦æ‰§è¡ŒonPauseï¼Œé€šè¿‡onPauseåŠ¨ä½œé€šçŸ¥å†…æ ¸æš‚åœæ‰€æœ‰çš„åŠ¨ä½œï¼Œæ¯”å¦‚DOMçš„è§£æã€pluginçš„æ‰§è¡Œã€JavaScriptæ‰§è¡Œã€‚</p><ul><li>webView.pauseTimers()</li></ul><p><a href="http://blog.csdn.net/mingli198611/article/details/49385557" target="_blank" rel="external">Webviewåå°è€—ç”µçš„é—®é¢˜</a></p><p>å½“åº”ç”¨ç¨‹åº(å­˜åœ¨webview)è¢«åˆ‡æ¢åˆ°åå°æ—¶ï¼Œéœ€è¦æš‚åœæ‰€æœ‰webviewçš„layoutï¼Œparsingï¼Œjavascripttimerã€‚é™ä½CPUåŠŸè€—ã€‚</p><p>å¯ä»¥è°ƒç”¨æ­¤æ–¹æ³•</p><ul><li>webView.resumeTimers()</li></ul><p>æ¢å¤pauseTimersçŠ¶æ€</p><p><strong>æ³¨æ„ï¼š</strong></p><p>ç”±äºpauseTimerså’ŒresumeTimersæ˜¯å…¨å±€ç”Ÿæ•ˆçš„, å¹¶ä¸åªå½±å“å•ä¸ªWebView, resumeTimersæ³¨æ„ä¸è¦é—æ¼, å¦åˆ™é—æ¼çš„WebViewä¼šå‡ºç°å¼‚å¸¸. æœ€å¥½åœ¨é‡å†™çš„WebView</p><ul><li>rootLayout.removeView(webView); </li><li>webView.destroy();</li></ul><p>é”€æ¯Webviewï¼Œåœ¨å…³é—­äº†Activityæ—¶ï¼Œå¦‚æœWebviewçš„éŸ³ä¹æˆ–è§†é¢‘ï¼Œè¿˜åœ¨æ’­æ”¾ã€‚å°±å¿…é¡»é”€æ¯Webview</p><p>ä½†æ˜¯æ³¨æ„ï¼šwebviewè°ƒç”¨destoryæ—¶,webviewä»ç»‘å®šåœ¨Activityä¸Š</p><p>è¿™æ˜¯ç”±äºè‡ªå®šä¹‰webviewæ„å»ºæ—¶ä¼ å…¥äº†è¯¥Activityçš„contextå¯¹è±¡</p><p>å› æ­¤éœ€è¦å…ˆä»çˆ¶å®¹å™¨ä¸­ç§»é™¤webview,ç„¶åå†é”€æ¯webview:</p><h4 id="å‰è¿›å›é€€ç½‘é¡µ"><a href="#å‰è¿›å›é€€ç½‘é¡µ" class="headerlink" title="å‰è¿›å›é€€ç½‘é¡µ"></a>å‰è¿›å›é€€ç½‘é¡µ</h4><ul><li>Webview.canGoBack() </li></ul><p>æ˜¯å¦å¯ä»¥åé€€</p><ul><li>Webview.goBack()</li></ul><p>åé€€ç½‘é¡µ</p><ul><li>Webview.canGoForward()</li></ul><p>æ˜¯å¦å¯ä»¥å‰è¿› </p><ul><li>Webview.goForward()</li></ul><p>å‰è¿›ç½‘é¡µ</p><ul><li>Webview.goBackOrForward(intsteps) </li></ul><p>ä»¥å½“å‰çš„indexä¸ºèµ·å§‹ç‚¹å‰è¿›æˆ–è€…åé€€åˆ°å†å²è®°å½•ä¸­æŒ‡å®šçš„steps</p><p>å¦‚æœstepsä¸ºè´Ÿæ•°åˆ™ä¸ºåé€€ï¼Œæ­£æ•°åˆ™ä¸ºå‰è¿›</p><p><strong>å¸¸è§ç”¨æ³•ï¼š</strong></p><ul><li>é—®é¢˜</li></ul><p>åœ¨ä¸åšä»»ä½•å¤„ç†å‰æä¸‹ ï¼Œæµè§ˆç½‘é¡µæ—¶ç‚¹å‡»ç³»ç»Ÿçš„â€œBackâ€é”®,æ•´ä¸ª Browser ä¼šè°ƒç”¨ finish()è€Œç»“æŸè‡ªèº«</p><ul><li>ç›®æ ‡</li></ul><p>ç‚¹å‡»è¿”å›åï¼Œæ˜¯ç½‘é¡µå›é€€è€Œä¸æ˜¯æ¨å‡ºæµè§ˆå™¨</p><ul><li>è§£å†³æ–¹æ¡ˆ</li></ul><p>åœ¨å½“å‰Activityä¸­å¤„ç†å¹¶æ¶ˆè´¹æ‰è¯¥ Back äº‹ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> ((keyCode == KEYCODE_BACK) &amp;&amp; mWebView.canGoBack()) &#123; </div><div class="line">        mWebView.goBack();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyDown(keyCode, event);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å¸¸ç”¨ç±»"><a href="#å¸¸ç”¨ç±»" class="headerlink" title="å¸¸ç”¨ç±»"></a>å¸¸ç”¨ç±»</h3><h4 id="WebSettings"><a href="#WebSettings" class="headerlink" title="WebSettings"></a>WebSettings</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å£°æ˜WebSettingså­ç±»</span></div><div class="line">WebSettings webSettings = webView.getSettings();</div><div class="line"></div><div class="line"><span class="comment">//å¦‚æœè®¿é—®çš„é¡µé¢ä¸­è¦ä¸Javascriptäº¤äº’ï¼Œåˆ™webviewå¿…é¡»è®¾ç½®æ”¯æŒJavascript</span></div><div class="line">webSettings.setJavaScriptEnabled(<span class="keyword">true</span>);  </div><div class="line"></div><div class="line"><span class="comment">//æ”¯æŒæ’ä»¶</span></div><div class="line">webSettings.setPluginsEnabled(<span class="keyword">true</span>); </div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®è‡ªé€‚åº”å±å¹•ï¼Œä¸¤è€…åˆç”¨</span></div><div class="line">webSettings.setUseWideViewPort(<span class="keyword">true</span>); <span class="comment">//å°†å›¾ç‰‡è°ƒæ•´åˆ°é€‚åˆwebviewçš„å¤§å° </span></div><div class="line">webSettings.setLoadWithOverviewMode(<span class="keyword">true</span>); <span class="comment">// ç¼©æ”¾è‡³å±å¹•çš„å¤§å°</span></div><div class="line"></div><div class="line"><span class="comment">//ç¼©æ”¾æ“ä½œ</span></div><div class="line">webSettings.setSupportZoom(<span class="keyword">true</span>); <span class="comment">//æ”¯æŒç¼©æ”¾ï¼Œé»˜è®¤ä¸ºtrueã€‚æ˜¯ä¸‹é¢é‚£ä¸ªçš„å‰æã€‚</span></div><div class="line">webSettings.setBuiltInZoomControls(<span class="keyword">true</span>); <span class="comment">//è®¾ç½®å†…ç½®çš„ç¼©æ”¾æ§ä»¶ã€‚è‹¥ä¸ºfalseï¼Œåˆ™è¯¥WebViewä¸å¯ç¼©æ”¾</span></div><div class="line">webSettings.setDisplayZoomControls(<span class="keyword">false</span>); <span class="comment">//éšè—åŸç”Ÿçš„ç¼©æ”¾æ§ä»¶</span></div><div class="line"></div><div class="line"><span class="comment">//å…¶ä»–ç»†èŠ‚æ“ä½œ</span></div><div class="line">webSettings.setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK); <span class="comment">//å…³é—­webviewä¸­ç¼“å­˜ </span></div><div class="line">webSettings.setAllowFileAccess(<span class="keyword">true</span>); <span class="comment">//è®¾ç½®å¯ä»¥è®¿é—®æ–‡ä»¶ </span></div><div class="line">webSettings.setJavaScriptCanOpenWindowsAutomatically(<span class="keyword">true</span>); <span class="comment">//æ”¯æŒé€šè¿‡JSæ‰“å¼€æ–°çª—å£ </span></div><div class="line">webSettings.setLoadsImagesAutomatically(<span class="keyword">true</span>); <span class="comment">//æ”¯æŒè‡ªåŠ¨åŠ è½½å›¾ç‰‡</span></div><div class="line">webSettings.setDefaultTextEncodingName(<span class="string">"utf-8"</span>);<span class="comment">//è®¾ç½®ç¼–ç æ ¼å¼</span></div><div class="line"><span class="comment">//ä¼˜å…ˆä½¿ç”¨ç¼“å­˜: </span></div><div class="line">webSettings.setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK); </div><div class="line">        <span class="comment">//ç¼“å­˜æ¨¡å¼å¦‚ä¸‹ï¼š</span></div><div class="line">        <span class="comment">//LOAD_CACHE_ONLY: ä¸ä½¿ç”¨ç½‘ç»œï¼Œåªè¯»å–æœ¬åœ°ç¼“å­˜æ•°æ®</span></div><div class="line">        <span class="comment">//LOAD_DEFAULT: ï¼ˆé»˜è®¤ï¼‰æ ¹æ®cache-controlå†³å®šæ˜¯å¦ä»ç½‘ç»œä¸Šå–æ•°æ®ã€‚</span></div><div class="line">        <span class="comment">//LOAD_NO_CACHE: ä¸ä½¿ç”¨ç¼“å­˜ï¼Œåªä»ç½‘ç»œè·å–æ•°æ®.</span></div><div class="line">        <span class="comment">//LOAD_CACHE_ELSE_NETWORKï¼Œåªè¦æœ¬åœ°æœ‰ï¼Œæ— è®ºæ˜¯å¦è¿‡æœŸï¼Œæˆ–è€…no-cacheï¼Œéƒ½ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ã€‚</span></div></pre></td></tr></table></figure><p><strong>å¸¸è§ç¼“å­˜ç”¨æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (NetStatusUtil.isConnected(getApplicationContext())) &#123;</div><div class="line">    webSettings.setCacheMode(WebSettings.LOAD_DEFAULT);<span class="comment">//æ ¹æ®cache-controlå†³å®šæ˜¯å¦ä»ç½‘ç»œä¸Šå–æ•°æ®ã€‚</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    webSettings.setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK);<span class="comment">//æ²¡ç½‘ï¼Œåˆ™ä»æœ¬åœ°è·å–ï¼Œå³ç¦»çº¿åŠ è½½</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">webSettings.setDomStorageEnabled(<span class="keyword">true</span>); <span class="comment">// å¼€å¯ DOM storage API åŠŸèƒ½</span></div><div class="line">webSettings.setDatabaseEnabled(<span class="keyword">true</span>);   <span class="comment">//å¼€å¯ database storage API åŠŸèƒ½</span></div><div class="line">webSettings.setAppCacheEnabled(<span class="keyword">true</span>);<span class="comment">//å¼€å¯ Application Caches åŠŸèƒ½</span></div><div class="line"></div><div class="line">String cacheDirPath = getFilesDir().getAbsolutePath() + APP_CACAHE_DIRNAME;</div><div class="line">webSettings.setAppCachePath(cacheDirPath); <span class="comment">//è®¾ç½®  Application Caches ç¼“å­˜ç›®å½•</span></div></pre></td></tr></table></figure><p><strong>æ¯ä¸ª Application åªè°ƒç”¨ä¸€æ¬¡ WebSettings.setAppCachePath()ï¼ŒWebSettings.setAppCacheMaxSize()</strong></p><h4 id="WebViewClient"><a href="#WebViewClient" class="headerlink" title="WebViewClient"></a>WebViewClient</h4><h5 id="ä¸»è¦è¾…åŠ©WebViewå¤„ç†å„ç§é€šçŸ¥ã€è¯·æ±‚äº‹ä»¶"><a href="#ä¸»è¦è¾…åŠ©WebViewå¤„ç†å„ç§é€šçŸ¥ã€è¯·æ±‚äº‹ä»¶" class="headerlink" title="ä¸»è¦è¾…åŠ©WebViewå¤„ç†å„ç§é€šçŸ¥ã€è¯·æ±‚äº‹ä»¶"></a><strong>ä¸»è¦è¾…åŠ©WebViewå¤„ç†å„ç§é€šçŸ¥ã€è¯·æ±‚äº‹ä»¶</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> WebViewClient()&#123;</div><div class="line"><span class="comment">//            ä½¿å¾—æ‰“å¼€ç½‘é¡µæ—¶ä¸è°ƒç”¨ç³»ç»Ÿæµè§ˆå™¨ï¼Œ è€Œæ˜¯åœ¨æœ¬WebViewä¸­æ˜¾ç¤º</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, WebResourceRequest request)</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">super</span>.shouldOverrideUrlLoading(view, request);</div><div class="line">            &#125;</div><div class="line"></div><div class="line"><span class="comment">//            å¼€å§‹è½½å…¥é¡µé¢è°ƒç”¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¾å®šä¸€ä¸ªloadingçš„é¡µé¢ï¼Œå‘Šè¯‰ç”¨æˆ·ç¨‹åºåœ¨ç­‰å¾…ç½‘ç»œå“åº”ã€‚</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageStarted</span><span class="params">(WebView view, String url, Bitmap favicon)</span> </span>&#123;</div><div class="line">                <span class="keyword">super</span>.onPageStarted(view, url, favicon);</div><div class="line">            &#125;</div><div class="line"></div><div class="line"><span class="comment">//            åœ¨é¡µé¢åŠ è½½ç»“æŸæ—¶è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥å…³é—­loading æ¡ï¼Œåˆ‡æ¢ç¨‹åºåŠ¨ä½œã€‚</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>&#123;</div><div class="line">                <span class="keyword">super</span>.onPageFinished(view, url);</div><div class="line">            &#125;</div><div class="line"></div><div class="line"><span class="comment">//            åœ¨åŠ è½½é¡µé¢èµ„æºæ—¶ä¼šè°ƒç”¨ï¼Œæ¯ä¸€ä¸ªèµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰çš„åŠ è½½éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ã€‚</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoadResource</span><span class="params">(WebView view, String url)</span> </span>&#123;</div><div class="line">                <span class="keyword">super</span>.onLoadResource(view, url);</div><div class="line">            &#125;</div><div class="line"></div><div class="line"><span class="comment">//            è¯¥æ–¹æ³•ä¼ å›äº†é”™è¯¯ç ï¼Œæ ¹æ®é”™è¯¯ç±»å‹å¯ä»¥è¿›è¡Œä¸åŒçš„é”™è¯¯åˆ†ç±»å¤„ç†</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedError</span><span class="params">(WebView view, WebResourceRequest request, WebResourceError error)</span> </span>&#123;</div><div class="line">                <span class="keyword">super</span>.onReceivedError(view, request, error);</div><div class="line">            &#125;</div><div class="line"></div><div class="line"><span class="comment">//            webViewé»˜è®¤æ˜¯ä¸å¤„ç†httpsè¯·æ±‚çš„ï¼Œé¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œéœ€è¦è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedSslError</span><span class="params">(WebView view, SslErrorHandler handler, SslError error)</span> </span>&#123;</div><div class="line"><span class="comment">//                super.onReceivedSslError(view, handler, error);</span></div><div class="line">                handler.proceed();    <span class="comment">//è¡¨ç¤ºç­‰å¾…è¯ä¹¦å“åº”</span></div><div class="line">                <span class="comment">// handler.cancel();      //è¡¨ç¤ºæŒ‚èµ·è¿æ¥ï¼Œä¸ºé»˜è®¤æ–¹å¼</span></div><div class="line">                <span class="comment">// handler.handleMessage(null);    //å¯åšå…¶ä»–å¤„ç†</span></div><div class="line">            &#125;</div><div class="line">        &#125;;</div></pre></td></tr></table></figure><h4 id="WebChromClient"><a href="#WebChromClient" class="headerlink" title="WebChromClient"></a>WebChromClient</h4><p><strong>è¾…åŠ© WebView å¤„ç† Javascript çš„å¯¹è¯æ¡†,ç½‘ç«™å›¾æ ‡,ç½‘ç«™æ ‡é¢˜ç­‰ç­‰ã€‚</strong></p><ul><li>è·å¾—ç½‘é¡µçš„åŠ è½½è¿›åº¦å¹¶æ˜¾ç¤º</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">webview.setWebChromeClient(<span class="keyword">new</span> WebChromeClient()&#123;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgressChanged</span><span class="params">(WebView view, <span class="keyword">int</span> newProgress)</span> </span>&#123;</div><div class="line">          <span class="keyword">if</span> (newProgress &lt; <span class="number">100</span>) &#123;</div><div class="line">              String progress = newProgress + <span class="string">"%"</span>;</div><div class="line">              progress.setText(progress);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure><ul><li><strong>onReceivedTitleï¼ˆï¼‰</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">webview.setWebChromeClient(<span class="keyword">new</span> WebChromeClient()&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedTitle</span><span class="params">(WebView view, String title)</span> </span>&#123;</div><div class="line">       titleview.setText(title)ï¼›</div><div class="line">    &#125;</div></pre></td></tr></table></figure><h3 id="JSäº¤äº’"><a href="#JSäº¤äº’" class="headerlink" title="JSäº¤äº’"></a>JSäº¤äº’</h3><p><a href="http://blog.csdn.net/carson_ho/article/details/64904691" target="_blank" rel="external">åŸæ–‡</a></p><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/o45jt.png" alt=""></p><h4 id="Androidè°ƒJs"><a href="#Androidè°ƒJs" class="headerlink" title="Androidè°ƒJs"></a>Androidè°ƒJs</h4><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/1m6qx.png" alt=""></p><p><strong>ä½¿ç”¨å»ºè®®</strong></p><p>ä¸¤ç§æ–¹æ³•æ··åˆä½¿ç”¨ï¼Œå³Android 4.4ä»¥ä¸‹ä½¿ç”¨æ–¹æ³•1ï¼ŒAndroid 4.4ä»¥ä¸Šæ–¹æ³•2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Androidç‰ˆæœ¬å˜é‡</span></div><div class="line"><span class="keyword">final</span> <span class="keyword">int</span> version = Build.VERSION.SDK_INT;</div><div class="line"><span class="comment">// å› ä¸ºè¯¥æ–¹æ³•åœ¨ Android 4.4 ç‰ˆæœ¬æ‰å¯ä½¿ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¿›è¡Œç‰ˆæœ¬åˆ¤æ–­</span></div><div class="line"><span class="keyword">if</span> (version &lt; <span class="number">18</span>) &#123;</div><div class="line">    mWebView.loadUrl(<span class="string">"javascript:callJS()"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    mWebView.evaluateJavascriptï¼ˆ<span class="string">"javascript:callJS()"</span>, <span class="keyword">new</span> ValueCallback&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveValue</span><span class="params">(String value)</span> </span>&#123;</div><div class="line">            <span class="comment">//æ­¤å¤„ä¸º js è¿”å›çš„ç»“æœ</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="é€šè¿‡loadUrlæ–¹å¼è°ƒç”¨js"><a href="#é€šè¿‡loadUrlæ–¹å¼è°ƒç”¨js" class="headerlink" title="é€šè¿‡loadUrlæ–¹å¼è°ƒç”¨js"></a>é€šè¿‡loadUrlæ–¹å¼è°ƒç”¨js</h5><p>Htmlä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">// æ–‡æœ¬åï¼šjavascript</div><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">title</span>&gt;</span>Carson_Ho<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"></div><div class="line">// JSä»£ç </div><div class="line">     <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript"></span></div><div class="line"><span class="comment">// Androidéœ€è¦è°ƒç”¨çš„æ–¹æ³•</span></div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">callJS</span><span class="params">()</span></span>&#123;</div><div class="line">      alert(<span class="string">"Androidè°ƒç”¨äº†JSçš„callJSæ–¹æ³•"</span>);</div><div class="line">   &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><p>Androidä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¾ç½®ä¸Jsäº¤äº’çš„æƒé™</span></div><div class="line">       webSettings.setJavaScriptEnabled(<span class="keyword">true</span>);</div><div class="line">       <span class="comment">// è®¾ç½®å…è®¸JSå¼¹çª—</span></div><div class="line">       webSettings.setJavaScriptCanOpenWindowsAutomatically(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">       <span class="comment">// å…ˆè½½å…¥JSä»£ç </span></div><div class="line">       <span class="comment">// æ ¼å¼è§„å®šä¸º:file:///android_asset/æ–‡ä»¶å.html</span></div><div class="line">       mWebView.loadUrl(<span class="string">"file:///android_asset/javascript.html"</span>);</div><div class="line"></div><div class="line">       button = (Button) findViewById(R.id.button);</div><div class="line"></div><div class="line"></div><div class="line">       button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">               <span class="comment">// å¿…é¡»å¦å¼€çº¿ç¨‹è¿›è¡ŒJSæ–¹æ³•è°ƒç”¨(å¦åˆ™æ— æ³•è°ƒç”¨)</span></div><div class="line">               mWebView.post(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">                   <span class="meta">@Override</span></div><div class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">                       <span class="comment">// æ³¨æ„è°ƒç”¨çš„JSæ–¹æ³•åè¦å¯¹åº”ä¸Š</span></div><div class="line">                       <span class="comment">// è°ƒç”¨javascriptçš„callJS()æ–¹æ³•</span></div><div class="line">                       mWebView.loadUrl(<span class="string">"javascript:callJS()"</span>);</div><div class="line">                   &#125;</div><div class="line">               &#125;);</div><div class="line"></div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line"></div><div class="line">       <span class="comment">// ç”±äºè®¾ç½®äº†å¼¹çª—æ£€éªŒè°ƒç”¨ç»“æœ,æ‰€ä»¥éœ€è¦æ”¯æŒjså¯¹è¯æ¡†</span></div><div class="line">       <span class="comment">// webviewåªæ˜¯è½½ä½“ï¼Œå†…å®¹çš„æ¸²æŸ“éœ€è¦ä½¿ç”¨webviewChromClientç±»å»å®ç°</span></div><div class="line">       <span class="comment">// é€šè¿‡è®¾ç½®WebChromeClientå¯¹è±¡å¤„ç†JavaScriptçš„å¯¹è¯æ¡†</span></div><div class="line">       <span class="comment">//è®¾ç½®å“åº”js çš„Alert()å‡½æ•°</span></div><div class="line">       mWebView.setWebChromeClient(<span class="keyword">new</span> WebChromeClient() &#123;</div><div class="line">           <span class="meta">@Override</span></div><div class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onJsAlert</span><span class="params">(WebView view, String url, String message, <span class="keyword">final</span> JsResult result)</span> </span>&#123;</div><div class="line">               AlertDialog.Builder b = <span class="keyword">new</span> AlertDialog.Builder(MainActivity.<span class="keyword">this</span>);</div><div class="line">               b.setTitle(<span class="string">"Alert"</span>);</div><div class="line">               b.setMessage(message);</div><div class="line">               b.setPositiveButton(android.R.string.ok, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line">                   <span class="meta">@Override</span></div><div class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line">                       result.confirm();</div><div class="line">                   &#125;</div><div class="line">               &#125;);</div><div class="line">               b.setCancelable(<span class="keyword">false</span>);</div><div class="line">               b.create().show();</div><div class="line">               <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">           &#125;</div><div class="line"></div><div class="line">       &#125;);</div><div class="line"></div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure><p><strong>ç‰¹åˆ«æ³¨æ„ï¼šJSä»£ç è°ƒç”¨ä¸€å®šè¦åœ¨ onPageFinishedï¼ˆï¼‰ å›è°ƒä¹‹åæ‰èƒ½è°ƒç”¨ï¼Œå¦åˆ™ä¸ä¼šè°ƒç”¨ã€‚</strong></p><p><code>onPageFinished()</code>å±äºWebViewClientç±»çš„æ–¹æ³•ï¼Œä¸»è¦åœ¨é¡µé¢åŠ è½½ç»“æŸæ—¶è°ƒç”¨</p><p>æ‰€ä»¥ä¸€èˆ¬ç­‰onPageFnishedå›è°ƒä¹‹åï¼Œæˆ‘ä»¬æ‰æ˜¾ç¤ºH5çš„é¡µé¢ï¼ŒåŠ è½½æœªå®Œå…¨çš„æ—¶å€™ï¼Œåˆ™æ˜¾ç¤ºloadingé¡µé¢</p><h5 id="é€šè¿‡evaluateJavascriptè°ƒç”¨js"><a href="#é€šè¿‡evaluateJavascriptè°ƒç”¨js" class="headerlink" title="é€šè¿‡evaluateJavascriptè°ƒç”¨js"></a>é€šè¿‡evaluateJavascriptè°ƒç”¨js</h5><p><strong>ä¼˜ç‚¹</strong></p><p>è¯¥æ–¹æ³•æ¯”ç¬¬ä¸€ç§æ–¹æ³•æ•ˆç‡æ›´é«˜ã€ä½¿ç”¨æ›´ç®€æ´ã€‚</p><ul><li>å› ä¸ºè¯¥æ–¹æ³•çš„æ‰§è¡Œä¸ä¼šä½¿é¡µé¢åˆ·æ–°ï¼Œè€Œç¬¬ä¸€ç§æ–¹æ³•ï¼ˆloadUrl ï¼‰çš„æ‰§è¡Œåˆ™ä¼šã€‚</li><li>Android 4.4 åæ‰å¯ä½¿ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åªéœ€è¦å°†ç¬¬ä¸€ç§æ–¹æ³•çš„loadUrl()æ¢æˆä¸‹é¢è¯¥æ–¹æ³•å³å¯</span></div><div class="line">    mWebView.evaluateJavascriptï¼ˆ<span class="string">"javascript:callJS()"</span>, <span class="keyword">new</span> ValueCallback&lt;String&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceiveValue</span><span class="params">(String value)</span> </span>&#123;</div><div class="line">            <span class="comment">//æ­¤å¤„ä¸º js è¿”å›çš„ç»“æœ</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Jsè°ƒAndroid"><a href="#Jsè°ƒAndroid" class="headerlink" title="Jsè°ƒAndroid"></a>Jsè°ƒAndroid</h4><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/vhjwh.png" alt=""></p><h3 id="ç¼“å­˜é—®é¢˜"><a href="#ç¼“å­˜é—®é¢˜" class="headerlink" title="ç¼“å­˜é—®é¢˜"></a>ç¼“å­˜é—®é¢˜</h3><p><a href="https://www.jianshu.com/p/f1efb0928ebc" target="_blank" rel="external">åŸæ–‡</a></p><h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><p><a href="http://blog.csdn.net/carson_ho/article/details/52693322" target="_blank" rel="external">Carson_Ho</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æµ…ævolatileå…³é”®å­—</title>
      <link href="/2017/03/07/%E6%B5%85%E6%9E%90volatile%E5%85%B3%E9%94%AE%E5%AD%97/"/>
      <content type="html"><![CDATA[<p>åœ¨çœ‹javaå¹¶å‘çš„ä¹¦çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†å…³äºjavaçš„å•ä¾‹æ¨¡å¼ä½¿ç”¨äº†volatileå…³é”®å­—ï¼Œä½†æ˜¯å¯¹volatileå…³é”®å­—çš„çœŸæ­£å«ä¹‰ä¸€ç›´å¾ˆæ¨¡ç³Šï¼Œæœ¬æ–‡å°±å°è¯•æµ…ææ€»ç»“ä¸€ä¸‹volatileçš„ä½œç”¨å’Œå…·ä½“ç”¨æ³•ã€‚</p><a id="more"></a><h3 id="å•ä¾‹æ¨¡å¼ä¸­çš„volatileå…³é”®å­—"><a href="#å•ä¾‹æ¨¡å¼ä¸­çš„volatileå…³é”®å­—" class="headerlink" title="å•ä¾‹æ¨¡å¼ä¸­çš„volatileå…³é”®å­—"></a>å•ä¾‹æ¨¡å¼ä¸­çš„volatileå…³é”®å­—</h3><p><a href="http://blog.csdn.net/u011248395/article/details/71087379" target="_blank" rel="external">æŸ¥çœ‹åŸæ–‡</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestInstance</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> TestInstance instance;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TestInstance <span class="title">getInstance</span><span class="params">()</span> </span>&#123; <span class="comment">//1</span></div><div class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;                  <span class="comment">//2</span></div><div class="line">            <span class="keyword">synchronized</span> (TestInstance.class) &#123;<span class="comment">//3</span></div><div class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123; <span class="comment">//4</span></div><div class="line">                    instance = <span class="keyword">new</span> TestInstance();<span class="comment">//5</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> instance;<span class="comment">//6</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰volatileå…³é”®å­—ï¼Œåœ¨ç¬¬5è¡Œä¼šå‡ºç°é—®é¢˜</strong></p><p> instance = new TestInstance();//5    å¯ä»¥åˆ†è§£ä»¥ä¸‹ä¸‰éƒ¨</p><p>1ï¼Œç”³è¯·å†…å­˜</p><p>2ï¼Œé€šè¿‡æ„é€ æ–¹æ³•åˆå§‹åŒ–å¯¹è±¡</p><p>3ï¼Œå°†å¯¹è±¡æŒ‡å‘ç”³è¯·çš„å†…å­˜</p><p>ä½†å½“Açº¿ç¨‹è¿›è¡Œç¬¬äº”éƒ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ„é€ å‡½æ•°é‡Œé¢çš„æ“ä½œå¤ªå¤šï¼Œæ‰€ä»¥Açº¿ç¨‹è¿˜æ²¡æœ‰åˆå§‹åŒ–å®Œæ¯•ï¼Œä½†å·²ç»è¢«èµ‹å€¼äº†ï¼Œä¹Ÿå°±æ˜¯ä»¥ä¸Šçš„é¡ºåºç”±1-2-3å˜æˆäº†1-3-2ã€‚æ­¤æ—¶Bçº¿ç¨‹è¿›æ¥åˆ¤æ–­TestInstanceä¸ä¸ºnullï¼Œé”™ä»¥ä¸ºå·²ç»å®ä¾‹åŒ–å®Œæ¯•è¿”å›äº†ä¸€ä¸ªæœªåˆå§‹åŒ–çš„å¯¹è±¡ï¼ˆå› ä¸ºæ„é€ å‡½æ•°æœªå®Œå…¨ï¼Œåˆå§‹è®¾ç½®å€¼æœªå®Œå…¨çš„å¯¹è±¡ï¼‰ï¼Œå°±å‡ºé—®é¢˜äº†ã€‚å¦‚æœå£°æ˜ç§°volatileï¼Œ2å’Œ3æ­¥éª¤ä¸ä¼šè¢«æ’åº</p><h3 id="volatileçš„ä½œç”¨ä¸ç‰¹ç‚¹"><a href="#volatileçš„ä½œç”¨ä¸ç‰¹ç‚¹" class="headerlink" title="volatileçš„ä½œç”¨ä¸ç‰¹ç‚¹"></a>volatileçš„ä½œç”¨ä¸ç‰¹ç‚¹</h3><p>é€šè¿‡ä¸Šè¯‰å•ä¾‹æ¨¡å¼ä¸­volatileçš„ä½¿ç”¨ï¼Œé‚£ä¹ˆvolatileå…³é”®å­—å…·ä½“çš„ä½œç”¨åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é¦–å…ˆçœ‹ä¸€å¼ å›¾</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fp4by9i6z9j31gc0n2qf8.jpg" alt="å¤šçº¿ç¨‹ä¸­ï¼Œä¸»å†…å­˜å’Œçº¿ç¨‹å·¥ä½œå†…å­˜å…³ç³»"></p><p>ç”±ä¸Šå›¾ï¼Œéœ€è¦çŸ¥é“çš„å‡ ç‚¹</p><ul><li><p>javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­</p></li><li><p>Javaå†…å­˜æ¨¡å‹åˆ†ä¸º<strong>ä¸»å†…å­˜</strong>ï¼Œå’Œ<strong>å·¥ä½œå†…å­˜</strong></p></li><li><p>ä¸»å†…å­˜æ˜¯æ‰€æœ‰çš„çº¿ç¨‹æ‰€å…±äº«çš„ï¼Œå·¥ä½œå†…å­˜æ˜¯æ¯ä¸ªçº¿ç¨‹è‡ªå·±æœ‰ä¸€ä¸ªï¼Œä¸æ˜¯å…±äº«çš„ã€‚</p></li><li><p>çº¿ç¨‹çš„<strong>å·¥ä½œå†…å­˜</strong>ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„<strong>ä¸»å†…å­˜å‰¯æœ¬æ‹·è´</strong></p></li><li><p>çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œï¼ˆè¯»å–ã€èµ‹å€¼ï¼‰ï¼Œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡</p></li><li><p>ä¸åŒçº¿ç¨‹ä¹‹é—´ä¹Ÿ<strong>æ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜</strong>ä¸­çš„å˜é‡</p><p>åŸºäºä¸Šè¯‰çš„ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„æè¿°ï¼Œé‚£ä¹ˆ</p><p><strong>volatile</strong>çš„ä½œç”¨ï¼š</p><p>volatileèµ‹äºˆäº†å˜é‡å¯è§â€”â€”<strong>ç¦æ­¢ç¼–è¯‘å™¨å¯¹æˆå‘˜å˜é‡è¿›è¡Œä¼˜åŒ–ï¼Œå®ƒä¿®é¥°çš„æˆå‘˜å˜é‡åœ¨æ¯æ¬¡è¢«çº¿ç¨‹è®¿é—®æ—¶ï¼Œéƒ½å¼ºè¿«ä»å†…å­˜ä¸­é‡è¯»è¯¥æˆå‘˜å˜é‡çš„å€¼ï¼›è€Œä¸”ï¼Œå½“æˆå‘˜å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¼ºè¿«çº¿ç¨‹å°†å˜åŒ–å€¼å›å†™åˆ°å…±äº«å†…å­˜ï¼Œè¿™æ ·åœ¨ä»»ä½•æ—¶åˆ»ä¸¤ä¸ªä¸åŒçº¿ç¨‹æ€»æ˜¯çœ‹åˆ°æŸä¸€æˆå‘˜å˜é‡çš„åŒä¸€ä¸ªå€¼</strong>ï¼Œè¿™å°±æ˜¯ä¿è¯äº†å¯è§æ€§ã€‚</p><p>â€‹</p><p>ä»ç½‘ä¸Šçœ‹è§äº†ä¸€ç¯‡åšå®¢å¯ä»¥å¾ˆå¥½çš„è¯´æ˜ï¼Œæˆ‘å°†ç›¸å…³éƒ¨åˆ†æˆªäº†ä¸ªå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fp4c550vj9j311g174wnw.jpg" alt=""></p></li></ul><h4 id="å¤šçº¿ç¨‹çš„ä¸‰ä¸ªç‰¹æ€§"><a href="#å¤šçº¿ç¨‹çš„ä¸‰ä¸ªç‰¹æ€§" class="headerlink" title="å¤šçº¿ç¨‹çš„ä¸‰ä¸ªç‰¹æ€§"></a>å¤šçº¿ç¨‹çš„ä¸‰ä¸ªç‰¹æ€§</h4><p><a href="https://www.cnblogs.com/chihirotan/p/6486436.html" target="_blank" rel="external">ç›¸å…³æ–‡ç« </a></p><ul><li><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong></li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">åŸå­æ€§æ˜¯æŒ‡ä¸€ä¸ªåŸå­æ“ä½œåœ¨<span class="meta">cpu</span>ä¸­ä¸å¯ä»¥æš‚åœç„¶åå†è°ƒåº¦ï¼Œæ—¢ä¸è¢«ä¸­æ–­æ“ä½œï¼Œè¦ä¸æ‰§è¡Œå®Œæˆï¼Œè¦ä¸å°±ä¸æ‰§è¡Œã€‚åŸå­æ“ä½œä¿è¯äº†åŸå­æ€§é—®é¢˜ã€‚</div></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>i++ä¸æ˜¯åŸå­æ“ä½œ</strong>ï¼š</p><p>x++ï¼ˆåŒ…å«ä¸‰ä¸ªåŸå­æ“ä½œï¼‰a.å°†å˜é‡x å€¼å–å‡ºæ”¾åœ¨å¯„å­˜å™¨ä¸­ b.å°†å°†å¯„å­˜å™¨ä¸­çš„å€¼+1 c.å°†å¯„å­˜å™¨ä¸­çš„å€¼èµ‹å€¼ç»™x</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">synchronized</span>å—ä¹‹é—´çš„æ“ä½œä¹Ÿå…·å¤‡åŸå­æ€§</div></pre></td></tr></table></figure><ul><li><strong>å¯è§æ€§(Visibility)</strong></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å¯è§æ€§å°±æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†çº¿ç¨‹å…±äº«å˜é‡çš„å€¼ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚æ— è®ºæ˜¯æ™®é€šå˜é‡è¿˜æ˜¯<span class="keyword">volatile</span>å˜é‡éƒ½æ˜¯å¦‚æ­¤ï¼Œæ™®é€šå˜é‡ä¸<span class="keyword">volatile</span>å˜é‡çš„åŒºåˆ«æ˜¯<span class="keyword">volatile</span>çš„ç‰¹æ®Šè§„åˆ™ä¿è¯äº†æ–°å€¼èƒ½ç«‹å³åŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œä»¥åŠæ¯ä½¿ç”¨å‰ç«‹å³ä»å†…å­˜åˆ·æ–°ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥è¯´<span class="keyword">volatile</span>ä¿è¯äº†çº¿ç¨‹æ“ä½œæ—¶å˜é‡çš„å¯è§æ€§ï¼Œè€Œæ™®é€šå˜é‡åˆ™ä¸èƒ½ä¿è¯è¿™ä¸€ç‚¹ã€‚</div></pre></td></tr></table></figure><ul><li><strong>æœ‰åºæ€§(Ordering)</strong></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Javaå†…å­˜æ¨¡å‹ä¸­çš„ç¨‹åºå¤©ç„¶æœ‰åºæ€§å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥æ˜¯æŒ‡â€œçº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œè¯­ä¹‰â€ï¼ŒååŠå¥æ˜¯æŒ‡â€œæŒ‡ä»¤é‡æ’åºâ€ç°è±¡å’Œâ€œå·¥ä½œå†…å­˜ä¸»ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿâ€ç°è±¡ã€‚ï¼ˆæ¯”å¦‚ä¸Šè¿°å•ä¾‹æ¨¡å¼ä¸­å¯¹è±¡åˆå§‹åŒ–çš„é¡ºåºå¯¹å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ¥è®²å¯èƒ½ä¼šé”™åºï¼‰</div></pre></td></tr></table></figure><h3 id="volatileå’Œsynchronizedçš„åŒºåˆ«å’Œè”ç³»"><a href="#volatileå’Œsynchronizedçš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="volatileå’Œsynchronizedçš„åŒºåˆ«å’Œè”ç³»"></a>volatileå’Œsynchronizedçš„åŒºåˆ«å’Œè”ç³»</h3><p><a href="https://www.cnblogs.com/hapjin/p/5492880.html" target="_blank" rel="external">ç›¸å…³æ–‡ç« </a></p><p>ç”¨æ³•ä¸Šï¼š</p><ul><li>synchronizedå¾€å¾€ä½œç”¨äºæ–¹æ³•æˆ–ä»£ç å—</li><li>volatileå¾€å¾€ä¿®é¥°å˜é‡ã€‚</li></ul><p>å®ç°æœºåˆ¶ï¼š</p><ul><li>synchronizedæ˜¯åˆ©ç”¨é”å®ç°äº’æ–¥è®¿é—®ï¼Œå¤šçº¿ç¨‹è®¿é—®ä¼šé˜»å¡</li><li>Volatileæ²¡æœ‰åˆ©ç”¨é”ï¼Œè€Œæ˜¯åˆ©ç”¨å†…å­˜å…±äº«ï¼Œå¼ºåˆ¶çº¿ç¨‹æ¯æ¬¡ä»ä¸»å†…å­˜ä¸­è®²åˆ°å˜é‡ï¼Œè€Œä¸æ˜¯ä»çº¿ç¨‹çš„ç§æœ‰å†…å­˜ä¸­è¯»å–å˜é‡ï¼Œå¤šçº¿ç¨‹è®¿é—®ä¸å›é˜»å¡</li></ul><p>åŒºåˆ«ï¼š</p><ul><li>syncchronizedä¸ä»…ä¿è¯äº†å¯è§æ€§ï¼Œè¿˜ä¿è¯äº†åŸå­æ€§ï¼Œå› ä¸ºåªæœ‰è·å¾—é”å¯¹è±¡çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥åŒæ­¥ä»£ç å—ï¼Œä»è€Œä¿è¯åŒæ­¥ä»£ç å—çš„æ‰€æœ‰è¯­å¥å…¨éƒ¨éƒ½èƒ½æ‰§è¡Œã€‚å¤šä¸ªçº¿ç¨‹äº‰æŠ¢syncchronizedé”å¯¹è±¡çš„æ—¶å€™ï¼Œä¼šå‡ºç°é˜»å¡</li><li>volatileåªä¿è¯äº†å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä¸å¯ä¿è¯åŒæ­¥ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸ä¼šå‘ç”Ÿé˜»å¡</li></ul><ul><li>â€‹</li></ul><h3 id="volatileå…³é”®å­—çš„æ­£ç¡®ä½¿ç”¨ï¼ˆä¸€å¥è¯æ¦‚æ‹¬volatileï¼‰"><a href="#volatileå…³é”®å­—çš„æ­£ç¡®ä½¿ç”¨ï¼ˆä¸€å¥è¯æ¦‚æ‹¬volatileï¼‰" class="headerlink" title="volatileå…³é”®å­—çš„æ­£ç¡®ä½¿ç”¨ï¼ˆä¸€å¥è¯æ¦‚æ‹¬volatileï¼‰"></a>volatileå…³é”®å­—çš„æ­£ç¡®ä½¿ç”¨ï¼ˆä¸€å¥è¯æ¦‚æ‹¬volatileï¼‰</h3><p>ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹æŸä¸ªå˜é‡åï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦çŸ¥é“è¿™ä¸ªå˜é‡ä¿®æ”¹åçš„æœ€æ–°çš„å€¼ï¼Œæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨volatileï¼Œä¿è¯å¤šçº¿ç¨‹è®¿é—®çš„æ˜¯ä¸»å†…å­˜çš„å€¼ï¼Œè€Œä¸æ˜¯è®¿é—®å„è‡ªçº¿ç¨‹çš„å·¥ä½œå†…å­˜çš„å‰¯æœ¬å€¼ï¼ˆå…¶å®ä»ç„¶è®¿é—®çš„æ˜¯å‰¯æœ¬å€¼ï¼Œåªä¸è¿‡å‰¯æœ¬å€¼æœ‰ä¿®æ”¹åç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ï¼‰ä¹Ÿå°±æ˜¯è¯´ä¿è¯äº†çº¿ç¨‹çš„å¯è§æ€§ï¼Œä½†æ˜¯ä¸èƒ½åƒsyncchronizedä¿è¯åŸå­æ€§ï¼Œvolatileæ²¡æœ‰åˆ©ç”¨é”çš„æœºåˆ¶ï¼Œå¤šçº¿ç¨‹è®¿é—®æ—¶ä¸ä¼šå‘ç”Ÿé˜»å¡ï¼Œä¹Ÿå°±æ˜¯è¯´volatileä¿®é¥°çš„å˜é‡å¯ä»¥ä¿è¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä¿®æ”¹çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ç»§ç»­è®¿é—®ï¼Œä¸€æ—¦è¯¥å˜é‡ä¿®æ”¹å®Œæ¯•ï¼Œå…¶ä»–çº¿ç¨‹å†è·å–çš„ä¸€å®šæ˜¯ä¿®æ”¹åçš„æœ€æ–°çš„å€¼</p><h3 id="synchronizedåŒæ­¥çš„æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„"><a href="#synchronizedåŒæ­¥çš„æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„" class="headerlink" title="synchronizedåŒæ­¥çš„æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„"></a>synchronizedåŒæ­¥çš„æ­»é”æ˜¯æ€ä¹ˆäº§ç”Ÿçš„</h3><p>å¤šçº¿ç¨‹æ­»é”æ¡ˆä¾‹ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fp4eo3argaj30te14ab0o.jpg" alt="å¤šçº¿ç¨‹æ­»é”æ¡ˆä¾‹"></p><p>ä»€ä¹ˆæ˜¯æ­»é”ï¼š</p><p>å¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«é˜»å¡,å®ƒä»¬ä¸­çš„ä¸€ä¸ªæˆ–è€…å…¨éƒ¨éƒ½åœ¨ç­‰å¾…æŸä¸ªèµ„æºè¢«é‡Šæ”¾.ç”±äºçº¿ç¨‹è¢«æ— é™æœŸåœ°é˜»å¡,å› æ­¤ç¨‹åºä¸èƒ½æ­£å¸¸è¿è¡Œ</p><p><a href="https://www.cnblogs.com/chihirotan/p/6486436.html" target="_blank" rel="external">å¤šçº¿ç¨‹ç›¸å…³çŸ¥è¯†</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>çº¿ç¨‹å®‰å…¨çš„CopyOnWriteArrayList</title>
      <link href="/2017/02/16/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E7%9A%84CopyOnWriteArrayList/"/>
      <content type="html"><![CDATA[<p>æœ€è¿‘ç¿»é˜…EventBusæºç ï¼Œåœ¨subscribeæ–¹æ³•ä¸­ï¼Œçœ‹åˆ°äº†CopyOnWriteArrayListè¿™ä¸ªç±»ï¼Œä¸€æ—¶ç«Ÿä¸çŸ¥å…¶åŸç†æ˜¯ä»€ä¹ˆï¼Œæœ¬æ–‡ç®€è¦è®°å½•ä¸€ä¸‹CopyOnWriteArrayListçš„ç›¸å…³ä»‹ç»</p><a id="more"></a><h3 id="å…ˆçœ‹ä¸€æ®µEventBusçš„subscribeï¼ˆï¼‰çš„ä»£ç "><a href="#å…ˆçœ‹ä¸€æ®µEventBusçš„subscribeï¼ˆï¼‰çš„ä»£ç " class="headerlink" title="å…ˆçœ‹ä¸€æ®µEventBusçš„subscribeï¼ˆï¼‰çš„ä»£ç "></a>å…ˆçœ‹ä¸€æ®µEventBusçš„subscribeï¼ˆï¼‰çš„ä»£ç </h3><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/vj1ty.png" alt=""></p><p>è¿™æ®µä»£ç æ˜¯EventBusä¸­subscribeæ–¹æ³•ï¼Œé‡Œé¢æ¶‰åŠåˆ°äº†subscriptionsByEventTypeçš„éå†è¿‡ç¨‹ä¸­æŒ‰ç…§ä¼˜å…ˆçº§æ’åº</p><p>å…³äºEventBusçš„å…·ä½“æºç æˆ‘å°†åœ¨åé¢ä¼šæ•´ç†ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³æ³¨CopyOnWriteArrayListå³å¯</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨äº†<code>subscriptions.add(i,newSubscription)</code>æ¥æŒ‰ç…§ä¼˜å…ˆçº§è¿›è¡Œæ’åºï¼Œæˆ‘ç›¸ä¿¡ä»»ä½•ä¸€ä¸ªæ‡‚javaçš„éƒ½çŸ¥é“å¦‚æœä½¿ç”¨æ™®é€šArraylistï¼Œéƒ½ä¼šæŠ¥é”™ï¼ˆå¹¶å‘ä¿®æ”¹å¼‚å¸¸ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸‹é¢æ¥è¯å®ä¸€ä¸‹</p><h3 id="ä¸ä½¿ç”¨CopyOnWriteArrayList"><a href="#ä¸ä½¿ç”¨CopyOnWriteArrayList" class="headerlink" title="ä¸ä½¿ç”¨CopyOnWriteArrayList"></a>ä¸ä½¿ç”¨CopyOnWriteArrayList</h3><p>å…ˆå†™ä¸€æ®µä»£ç è¯æ˜<code>CopyOnWriteArrayList</code>ç¡®å®æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><blockquote><p>ReadThread.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;Integer&gt; list;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReadThread</span><span class="params">(List&lt;Integer&gt; list)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.list = list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (Integer ele : list) &#123;</div><div class="line">            System.out.println(<span class="string">"ReadThread:"</span>+ele);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>WriteThread.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WriteThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> List&lt;Integer&gt; list;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WriteThread</span><span class="params">(List&lt;Integer&gt; list)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.list = list;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.list.add(<span class="number">9</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>TestCopyOnWriteArrayList.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.CopyOnWriteArrayList;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCopyOnWriteArrayList</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//1ã€åˆå§‹åŒ–CopyOnWriteArrayList</span></div><div class="line">        List&lt;Integer&gt; tempList = Arrays.asList(<span class="keyword">new</span> Integer [] &#123;<span class="number">1</span>,<span class="number">2</span>&#125;);</div><div class="line">        CopyOnWriteArrayList&lt;Integer&gt; copyList = <span class="keyword">new</span> CopyOnWriteArrayList&lt;&gt;(tempList);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">//2ã€æ¨¡æ‹Ÿå¤šçº¿ç¨‹å¯¹listè¿›è¡Œè¯»å’Œå†™</span></div><div class="line">        ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">10</span>);</div><div class="line">        executorService.execute(<span class="keyword">new</span> ReadThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> WriteThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> WriteThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> WriteThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> ReadThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> WriteThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> ReadThread(copyList));</div><div class="line">        executorService.execute(<span class="keyword">new</span> WriteThread(copyList));</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"copyList size:"</span>+copyList.size());</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">new</span> TestCopyOnWriteArrayList().test();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæ²¡æœ‰æŠ¥å‡º</p><p>java.util.ConcurrentModificationException</p><p>è¯´æ˜äº†CopyOnWriteArrayListå¹¶å‘å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œä»ç„¶èƒ½å¾ˆå¥½çš„å·¥ä½œã€‚</p><h3 id="CopyOnWriteArrayListå¦‚ä½•åšåˆ°çº¿ç¨‹å®‰å…¨"><a href="#CopyOnWriteArrayListå¦‚ä½•åšåˆ°çº¿ç¨‹å®‰å…¨" class="headerlink" title="CopyOnWriteArrayListå¦‚ä½•åšåˆ°çº¿ç¨‹å®‰å…¨"></a>CopyOnWriteArrayListå¦‚ä½•åšåˆ°çº¿ç¨‹å®‰å…¨</h3><p><code>CopyOnWriteArrayList</code>ä½¿ç”¨äº†ä¸€ç§å«<strong>å†™æ—¶å¤åˆ¶</strong>çš„æ–¹æ³•ï¼Œå½“æœ‰æ–°å…ƒç´ æ·»åŠ åˆ°<code>CopyOnWriteArrayList</code>æ—¶ï¼Œå…ˆä»åŸæœ‰çš„æ•°ç»„ä¸­æ‹·è´ä¸€ä»½å‡ºæ¥ï¼Œç„¶ååœ¨æ–°çš„æ•°ç»„åšå†™æ“ä½œï¼Œå†™å®Œä¹‹åï¼Œå†å°†åŸæ¥çš„æ•°ç»„å¼•ç”¨æŒ‡å‘åˆ°æ–°æ•°ç»„ã€‚</p><p>å½“æœ‰æ–°å…ƒç´ åŠ å…¥çš„æ—¶å€™ï¼Œå¦‚ä¸‹å›¾ï¼Œåˆ›å»ºæ–°æ•°ç»„ï¼Œå¹¶å¾€æ–°æ•°ç»„ä¸­åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´ ,è¿™ä¸ªæ—¶å€™ï¼Œarrayè¿™ä¸ªå¼•ç”¨ä»ç„¶æ˜¯æŒ‡å‘åŸæ•°ç»„çš„ã€‚</p><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/7cbd4.png" alt=""></p><p>å½“å…ƒç´ åœ¨æ–°æ•°ç»„æ·»åŠ æˆåŠŸåï¼Œå°†arrayè¿™ä¸ªå¼•ç”¨æŒ‡å‘æ–°æ•°ç»„ã€‚</p><p><img src="http://fenganblogimgs.oss-cn-beijing.aliyuncs.com/blog/bmcdz.png" alt=""></p><h3 id="CopyOnWriteArrayListçš„æºç "><a href="#CopyOnWriteArrayListçš„æºç " class="headerlink" title="CopyOnWriteArrayListçš„æºç "></a>CopyOnWriteArrayListçš„æºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</div><div class="line">    <span class="comment">//1ã€å…ˆåŠ é”</span></div><div class="line">    <span class="keyword">final</span> ReentrantLock lock = <span class="keyword">this</span>.lock;</div><div class="line">    lock.lock();</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        Object[] elements = getArray();</div><div class="line">        <span class="keyword">int</span> len = elements.length;</div><div class="line">        <span class="comment">//2ã€æ‹·è´æ•°ç»„</span></div><div class="line">        Object[] newElements = Arrays.copyOf(elements, len + <span class="number">1</span>);</div><div class="line">        <span class="comment">//3ã€å°†å…ƒç´ åŠ å…¥åˆ°æ–°æ•°ç»„ä¸­</span></div><div class="line">        newElements[len] = e;</div><div class="line">        <span class="comment">//4ã€å°†arrayå¼•ç”¨æŒ‡å‘åˆ°æ–°æ•°ç»„</span></div><div class="line">        setArray(newElements);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">       <span class="comment">//5ã€è§£é”</span></div><div class="line">        lock.unlock();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç”±äºæ‰€æœ‰çš„å†™æ“ä½œéƒ½æ˜¯åœ¨æ–°æ•°ç»„è¿›è¡Œçš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæœ‰çº¿ç¨‹å¹¶å‘çš„å†™ï¼Œåˆ™é€šè¿‡é”æ¥æ§åˆ¶ï¼Œå¦‚æœæœ‰çº¿ç¨‹å¹¶å‘çš„è¯»ï¼Œåˆ™åˆ†å‡ ç§æƒ…å†µï¼š<br>1ã€å¦‚æœå†™æ“ä½œæœªå®Œæˆï¼Œé‚£ä¹ˆç›´æ¥è¯»å–åŸæ•°ç»„çš„æ•°æ®ï¼›<br>2ã€å¦‚æœå†™æ“ä½œå®Œæˆï¼Œä½†æ˜¯å¼•ç”¨è¿˜æœªæŒ‡å‘æ–°æ•°ç»„ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯è¯»å–åŸæ•°ç»„æ•°æ®ï¼›<br>3ã€å¦‚æœå†™æ“ä½œå®Œæˆï¼Œå¹¶ä¸”å¼•ç”¨å·²ç»æŒ‡å‘äº†æ–°çš„æ•°ç»„ï¼Œé‚£ä¹ˆç›´æ¥ä»æ–°æ•°ç»„ä¸­è¯»å–æ•°æ®ã€‚</p><p>å¯è§ï¼Œ<code>CopyOnWriteArrayList</code>çš„<strong>è¯»æ“ä½œ</strong>æ˜¯å¯ä»¥ä¸ç”¨<strong>åŠ é”</strong>çš„ã€‚</p><h3 id="CopyOnWriteArrayListä½¿ç”¨åœºæ™¯"><a href="#CopyOnWriteArrayListä½¿ç”¨åœºæ™¯" class="headerlink" title="CopyOnWriteArrayListä½¿ç”¨åœºæ™¯"></a>CopyOnWriteArrayListä½¿ç”¨åœºæ™¯</h3><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œ<code>CopyOnWriteArrayList</code> æœ‰å‡ ä¸ªç¼ºç‚¹ï¼š<br>1ã€ç”±äºå†™æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦æ‹·è´æ•°ç»„ï¼Œä¼šæ¶ˆè€—å†…å­˜ï¼Œå¦‚æœåŸæ•°ç»„çš„å†…å®¹æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´<code>young gc</code>æˆ–è€…<code>full gc</code></p><p>2ã€ä¸èƒ½ç”¨äº<strong>å®æ—¶è¯»</strong>çš„åœºæ™¯ï¼Œåƒæ‹·è´æ•°ç»„ã€æ–°å¢å…ƒç´ éƒ½éœ€è¦æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨ä¸€ä¸ª<code>set</code>æ“ä½œåï¼Œè¯»å–åˆ°æ•°æ®å¯èƒ½è¿˜æ˜¯æ—§çš„,è™½ç„¶<code>CopyOnWriteArrayList</code> èƒ½åšåˆ°<strong>æœ€ç»ˆä¸€è‡´æ€§</strong>,ä½†æ˜¯è¿˜æ˜¯æ²¡æ³•æ»¡è¶³å®æ—¶æ€§è¦æ±‚ï¼›</p><p><code>CopyOnWriteArrayList</code> åˆé€‚<strong>è¯»å¤šå†™å°‘</strong>çš„åœºæ™¯ï¼Œä¸è¿‡è¿™ç±»æ…ç”¨<br>å› ä¸ºè°ä¹Ÿæ²¡æ³•ä¿è¯<code>CopyOnWriteArrayList</code> åˆ°åº•è¦æ”¾ç½®å¤šå°‘æ•°æ®ï¼Œä¸‡ä¸€æ•°æ®ç¨å¾®æœ‰ç‚¹å¤šï¼Œæ¯æ¬¡add/setéƒ½è¦é‡æ–°å¤åˆ¶æ•°ç»„ï¼Œè¿™ä¸ªä»£ä»·å®åœ¨å¤ªé«˜æ˜‚äº†ã€‚åœ¨é«˜æ€§èƒ½çš„äº’è”ç½‘åº”ç”¨ä¸­ï¼Œè¿™ç§æ“ä½œåˆ†åˆ†é’Ÿå¼•èµ·æ•…éšœã€‚</p><h3 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h3><p>å¦‚ä¸Šé¢çš„åˆ†æCopyOnWriteArrayListè¡¨è¾¾çš„ä¸€äº›æ€æƒ³ï¼š<br>1ã€è¯»å†™åˆ†ç¦»ï¼Œè¯»å’Œå†™åˆ†å¼€<br>2ã€æœ€ç»ˆä¸€è‡´æ€§<br>3ã€ä½¿ç”¨å¦å¤–å¼€è¾Ÿç©ºé—´çš„æ€è·¯ï¼Œæ¥è§£å†³å¹¶å‘å†²çª</p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="http://blog.csdn.net/linsongbin1/article/details/54581787" target="_blank" rel="external">1</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>retrofitå’ŒåŠ¨æ€ä»£ç†</title>
      <link href="/2017/02/07/retrofit%E5%92%8C%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
      <content type="html"><![CDATA[<p>ä»£ç†ç±»åœ¨è¿è¡Œå‰ä¸å­˜åœ¨ï¼Œè¿è¡Œæ—¶ç”±ç¨‹åºåŠ¨æ€ç”Ÿæˆçš„ä»£ç†æ–¹å¼ç§°ä¸ºåŠ¨æ€ä»£ç†</p><a id="more"></a><h4 id="å…³äºRetrofit"><a href="#å…³äºRetrofit" class="headerlink" title="å…³äºRetrofit"></a>å…³äºRetrofit</h4><p>Squareå…¬å¸çš„OkHttpç®€ç›´æ˜¯å®Œç¾çš„ä¸€ä¸ªç½‘ç»œè¯·æ±‚åº“ï¼Œè€Œåœ¨å…¶ä¸Šåˆå°è£…äº†ä¸€å±‚çš„Retrofitåº“ï¼Œä½¿å…¶è°ƒç”¨Restful Apiæ›´æ–¹ä¾¿</p><h4 id="ç®€è¿°Retrofitè°ƒç”¨æµç¨‹"><a href="#ç®€è¿°Retrofitè°ƒç”¨æµç¨‹" class="headerlink" title="ç®€è¿°Retrofitè°ƒç”¨æµç¨‹"></a>ç®€è¿°Retrofitè°ƒç”¨æµç¨‹</h4><p>å› ä¸ºæœ¬ç¯‡åªæ˜¯ç®€è¿°åŠ¨æ€ä»£ç†åœ¨Retrofitçš„ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸è¿‡å¤šæ€»ç»“Retrofitçš„è¯¦ç»†ä½¿ç”¨ï¼Œåœ¨ä¸Šå®¶å…¬å¸çš„é¡¹ç›®éƒ½ç½‘ç»œå±‚ï¼Œç”¨çš„retrofitï¼Œç°åœ¨è¿™å®¶å…¬å¸çš„é¡¹ç›®å› ä¸ºåˆšå¼€å§‹æ˜¯æˆ‘ç‹¬ç«‹å¼€å‘ï¼Œæ‰€ä»¥ç½‘ç»œå±‚æ¡†æ¶æˆ‘ä¹Ÿæ˜¯ç”¨çš„Retrofitï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œè¯¦ç»†ä½¿ç”¨ï¼Œä»¥åå†æ€»ç»“</p><p>ç†Ÿæ‚‰Retrofitä½¿ç”¨çš„éƒ½å¯¹ä¸‹é¢å‡ ä¸ªæ­¥éª¤æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼š</p><ul><li>å®šä¹‰ä¸€ä¸ªApiServiceæ¥å£ï¼Œé€šè¿‡æ³¨è§£å¯ä»¥æ ‡è®°è¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚å‚æ•°ï¼Œä»¥åŠæ·»åŠ çš„å¤´ä¿¡æ¯</li><li>ç„¶ååˆ›å»ºRetrofitå¯¹è±¡ï¼Œé€šè¿‡å»ºé€ è€…æ¨¡å¼è®¾ç½®BaseUrlç­‰ä¸€äº›å‚æ•°ï¼Œé€šè¿‡Retrofitå¯¹è±¡createä¸€ä¸ªä½ å®šä¹‰çš„æ¥å£å¯¹è±¡</li><li>æ‹¿åˆ°æ¥å£å¯¹è±¡è°ƒç”¨å…·ä½“çš„æ–¹æ³•å®Œæˆè¯·æ±‚</li></ul><p>å…·ä½“çš„ä»£ç å¤§æ¦‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApiService</span> </span>&#123;</div><div class="line">  <span class="meta">@GET</span>(<span class="string">"users/&#123;user&#125;/repos"</span>)</div><div class="line">  Call&lt;List&lt;Repo&gt;&gt; listRepos(<span class="meta">@Path</span>(<span class="string">"user"</span>) String user);</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder()</div><div class="line">    .baseUrl(<span class="string">"https://api.github.com"</span>)</div><div class="line">    .build();</div><div class="line">ApiService service = retrofit.create(ApiService.class);</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Call&lt;List&lt;Repo&gt;&gt; repos = service.listRepos(<span class="string">"fengan"</span>);</div></pre></td></tr></table></figure><h4 id="ApiServiceæ˜¯å¦‚ä½•äº§ç”Ÿçš„"><a href="#ApiServiceæ˜¯å¦‚ä½•äº§ç”Ÿçš„" class="headerlink" title="ApiServiceæ˜¯å¦‚ä½•äº§ç”Ÿçš„"></a>ApiServiceæ˜¯å¦‚ä½•äº§ç”Ÿçš„</h4><p>å› ä¸ºæ¥å£æ˜¯ä¸å¯ä»¥ç›´æ¥newå‡ºæ¥çš„ï¼Œé‚£ä¹ˆApiServiceæ˜¯å¦‚ä½•äº§ç”Ÿçš„å‘¢ï¼Ÿ</p><p>ApiService service = retrofit.create(ApiService.class);æ–¹æ³•å†…éƒ¨åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</p><p>æ²¡é”™ï¼Œå°±æ˜¯åŠ¨æ€ä»£ç†</p><p>ä¸ºäº†æ›´å¥½çš„ç†è§£åŠ¨æ€ä»£ç†ï¼Œä¸‹é¢è¿‡ä¸€ä¸‹ç®€æ˜“ç‰ˆçš„Retrofitï¼Œ</p><figure class="highlight plain"><figcaption><span>a v</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public interface Callback&lt;T&gt; &#123;</div><div class="line"></div><div class="line">    void onSuccess(Object t);</div><div class="line"></div><div class="line">    void onFailed(Exception e);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">/**</span></div><div class="line">     * çº¦å®šæœ€åä¸€ä¸ªå‚æ•°æ˜¯callback</div><div class="line">     */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GithubService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@GET</span>(<span class="string">"users/&#123;user&#125;/repos"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">void</span> list&lt;Repos&gt;(<span class="meta">@Path</span>(<span class="string">"user"</span>) String user,Callback&lt;List&lt;Repo&gt;&gt; callback);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ç”¨åˆ°äº†ä¸¤ä¸ªæ³¨è§£ï¼Œä¸€ä¸ªæ˜¯æ–¹æ³•æ³¨è§£ï¼Œä¸€ä¸ªæ˜¯å‚æ•°æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line"></div><div class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> GET &#123;</div><div class="line"></div><div class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class="line"></div><div class="line"><span class="meta">@Target</span>(ElementType.PARAMETER)</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Path &#123;</div><div class="line"></div><div class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Repoå®ä½“ç±»æ˜¯ä½¿ç”¨GsonFormatæ ¹æ®jsonè‡ªåŠ¨ç”Ÿæˆçš„ã€‚ç°å®ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬åœ¨æ„å»ºRetrofitè¿‡ç¨‹ä¼ å…¥GsonFactory</p><p>Retrofitè¿™ä¸ªç±»åº”è¯¥æ˜¯ä¸€ä¸ªbuilderæ¨¡å¼ï¼Œé‡Œé¢å¯ä»¥è®¾ç½®baseUrlï¼Œå§‘ä¸”å¿½ç•¥å…¶ä»–æ‰€æœ‰å‚æ•°ã€‚è¿˜æœ‰ä¸€ä¸ªcreateæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Retrofit</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String baseUrl;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Retrofit</span><span class="params">(Builder builder)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.baseUrl = builder.baseUrl;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">create</span><span class="params">(Class&lt;T&gt; clazz)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> String baseUrl;</div><div class="line">        <span class="function">Builder <span class="title">baseUrl</span><span class="params">(String host)</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.baseUrl = host;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function">Retrofit <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Retrofit(<span class="keyword">this</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æœ€å…³é”®çš„å°±æ˜¯createè¿™ä¸ªæ–¹æ³•äº†ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">create</span><span class="params">(Class&lt;T&gt; clazz)</span> </span>&#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line">         * ç¼“å­˜ä¸­å»</div><div class="line">         */</div><div class="line">        Object o = serviceMap.get(clazz);</div><div class="line">        <span class="comment">/**</span></div><div class="line">         * å–ä¸åˆ°åˆ™å–æ„é€ ä»£ç†å¯¹è±¡</div><div class="line">         */</div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;</div><div class="line">            o = (T) Proxy.newProxyInstance(Retrofit.class.getClassLoader(), <span class="keyword">new</span> Class[]&#123;clazz&#125;, <span class="keyword">new</span> InvocationHandler() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">                    <span class="keyword">final</span> Callback&lt;?&gt; callback = (Callback&lt;?&gt;) args[args.length - <span class="number">1</span>];</div><div class="line"></div><div class="line"></div><div class="line">                    <span class="keyword">final</span> GET get = method.getAnnotation(GET.class);</div><div class="line">                    <span class="keyword">if</span> (get != <span class="keyword">null</span>) &#123;</div><div class="line">                        <span class="comment">/**</span></div><div class="line">                         * è·å¾—GETæ³¨è§£çš„å€¼</div><div class="line">                         */</div><div class="line">                        String getValue = get.value();</div><div class="line"></div><div class="line">                        System.out.println(getValue);</div><div class="line"></div><div class="line">                        <span class="comment">/**</span></div><div class="line">                         * è·å¾—æ‰€æœ‰å‚æ•°ä¸Šçš„æ³¨è§£</div><div class="line">                         */</div><div class="line">                        Annotation[][] methodParameterAnnotationArrays = method.getParameterAnnotations();</div><div class="line"></div><div class="line">                        <span class="keyword">if</span> (methodParameterAnnotationArrays != <span class="keyword">null</span>) &#123;</div><div class="line">                            <span class="keyword">int</span> count = methodParameterAnnotationArrays.length;</div><div class="line">                            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</div><div class="line">                                <span class="comment">/**</span></div><div class="line">                                 * è·å¾—å•ä¸ªå‚æ•°ä¸Šçš„æ³¨è§£</div><div class="line">                                 */</div><div class="line">                                Annotation[] methodParameterAnnotations = methodParameterAnnotationArrays[i];</div><div class="line"></div><div class="line">                                <span class="keyword">if</span> (methodParameterAnnotations != <span class="keyword">null</span>) &#123;</div><div class="line">                                    <span class="keyword">for</span> (Annotation methodParameterAnnotation : methodParameterAnnotations) &#123;</div><div class="line"></div><div class="line">                                        <span class="comment">/**</span></div><div class="line">                                         * å¦‚æœæ˜¯Pathæ³¨è§£</div><div class="line">                                         */</div><div class="line">                                        <span class="keyword">if</span> (methodParameterAnnotation <span class="keyword">instanceof</span> Path) &#123;</div><div class="line"></div><div class="line">                                            <span class="comment">/**</span></div><div class="line">                                             * å–å¾—pathæ³¨è§£ä¸Šçš„å€¼</div><div class="line">                                             */</div><div class="line">                                            Path path = (Path) methodParameterAnnotation;</div><div class="line">                                            String pathValue = path.value();</div><div class="line">                                            System.out.println(pathValue);</div><div class="line"></div><div class="line">                                            <span class="comment">/**</span></div><div class="line">                                             * è¿™æ˜¯å¯¹åº”çš„å‚æ•°çš„å€¼</div><div class="line">                                             */</div><div class="line">                                            System.out.println(args[i]);</div><div class="line"></div><div class="line"></div><div class="line">                                            Request.Builder builder = <span class="keyword">new</span> Request.Builder();</div><div class="line"></div><div class="line"></div><div class="line">                                            <span class="comment">/**</span></div><div class="line">                                             * ä½¿ç”¨pathæ³¨è§£æ›¿æ¢getæ³¨è§£ä¸­çš„å€¼ä¸ºå‚æ•°å€¼</div><div class="line">                                             */</div><div class="line">                                            String result = getValue.replaceAll(<span class="string">"\\&#123;"</span> + pathValue + <span class="string">"\\&#125;"</span>, (String) args[i]);</div><div class="line"></div><div class="line">                                            System.out.println(result);</div><div class="line"></div><div class="line">                                            <span class="comment">/**</span></div><div class="line">                                             * å¼€å§‹æ„é€ è¯·æ±‚</div><div class="line">                                             */</div><div class="line">                                            Request request = builder.get()</div><div class="line">                                                    .url(baseUrl + <span class="string">"/"</span> + result)</div><div class="line">                                                    .build();</div><div class="line"></div><div class="line">                                            okHttpClient.newCall(request).enqueue(<span class="keyword">new</span> okhttp3.Callback() &#123;</div><div class="line">                                                <span class="meta">@Override</span></div><div class="line">                                                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call call, IOException e)</span> </span>&#123;</div><div class="line">                                                    <span class="comment">/**</span></div><div class="line">                                                     * å¤±è´¥åˆ™å›è°ƒå¤±è´¥çš„æ–¹æ³•</div><div class="line">                                                     */</div><div class="line">                                                    callback.onFailed(e);</div><div class="line">                                                &#125;</div><div class="line"></div><div class="line">                                                <span class="meta">@Override</span></div><div class="line">                                                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call call, Response response)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">                                                    <span class="keyword">if</span> (response.isSuccessful()) &#123;</div><div class="line">                                                        <span class="comment">/**</span></div><div class="line">                                                         * è¯·æ±‚æˆåŠŸ</div><div class="line">                                                         */</div><div class="line">                                                        String body = response.body().string();</div><div class="line"></div><div class="line">                                                        <span class="comment">/**</span></div><div class="line">                                                         * ä½¿ç”¨fastjsonè¿›è¡Œzhuanè½¬æ¢</div><div class="line">                                                         */</div><div class="line">                                                        Type type = callback.getClass().getGenericInterfaces()[<span class="number">0</span>];</div><div class="line"></div><div class="line">                                                        Object o1 = JSON.parse(body);</div><div class="line"></div><div class="line">                                                        <span class="comment">/**</span></div><div class="line">                                                         * å›è°ƒæˆåŠŸ</div><div class="line">                                                         */</div><div class="line">                                                        callback.onSuccess(o1);</div><div class="line">                                                    &#125;</div><div class="line">                                                &#125;</div><div class="line">                                            &#125;);</div><div class="line"></div><div class="line">                                        &#125;</div><div class="line">                                    &#125;</div><div class="line">                                &#125;</div><div class="line"></div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line"></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            <span class="comment">/**</span></div><div class="line">             * æ‰”åˆ°ç¼“å­˜ä¸­</div><div class="line">             */</div><div class="line">            serviceMap.put(clazz, o);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (T) o;</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®Retrofité‚£æ ·è¿›è¡Œè°ƒç”¨äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder()</div><div class="line">        .baseUrl(<span class="string">"https://api.github.com"</span>)</div><div class="line">        .build();</div><div class="line"></div><div class="line">GithubService githubService = retrofit.create(GithubService.class);</div><div class="line"></div><div class="line">githubService.listRepos(<span class="string">"lizhangqu"</span>, <span class="keyword">new</span> Callback&lt;List&lt;Repo&gt;&gt;() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(Object t)</span> </span>&#123;</div><div class="line">        System.out.println(t);</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(Exception e)</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><h4 id="retrofitåŠ¨æ€ä»£ç†åŸç†"><a href="#retrofitåŠ¨æ€ä»£ç†åŸç†" class="headerlink" title="retrofitåŠ¨æ€ä»£ç†åŸç†"></a>retrofitåŠ¨æ€ä»£ç†åŸç†</h4><p>åŸç†å°±æ˜¯å…ˆæ‹¿åˆ°æœ€åä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å›è°ƒï¼Œå†æ‹¿åˆ°æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼Œè·å¾—å…·ä½“çš„å€¼ï¼Œç„¶åæ‹¿åˆ°é™¤äº†å›è°ƒä¹‹å¤–çš„å…¶ä»–å‚æ•°ï¼Œè·å¾—å‚æ•°ä¸Šçš„æ³¨è§£ï¼Œç„¶åæ ¹æ®æ³¨è§£å–å¾—å¯¹åº”çš„å€¼ï¼Œè¿˜æœ‰åŸæ¥çš„å‚æ•°å€¼ï¼Œå°†æ–¹æ³•ä¸Šçš„æ³¨è§£çš„å€¼ä¸­è¿›è¡Œæ›¿æ¢ã€‚ä½¿ç”¨OkHttpæ„é€ è¯·æ±‚ï¼Œè¯·æ±‚å®Œæˆåæ ¹æ®å°†ç»“æœè§£æä¸ºå›è°ƒä¸­çš„ç±»å‹ã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹</p><p>æ‹¦æˆªåˆ°æ–¹æ³•ã€å‚æ•°ï¼Œå†æ ¹æ®æˆ‘ä»¬åœ¨æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼Œå»æ‹¼æ¥ä¸ºä¸€ä¸ªæ­£å¸¸çš„Okhttpè¯·æ±‚ï¼Œç„¶åæ‰§è¡Œã€‚</p><h4 id="javaä¸­çš„åŠ¨æ€ä»£ç†"><a href="#javaä¸­çš„åŠ¨æ€ä»£ç†" class="headerlink" title="javaä¸­çš„åŠ¨æ€ä»£ç†"></a>javaä¸­çš„åŠ¨æ€ä»£ç†</h4><p>åœ¨javaçš„åŠ¨æ€ä»£ç†æœºåˆ¶ä¸­ï¼Œæœ‰ä¸¤ä¸ªé‡è¦çš„ç±»æˆ–æ¥å£ï¼Œä¸€ä¸ªæ˜¯ InvocationHandler(Interface)ã€å¦ä¸€ä¸ªåˆ™æ˜¯ Proxy(Class)ï¼Œè¿™ä¸€ä¸ªç±»å’Œæ¥å£æ˜¯å®ç°æˆ‘ä»¬åŠ¨æ€ä»£ç†æ‰€å¿…é¡»ç”¨åˆ°çš„</p><p>æ¯ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»éƒ½å¿…é¡»è¦å®ç°InvocationHandlerè¿™ä¸ªæ¥å£ï¼Œå¹¶ä¸”æ¯ä¸ªä»£ç†ç±»çš„å®ä¾‹éƒ½å…³è”åˆ°äº†ä¸€ä¸ªhandlerï¼Œå½“æˆ‘ä»¬é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨å°±ä¼šè¢«è½¬å‘ä¸ºç”±InvocationHandlerè¿™ä¸ªæ¥å£çš„ invoke æ–¹æ³•æ¥è¿›è¡Œè°ƒç”¨ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹InvocationHandlerè¿™ä¸ªæ¥å£çš„å”¯ä¸€ä¸€ä¸ªæ–¹æ³• invoke æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function">Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable</span></div><div class="line"></div><div class="line">proxy:ã€€ã€€æŒ‡ä»£æˆ‘ä»¬æ‰€ä»£ç†çš„é‚£ä¸ªçœŸå®å¯¹è±¡</div><div class="line">method:ã€€ã€€æŒ‡ä»£çš„æ˜¯æˆ‘ä»¬æ‰€è¦è°ƒç”¨çœŸå®å¯¹è±¡çš„æŸä¸ªæ–¹æ³•çš„Methodå¯¹è±¡</div><div class="line">args:ã€€ã€€æŒ‡ä»£çš„æ˜¯è°ƒç”¨çœŸå®å¯¹è±¡æŸä¸ªæ–¹æ³•æ—¶æ¥å—çš„å‚æ•°</div></pre></td></tr></table></figure><p>Proxyè¿™ä¸ªç±»çš„ä½œç”¨å°±æ˜¯ç”¨æ¥åŠ¨æ€åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡çš„ç±»ï¼Œå®ƒæä¾›äº†è®¸å¤šçš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨çš„æœ€å¤šçš„å°±æ˜¯ newProxyInstance è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces,  InvocationHandler h)</span>  <span class="keyword">throws</span> IllegalArgumentException</span></div></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å¾—åˆ°ä¸€ä¸ªåŠ¨æ€çš„ä»£ç†å¯¹è±¡ï¼Œå…¶æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸‰ä¸ªå‚æ•°æ‰€ä»£è¡¨çš„å«ä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span> <span class="keyword">throws</span> IllegalArgumentException</span></div><div class="line"></div><div class="line">loader:ã€€ã€€ä¸€ä¸ªClassLoaderå¯¹è±¡ï¼Œå®šä¹‰äº†ç”±å“ªä¸ªClassLoaderå¯¹è±¡æ¥å¯¹ç”Ÿæˆçš„ä»£ç†å¯¹è±¡è¿›è¡ŒåŠ è½½</div><div class="line"></div><div class="line">interfaces:ã€€ã€€ä¸€ä¸ªInterfaceå¯¹è±¡çš„æ•°ç»„ï¼Œè¡¨ç¤ºçš„æ˜¯æˆ‘å°†è¦ç»™æˆ‘éœ€è¦ä»£ç†çš„å¯¹è±¡æä¾›ä¸€ç»„ä»€ä¹ˆæ¥å£ï¼Œå¦‚æœæˆ‘æä¾›äº†ä¸€ç»„æ¥å£ç»™å®ƒï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†å¯¹è±¡å°±å®£ç§°å®ç°äº†è¯¥æ¥å£<span class="params">(å¤šæ€)</span>ï¼Œè¿™æ ·æˆ‘å°±èƒ½è°ƒç”¨è¿™ç»„æ¥å£ä¸­çš„æ–¹æ³•äº†</div><div class="line"></div><div class="line">h:ã€€ã€€ä¸€ä¸ªInvocationHandlerå¯¹è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯å½“æˆ‘è¿™ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå…³è”åˆ°å“ªä¸€ä¸ªInvocationHandlerå¯¹è±¡ä¸Š</div></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹ï¼š</p><ul><li>å®šä¹‰è¢«ä»£ç†å¯¹è±¡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">(String str)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span></span></div><div class="line">&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        System.out.println(<span class="string">"I want to rent my house"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">(String str)</span></span></div><div class="line">    &#123;</div><div class="line">        System.out.println(<span class="string">"hello: "</span> + str);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>å®šä¹‰åŠ¨æ€ä»£ç†ç±»ï¼Œä»»ä½•åŠ¨æ€ä»£ç†ç±»éƒ½å¿…é¡»å®ç°InvotionHandlerè¿™ä¸ªæ¥å£ï¼Œé‡å†™invokeæ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxy</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//ã€€è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡</span></div><div class="line">    <span class="keyword">private</span> Object subject;</div><div class="line">    </div><div class="line">    <span class="comment">//    æ„é€ æ–¹æ³•ï¼Œç»™æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡èµ‹åˆå€¼</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DynamicProxy</span><span class="params">(Object subject)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">this</span>.subject = subject;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object object, Method method, Object[] args)</span></span></div><div class="line">            <span class="keyword">throws</span> Throwable</div><div class="line">    &#123;</div><div class="line">        <span class="comment">//ã€€ã€€åœ¨ä»£ç†çœŸå®å¯¹è±¡å‰æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº›è‡ªå·±çš„æ“ä½œ</span></div><div class="line">        System.out.println(<span class="string">"before rent house"</span>);</div><div class="line">        </div><div class="line">        System.out.println(<span class="string">"Method:"</span> + method);</div><div class="line">        </div><div class="line">        <span class="comment">//    å½“ä»£ç†å¯¹è±¡è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œå…¶ä¼šè‡ªåŠ¨çš„è·³è½¬åˆ°ä»£ç†å¯¹è±¡å…³è”çš„handlerå¯¹è±¡çš„invokeæ–¹æ³•æ¥è¿›è¡Œè°ƒç”¨</span></div><div class="line">        method.invoke(subject, args);</div><div class="line">        </div><div class="line">        <span class="comment">//ã€€ã€€åœ¨ä»£ç†çœŸå®å¯¹è±¡åæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ ä¸€äº›è‡ªå·±çš„æ“ä½œ</span></div><div class="line">        System.out.println(<span class="string">"after rent house"</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>ä½¿ç”¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">//    æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡</span></div><div class="line">        Subject realSubject = <span class="keyword">new</span> RealSubject();</div><div class="line"></div><div class="line">        <span class="comment">//    æˆ‘ä»¬è¦ä»£ç†å“ªä¸ªçœŸå®å¯¹è±¡ï¼Œå°±å°†è¯¥å¯¹è±¡ä¼ è¿›å»ï¼Œæœ€åæ˜¯é€šè¿‡è¯¥çœŸå®å¯¹è±¡æ¥è°ƒç”¨å…¶æ–¹æ³•çš„</span></div><div class="line">        InvocationHandler handler = <span class="keyword">new</span> DynamicProxy(realSubject);</div><div class="line"></div><div class="line">        <span class="comment">/*</span></div><div class="line">         * é€šè¿‡Proxyçš„newProxyInstanceæ–¹æ³•æ¥åˆ›å»ºæˆ‘ä»¬çš„ä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸‰ä¸ªå‚æ•°</div><div class="line">         * ç¬¬ä¸€ä¸ªå‚æ•° handler.getClass().getClassLoader() ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨handlerè¿™ä¸ªç±»çš„ClassLoaderå¯¹è±¡æ¥åŠ è½½æˆ‘ä»¬çš„ä»£ç†å¯¹è±¡</div><div class="line">         * ç¬¬äºŒä¸ªå‚æ•°realSubject.getClass().getInterfaces()ï¼Œæˆ‘ä»¬è¿™é‡Œä¸ºä»£ç†å¯¹è±¡æä¾›çš„æ¥å£æ˜¯çœŸå®å¯¹è±¡æ‰€å®è¡Œçš„æ¥å£ï¼Œè¡¨ç¤ºæˆ‘è¦ä»£ç†çš„æ˜¯è¯¥çœŸå®å¯¹è±¡ï¼Œè¿™æ ·æˆ‘å°±èƒ½è°ƒç”¨è¿™ç»„æ¥å£ä¸­çš„æ–¹æ³•äº†</div><div class="line">         * ç¬¬ä¸‰ä¸ªå‚æ•°handlerï¼Œ æˆ‘ä»¬è¿™é‡Œå°†è¿™ä¸ªä»£ç†å¯¹è±¡å…³è”åˆ°äº†ä¸Šæ–¹çš„ InvocationHandler è¿™ä¸ªå¯¹è±¡ä¸Š</div><div class="line">         */</div><div class="line">        Subject subject = (Subject)Proxy.newProxyInstance(handler.getClass().getClassLoader(), realSubject</div><div class="line">                .getClass().getInterfaces(), handler);</div><div class="line">        </div><div class="line">        System.out.println(subject.getClass().getName());</div><div class="line">        subject.rent();</div><div class="line">        subject.hello(<span class="string">"world"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>äº‹ä»¶åˆ†å‘å°ç»“</title>
      <link href="/2017/01/20/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91%E5%B0%8F%E7%BB%93/"/>
      <content type="html"><![CDATA[<p>Androidå¼€å‘ä¸­ï¼Œäº‹ä»¶åˆ†å‘æ˜¯éå¸¸é‡è¦çš„ï¼Œäº†è§£ç†Ÿæ‚‰æ•´ä¸ªäº‹ä»¶åˆ†å‘è¿‡ç¨‹æœ‰åŠ©äºæ›´å¥½çš„åˆ†æå„ç§ç‚¹å‡»æ»‘åŠ¨å¤±æ•ˆé—®é¢˜,ä¹Ÿæ˜¯ä¸€ä¸ªå®‰å“å¼€å‘å¿…ä¼šçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æ—¶é—´é•¿äº†ï¼Œå¯¹æ•´ä¸ªæµç¨‹å¤šå°‘ä¼šæœ‰äº›æ¨¡ç³Šï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹</p><a id="more"></a><p>ç½‘ä¸Šçœ‹åˆ°ä¸€å¼ å›¾ï¼Œå¯ä»¥å¾ˆè¯¦ç»†çš„æè¿°æ•´ä¸ªäº‹ä»¶åˆ†å‘çš„è¿‡ç¨‹</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fo6s6mz1gzj30ot0gy42p.jpg" alt="äº‹ä»¶åˆ†å‘æµç¨‹å›¾"></p><p><a href="https://www.jianshu.com/p/e99b5e8bd67b" target="_blank" rel="external">åŸæ–‡çš„é“¾æ¥</a></p><ul><li>é—®é¢˜ä¸€ï¼š</li></ul><p>å½“ViewGroupé‡å†™çš„onInterceptTouchEventï¼Œå¹¶ä¸”å§‹ç»ˆè¿”å›äº†trueï¼Œé‚£ä¹ˆå­viewå°±æ°¸è¿œæ— æ³•æ¥å—åˆ°äº†äº‹ä»¶</p><p>ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½ä¼šæœ‰è¿™ç§éœ€æ±‚ï¼Œåœ¨æŒ‰ä¸‹ï¼ˆACTION_DOWNï¼‰çš„æ—¶å€™ï¼Œéœ€è¦å­viewè¿›è¡Œæ—¶é—´åé¦ˆï¼Œä½†åœ¨æ»‘åŠ¨ï¼ˆACTION_MOVEï¼‰æˆ–è€…æŠ¬èµ·ï¼ˆACTION_UPï¼‰çš„æ—¶å€™éœ€è¦çˆ¶å¸ƒå±€è¿›è¡Œæ‹¦æˆªæ“ä½œï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<strong>requestDisallInterceptRouchEvent(boolean disallowIntercept)</strong>ï¼Œè¯¥æ–¹æ³•åœ¨<strong>å­viewä¸­è°ƒç”¨</strong>ï¼Œ<strong>getParent().requestDisallInterceptRouchEvent(true)</strong>è¯·æ±‚çˆ¶å¸ƒå±€ç¦ç”¨æ‹¦æˆªäº‹ä»¶åŠŸèƒ½</p><p><a href="http://blog.csdn.net/qq_34795285/article/details/61200211" target="_blank" rel="external">ç›¸å…³èµ„æ–™</a></p><p>å…·ä½“ä¾‹å­ï¼Œåœ¨æˆ‘åšçš„é¡¹ç›®ä¸­ï¼Œåœ¨viewpagerä¸­çš„æ¯ä¸€é¡µfragmentä¸­éƒ½æŠ˜çº¿å›¾ï¼Œviewpageræ˜¯å¯ä»¥å·¦å³åˆ‡æ¢çš„ï¼Œæ¯ä¸€é¡µçš„fragmentä¸­çš„æŠ˜çº¿å›¾ä¹Ÿæ˜¯å¯ä»¥æ‰‹åŠ¿ç¼©æ”¾çš„ï¼Œæ‰€ä»¥è¿™å°±å’Œviewpageræ»‘åŠ¨æœ‰å†²çªï¼Œåˆ©ç”¨requestDisallInterceptRouchEventï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æŠ˜çº¿å›¾æ§ä»¶ç»§æ‰¿é¡¹ç›®ä¸­ä½¿ç”¨çš„ï¼ˆé¡¹ç›®ä¸­ä½¿ç”¨çš„mpandroidï¼‰ï¼Œé‡å†™onTouchEventï¼Œå½“æ°´å¹³æ»‘åŠ¨çš„æ—¶å€™ï¼ŒgetParent().requestDisallInterceptRouchEvent(true)ï¼Œè¯·æ±‚çˆ¶å¸ƒå±€ä¸æ‹¦æˆªäº‹ä»¶ï¼Œäº¤ç»™å­viewå¤„ç†ã€‚</p><p>ç›¸å…³æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.nongfaziran.workiot.view;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.annotation.SuppressLint;</div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.graphics.PointF;</div><div class="line"><span class="keyword">import</span> android.util.AttributeSet;</div><div class="line"><span class="keyword">import</span> android.view.MotionEvent;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.github.mikephil.charting.charts.LineChart;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fengan on 2018/2/3.</div><div class="line"> * email:fengan1102@gmail.com</div><div class="line"> * è§£å†³æŠ˜çº¿å›¾åœ¨viewpageræ»‘åŠ¨å†²çª</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LineChartInViewPager</span> <span class="keyword">extends</span> <span class="title">LineChart</span> </span>&#123;</div><div class="line"></div><div class="line">    PointF downPoint = <span class="keyword">new</span> PointF();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LineChartInViewPager</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LineChartInViewPager</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LineChartInViewPager</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"ClickableViewAccessibility"</span>)</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent evt)</span> </span>&#123;</div><div class="line">        <span class="keyword">switch</span> (evt.getAction()) &#123;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">                downPoint.x = evt.getX();</div><div class="line">                downPoint.y = evt.getY();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">                <span class="keyword">if</span> (getScaleX() &gt; <span class="number">1</span> &amp;&amp; Math.abs(evt.getX() - downPoint.x) &gt; <span class="number">5</span>) &#123;</div><div class="line">                    getParent().requestDisallowInterceptTouchEvent(<span class="keyword">true</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onTouchEvent(evt);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æœªå®Œå¾…ç»­</p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è°ˆè°ˆçº¿ç¨‹æ± </title>
      <link href="/2016/12/25/%E8%B0%88%E8%B0%88%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
      <content type="html"><![CDATA[<p>çº¿ç¨‹æ± æœ‰å…³çŸ¥è¯†æ•´ç†</p><a id="more"></a><h4 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h4><p>çº¿ç¨‹åŸºæœ¬æ¦‚å¿µï¼Œ<a href="http://blog.csdn.net/cswhale/article/details/39053857" target="_blank" rel="external">çº¿ç¨‹åŸºæœ¬æ¦‚å¿µ</a>å’Œ<a href="https://www.cnblogs.com/propheterLiu/p/6082666.html" target="_blank" rel="external">Androidå¯åŠ¨çº¿ç¨‹çš„ä¸‰ç§æ–¹å¼</a>(ç‚¹å‡»æŸ¥çœ‹)</p><h4 id="new-Threadï¼ˆï¼‰çš„å¼Šç«¯"><a href="#new-Threadï¼ˆï¼‰çš„å¼Šç«¯" class="headerlink" title="new Threadï¼ˆï¼‰çš„å¼Šç«¯"></a>new Threadï¼ˆï¼‰çš„å¼Šç«¯</h4><ul><li>æ€»æ˜¯new Threadï¼ˆï¼‰å¼€å¯çº¿ç¨‹ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œä¼šè¢«å›æ”¶ï¼Œå¯¼è‡´é¢‘ç¹çš„<a href="https://www.jianshu.com/p/5db05db4f5ab" target="_blank" rel="external">GC</a></li><li>å¤šçº¿ç¨‹ç¼ºä¹ç»Ÿä¸€ç®¡ç†ï¼Œå„çº¿ç¨‹ä¹‹é—´äº’ç›¸ç«äº‰</li><li>æ— æ³•å®ç°åœæ­¢çº¿ç¨‹ï¼ˆå¦‚æœä¸€ä¸ªitemæ»‘å‡ºé¡µé¢ï¼Œåˆ™è¦åœæ­¢è¯¥itemä¸Šå›¾ç‰‡çš„åŠ è½½ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹ï¼Œåˆ™æ— æ³•å®ç°çº¿ç¨‹åœæ­¢æ‰§è¡Œï¼‰</li></ul><h4 id="ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"><a href="#ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" class="headerlink" title="ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"></a>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</h4><ul><li>æé«˜çº¿ç¨‹çš„å¤ç”¨æ€§ï¼Œé¿å…é¢‘ç¹åˆ›å»ºçº¿ç¨‹è¿›è€Œå¯¼è‡´é¢‘ç¹çš„GC</li><li>æ§åˆ¶çº¿ç¨‹å¹¶å‘æ•°ï¼Œåˆç†åˆ©ç”¨èµ„æº</li><li>çº¿ç¨‹å¯æ§æ€§ï¼Œæ¯”å¦‚å¯ä»¥å®šæ—¶æ‰§è¡Œå’Œå–æ¶ˆæ‰§è¡ŒæŸä¸ªçº¿ç¨‹çš„ä»»åŠ¡</li></ul><h4 id="çº¿ç¨‹æ± çš„å®ç°"><a href="#çº¿ç¨‹æ± çš„å®ç°" class="headerlink" title="çº¿ç¨‹æ± çš„å®ç°"></a>çº¿ç¨‹æ± çš„å®ç°</h4><ul><li>Androidä¸­çš„çº¿ç¨‹æ± å…¶å®æºäºJavaï¼ŒAndroidå¼€å‘ä¸­çº¿ç¨‹æ± çš„ä½¿ç”¨å’ŒJavaä¸­çº¿ç¨‹æ± çš„ä½¿ç”¨åŸºæœ¬ä¸€è‡´</li><li>Javaä¸­å’Œçº¿ç¨‹æœ‰å…³çš„ä¸œä¸œå«åšExecutorï¼ŒExecutoræœ¬èº«æ˜¯ä¸€ä¸ªæ¥å£</li><li>è¿™ä¸ªæ¥å£æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å®ç°ç±»å«åšThreadPoolExecutor</li><li>Androidä¸­å¸¸ç”¨çš„çº¿ç¨‹æ± <strong>éƒ½æ˜¯é€šè¿‡å¯¹ThreadPoolExecutor</strong>è¿›è¡Œä¸åŒé…ç½®æ¥å®ç°çš„</li></ul><p><strong>ç±»çš„ç»§æ‰¿ç»“æ„</strong></p><p>Windowsï¼šCtrl+H</p><p>Macï¼šControl+H</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fmt3dofim9j311o0fqtc9.jpg" alt="ç±»çš„ç»§æ‰¿ç»“æ„"></p><h4 id="å…³äºThreadPoolExecutor"><a href="#å…³äºThreadPoolExecutor" class="headerlink" title="å…³äºThreadPoolExecutor"></a>å…³äºThreadPoolExecutor</h4><p>ThreadPoolExecutoræœ‰å››ä¸ªé‡è½½çš„æ„é€ æ–¹æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œæ¥è¯´è¯´å‚æ•°æœ€å¤šçš„é‚£ä¸€ä¸ªé‡è½½çš„æ„é€ æ–¹æ³•ï¼Œè¿™æ ·å¤§å®¶å°±çŸ¥é“å…¶ä»–æ–¹æ³•å‚æ•°çš„å«ä¹‰äº†</p><p>æ„é€ å‡½æ•°æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Creates a new &#123;<span class="doctag">@code</span> ThreadPoolExecutor&#125; with the given initial</div><div class="line"> * parameters and default thread factory.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> corePoolSize the number of threads to keep in the pool, even</div><div class="line"> *        if they are idle, unless &#123;<span class="doctag">@code</span> allowCoreThreadTimeOut&#125; is set</div><div class="line"> * <span class="doctag">@param</span> maximumPoolSize the maximum number of threads to allow in the</div><div class="line"> *        pool</div><div class="line"> * <span class="doctag">@param</span> keepAliveTime when the number of threads is greater than</div><div class="line"> *        the core, this is the maximum time that excess idle threads</div><div class="line"> *        will wait for new tasks before terminating.</div><div class="line"> * <span class="doctag">@param</span> unit the time unit for the &#123;<span class="doctag">@code</span> keepAliveTime&#125; argument</div><div class="line"> * <span class="doctag">@param</span> workQueue the queue to use for holding tasks before they are</div><div class="line"> *        executed.  This queue will hold only the &#123;<span class="doctag">@code</span> Runnable&#125;</div><div class="line"> *        tasks submitted by the &#123;<span class="doctag">@code</span> execute&#125; method.</div><div class="line"> * <span class="doctag">@param</span> handler the handler to use when execution is blocked</div><div class="line"> *        because the thread bounds and queue capacities are reached</div><div class="line"> * <span class="doctag">@throws</span> IllegalArgumentException if one of the following holds:&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> corePoolSize &lt; 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> keepAliveTime &lt; 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> maximumPoolSize &lt;= 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> maximumPoolSize &lt; corePoolSize&#125;</div><div class="line"> * <span class="doctag">@throws</span> NullPointerException if &#123;<span class="doctag">@code</span> workQueue&#125;</div><div class="line"> *         or &#123;<span class="doctag">@code</span> handler&#125; is null</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></div><div class="line">                          <span class="keyword">int</span> maximumPoolSize,</div><div class="line">                          <span class="keyword">long</span> keepAliveTime,</div><div class="line">                          TimeUnit unit,</div><div class="line">                          BlockingQueue&lt;Runnable&gt; workQueue,</div><div class="line">                          RejectedExecutionHandler handler) &#123;</div><div class="line">    <span class="keyword">this</span>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,</div><div class="line">         Executors.defaultThreadFactory(), handler);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Creates a new &#123;<span class="doctag">@code</span> ThreadPoolExecutor&#125; with the given initial</div><div class="line"> * parameters.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> corePoolSize the number of threads to keep in the pool, even</div><div class="line"> *        if they are idle, unless &#123;<span class="doctag">@code</span> allowCoreThreadTimeOut&#125; is set</div><div class="line"> * <span class="doctag">@param</span> maximumPoolSize the maximum number of threads to allow in the</div><div class="line"> *        pool</div><div class="line"> * <span class="doctag">@param</span> keepAliveTime when the number of threads is greater than</div><div class="line"> *        the core, this is the maximum time that excess idle threads</div><div class="line"> *        will wait for new tasks before terminating.</div><div class="line"> * <span class="doctag">@param</span> unit the time unit for the &#123;<span class="doctag">@code</span> keepAliveTime&#125; argument</div><div class="line"> * <span class="doctag">@param</span> workQueue the queue to use for holding tasks before they are</div><div class="line"> *        executed.  This queue will hold only the &#123;<span class="doctag">@code</span> Runnable&#125;</div><div class="line"> *        tasks submitted by the &#123;<span class="doctag">@code</span> execute&#125; method.</div><div class="line"> * <span class="doctag">@param</span> threadFactory the factory to use when the executor</div><div class="line"> *        creates a new thread</div><div class="line"> * <span class="doctag">@param</span> handler the handler to use when execution is blocked</div><div class="line"> *        because the thread bounds and queue capacities are reached</div><div class="line"> * <span class="doctag">@throws</span> IllegalArgumentException if one of the following holds:&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> corePoolSize &lt; 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> keepAliveTime &lt; 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> maximumPoolSize &lt;= 0&#125;&lt;br&gt;</div><div class="line"> *         &#123;<span class="doctag">@code</span> maximumPoolSize &lt; corePoolSize&#125;</div><div class="line"> * <span class="doctag">@throws</span> NullPointerException if &#123;<span class="doctag">@code</span> workQueue&#125;</div><div class="line"> *         or &#123;<span class="doctag">@code</span> threadFactory&#125; or &#123;<span class="doctag">@code</span> handler&#125; is null</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></div><div class="line">                          <span class="keyword">int</span> maximumPoolSize,</div><div class="line">                          <span class="keyword">long</span> keepAliveTime,</div><div class="line">                          TimeUnit unit,</div><div class="line">                          BlockingQueue&lt;Runnable&gt; workQueue,</div><div class="line">                          ThreadFactory threadFactory,</div><div class="line">                          RejectedExecutionHandler handler) &#123;</div><div class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</div><div class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</div><div class="line">        maximumPoolSize &lt; corePoolSize ||</div><div class="line">        keepAliveTime &lt; <span class="number">0</span>)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</div><div class="line">    <span class="keyword">if</span> (workQueue == <span class="keyword">null</span> || threadFactory == <span class="keyword">null</span> || handler == <span class="keyword">null</span>)</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</div><div class="line">    <span class="keyword">this</span>.corePoolSize = corePoolSize;</div><div class="line">    <span class="keyword">this</span>.maximumPoolSize = maximumPoolSize;</div><div class="line">    <span class="keyword">this</span>.workQueue = workQueue;</div><div class="line">    <span class="keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</div><div class="line">    <span class="keyword">this</span>.threadFactory = threadFactory;</div><div class="line">    <span class="keyword">this</span>.handler = handler;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>è¿™é‡Œæ˜¯7ä¸ªå‚æ•°(æˆ‘ä»¬åœ¨å¼€å‘ä¸­ç”¨çš„æ›´å¤šçš„æ˜¯5ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•)ï¼ŒOKï¼Œé‚£æˆ‘ä»¬æ¥çœ‹çœ‹è¿™é‡Œä¸ƒä¸ªå‚æ•°çš„å«ä¹‰ï¼š</strong></p><ol><li><strong>corePoolSize</strong>ï¼šæ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡</li><li><strong>maximumPoolSize</strong>ï¼šæœ€å¤§çº¿ç¨‹æ•°é‡</li><li><strong>keepAliveTime</strong>ï¼šéæ ¸å¿ƒçº¿ç¨‹çš„è¶…æ—¶æ—¶é•¿ï¼Œå½“ç³»ç»Ÿä¸­<strong>éæ ¸å¿ƒçº¿ç¨‹é—²ç½®æ—¶é—´è¶…è¿‡</strong>keepAliveTimeä¹‹åï¼Œåˆ™ä¼š<strong>è¢«å›æ”¶</strong>ã€‚å¦‚æœThreadPoolExecutorçš„allowCoreThreadTimeOutå±æ€§è®¾ç½®ä¸ºtrueï¼Œåˆ™è¯¥å‚æ•°ä¹Ÿè¡¨ç¤ºæ ¸å¿ƒçº¿ç¨‹çš„è¶…æ—¶æ—¶é•¿</li><li><strong>unit</strong>ï¼šç¬¬ä¸‰ä¸ªå‚æ•°çš„å•ä½ï¼Œæœ‰çº³ç§’ã€å¾®ç§’ã€æ¯«ç§’ã€ç§’ã€åˆ†ã€æ—¶ã€å¤©ç­‰</li><li><strong>workQueue</strong>ï¼šçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—å­˜å‚¨å·²ç»è¢«æäº¤ï¼Œä½†æ˜¯å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ï¼Œå­˜å‚¨åœ¨è¿™é‡Œçš„ä»»åŠ¡æ˜¯ç”±ThreadPoolExecutorçš„executeæ–¹æ³•æäº¤æ¥çš„ã€‚</li><li><strong>threadFactory</strong>  ä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸€èˆ¬<strong>ä½¿ç”¨é»˜è®¤å³å¯</strong></li><li><strong>handler</strong> æ‹’ç»ç­–ç•¥ï¼Œå½“çº¿ç¨‹æ— æ³•æ‰§è¡Œæ–°ä»»åŠ¡æ—¶ï¼ˆä¸€èˆ¬æ˜¯ç”±äºçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°æœ€å¤§æ•°æˆ–è€…çº¿ç¨‹æ± å…³é—­å¯¼è‡´çš„ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“çº¿ç¨‹æ± æ— æ³•å¤„ç†æ–°çº¿ç¨‹æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªRejectedExecutionExceptionã€‚</li></ol><p><strong>å…³äºworkQueue</strong></p><ul><li>workQueueæ˜¯ä¸€ä¸ªBlockingQueueç±»å‹</li><li>BlockingQueueæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é˜Ÿåˆ—</li><li>ä»BlockingQueueä¸­å–æ•°æ®æ—¶ï¼Œ<ul><li>å¦‚æœBlockingQueueæ˜¯ç©ºçš„ï¼Œåˆ™å–æ•°æ®çš„æ“ä½œä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€</li><li>å½“BlockingQueueä¸­æœ‰äº†æ–°æ•°æ®æ—¶ï¼Œè¿™ä¸ªå–æ•°æ®çš„æ“ä½œåˆä¼šè¢«é‡æ–°å”¤é†’</li><li>å¦‚æœBlockingQueueä¸­çš„æ•°æ®å·²ç»æ»¡äº†ï¼Œå¾€BlockingQueueä¸­å­˜æ•°æ®çš„æ“ä½œåˆä¼šè¿›å…¥é˜»å¡çŠ¶æ€(ç›´åˆ°BlockingQueueä¸­åˆæœ‰æ–°çš„ç©ºé—´ï¼Œå­˜æ•°æ®çš„æ“ä½œåˆä¼šè¢«å†²æ´—å”¤é†’</li></ul></li><li>BlockingQueueçš„ç§ç±»<ul><li><strong>ArrayBlockingQueue</strong>:è¿™ä¸ªè¡¨ç¤ºä¸€ä¸ª<strong>è§„å®šäº†å¤§å°</strong>çš„BlockingQueueï¼ŒArrayBlockingQueueçš„æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªintç±»å‹çš„æ•°æ®ï¼Œè¯¥æ•°æ®è¡¨ç¤ºBlockingQueueçš„å¤§å°ï¼Œå­˜å‚¨åœ¨ArrayBlockingQueueä¸­çš„å…ƒç´ æŒ‰ç…§FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„æ–¹å¼æ¥è¿›è¡Œå­˜å–ã€‚</li><li><strong>LinkedBlockingQueue</strong>:è¿™ä¸ªè¡¨ç¤ºä¸€ä¸ªå¤§å°ä¸ç¡®å®šçš„BlockingQueueï¼Œåœ¨LinkedBlockingQueueçš„æ„é€ æ–¹æ³•ä¸­å¯ä»¥ä¼ ä¸€ä¸ªintç±»å‹çš„æ•°æ®ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„LinkedBlockingQueueæ˜¯æœ‰å¤§å°çš„ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ ï¼Œä¸ä¼ çš„è¯ï¼ŒLinkedBlockingQueueçš„å¤§å°å°±ä¸ºInteger.MAX_VALUE</li><li><strong>PriorityBlockingQueue</strong>:è¿™ä¸ªé˜Ÿåˆ—å’ŒLinkedBlockingQueueç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯PriorityBlockingQueueä¸­çš„å…ƒç´ ä¸æ˜¯æŒ‰ç…§FIFOæ¥æ’åºçš„ï¼Œè€Œæ˜¯æŒ‰ç…§å…ƒç´ çš„Comparatoræ¥å†³å®šå­˜å–é¡ºåºçš„ï¼ˆè¿™ä¸ªåŠŸèƒ½ä¹Ÿåæ˜ äº†å­˜å…¥PriorityBlockingQueueä¸­çš„æ•°æ®å¿…é¡»å®ç°äº†Comparatoræ¥å£ï¼‰ã€‚</li><li><strong>SynchronousQueue</strong>:è¿™ä¸ªæ˜¯åŒæ­¥Queueï¼Œå±äºçº¿ç¨‹å®‰å…¨çš„BlockingQueueçš„ä¸€ç§ï¼Œåœ¨SynchronousQueueä¸­ï¼Œç”Ÿäº§è€…çº¿ç¨‹çš„æ’å…¥æ“ä½œå¿…é¡»è¦ç­‰å¾…æ¶ˆè´¹è€…çº¿ç¨‹çš„ç§»é™¤æ“ä½œï¼ŒSynchronouså†…éƒ¨æ²¡æœ‰æ•°æ®ç¼“å­˜ç©ºé—´ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•å¯¹SynchronousQueueè¿›è¡Œè¯»å–æˆ–è€…éå†å…¶ä¸­çš„æ•°æ®ï¼Œå…ƒç´ åªæœ‰åœ¨ä½ è¯•å›¾å–èµ°çš„æ—¶å€™æ‰æœ‰å¯èƒ½å­˜åœ¨ã€‚æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…äº’ç›¸ç­‰å¾…ï¼Œç­‰åˆ°å¯¹æ–¹ä¹‹åç„¶åå†ä¸€èµ·ç¦»å¼€ã€‚</li></ul></li></ul><h4 id="ThreadPoolExecutoçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡æ—¶ï¼š"><a href="#ThreadPoolExecutoçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡æ—¶ï¼š" class="headerlink" title="ThreadPoolExecutoçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡æ—¶ï¼š"></a>ThreadPoolExecutoçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡æ—¶ï¼š</h4><p><strong>executeä¸€ä¸ªçº¿ç¨‹ä¹‹å</strong>ï¼š</p><ul><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°æœªè¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™ä¼šç«‹é©¬å¯ç”¨ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹å»æ‰§è¡Œ</li><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œä¸”workQueueæœªæ»¡ï¼Œåˆ™å°†æ–°çº¿ç¨‹æ”¾å…¥workQueueä¸­ç­‰å¾…æ‰§è¡Œ</li><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ä½†æœªè¶…è¿‡éæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œä¸”workQueueå·²æ»¡ï¼Œåˆ™å¼€å¯ä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</li><li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°å·²ç»è¶…è¿‡éæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™æ‹’ç»æ‰§è¡Œè¯¥ä»»åŠ¡</li></ul><h4 id="å¦‚ä½•é…ç½®è¿™äº›å‚æ•°ï¼ˆå‚è€ƒAsycTaskï¼‰"><a href="#å¦‚ä½•é…ç½®è¿™äº›å‚æ•°ï¼ˆå‚è€ƒAsycTaskï¼‰" class="headerlink" title="å¦‚ä½•é…ç½®è¿™äº›å‚æ•°ï¼ˆå‚è€ƒAsycTaskï¼‰"></a>å¦‚ä½•é…ç½®è¿™äº›å‚æ•°ï¼ˆå‚è€ƒAsycTaskï¼‰</h4><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fmt4c3mgklj31eq15kdqq.jpg" alt="ç±»çš„ç»§æ‰¿ç»“æ„"></p><ul><li>æ ¸å¿ƒçº¿ç¨‹æ•°ä¸ºæ‰‹æœºCPUæ•°é‡+1ï¼ˆcpuæ•°é‡è·å–æ–¹å¼Runtime.getRuntime().availableProcessors()ï¼‰</li><li>æœ€å¤§çº¿ç¨‹æ•°ä¸ºæ‰‹æœºCPUæ•°é‡Ã—2+1</li><li>çº¿ç¨‹é˜Ÿåˆ—çš„å¤§å°ä¸º128</li></ul><h4 id="ç³»ç»Ÿå¸®æˆ‘ä»¬é…ç½®å¥½çš„çº¿ç¨‹æ± å››ç§å¯¹æ¯”"><a href="#ç³»ç»Ÿå¸®æˆ‘ä»¬é…ç½®å¥½çš„çº¿ç¨‹æ± å››ç§å¯¹æ¯”" class="headerlink" title="ç³»ç»Ÿå¸®æˆ‘ä»¬é…ç½®å¥½çš„çº¿ç¨‹æ± å››ç§å¯¹æ¯”"></a><span id="jumpback">ç³»ç»Ÿå¸®æˆ‘ä»¬é…ç½®å¥½çš„çº¿ç¨‹æ± </span><a href="#jump">å››ç§å¯¹æ¯”</a></h4><ul><li><p>FixedThreadPool</p><ul><li><p>æ ¸å¿ƒçº¿ç¨‹æ•°é‡å›ºå®šçš„çº¿ç¨‹æ± </p></li><li><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ExecutorService fixedThreadPool = Executors.newFixedThreadPool(<span class="number">3</span>);</div></pre></td></tr></table></figure></li><li><p>æºç ï¼š</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</div><div class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</div><div class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>æ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°ä¸€æ ·</li><li>FixedThreadPoolä¸­æ²¡æœ‰éæ ¸å¿ƒçº¿ç¨‹ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯æ ¸å¿ƒçº¿ç¨‹</li><li>çº¿ç¨‹çš„è¶…æ—¶æ—¶é—´ä¸º0</li><li>æ ¸å¿ƒçº¿ç¨‹å³ä½¿åœ¨æ²¡æœ‰ä»»åŠ¡å¯æ‰§è¡Œçš„æ—¶å€™ä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼ˆè¿™æ ·å¯è®©FixedThreadPoolæ›´å¿«é€Ÿçš„å“åº”è¯·æ±‚ï¼‰</li><li>LinkedBlockingQueueå´æ²¡æœ‰å‚æ•°ï¼Œè¿™è¯´æ˜çº¿ç¨‹é˜Ÿåˆ—çš„å¤§å°ä¸ºInteger.MAX_VALUEï¼ˆ2çš„31æ¬¡æ–¹å‡1)</li><li>æ‰€æœ‰çš„æ ¸å¿ƒçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œæ–°çš„ä»»åŠ¡åªèƒ½è¿›å…¥çº¿ç¨‹é˜Ÿåˆ—ä¸­è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°æœ‰çº¿ç¨‹è¢«ç©ºé—²å‡ºæ¥</li></ul></li><li><p>SingleThreadExecutor</p><ul><li><p>singleThreadExecutorå’ŒFixedThreadPoolå¾ˆåƒï¼Œä¸åŒçš„å°±æ˜¯SingleThreadExecutorçš„æ ¸å¿ƒçº¿ç¨‹æ•°åªæœ‰1</p></li><li><p>â€‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</div><div class="line">          (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</div><div class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</div><div class="line">                                  <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</div><div class="line">  &#125;</div></pre></td></tr></table></figure></li><li><p>æœ€å¤§å¥½å¤„å°±æ˜¯å¯ä»¥é¿å…æˆ‘ä»¬å»å¤„ç†çº¿ç¨‹åŒæ­¥é—®é¢˜</p></li><li><p>åªæœ‰ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œç¡®ä¿æ‰€æœ‰ä»»åŠ¡éƒ½åœ¨åŒä¸€çº¿ç¨‹ä¸­æŒ‰é¡ºåºå®Œæˆã€‚å› æ­¤ä¸éœ€è¦å¤„ç†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚</p></li><li><p>FixedThreadPoolçš„å‚æ•°ä¼ ä¸ª1æ•ˆæœä¸€æ ·</p></li></ul></li><li><p>CachedThreadPool</p><ul><li><p>æœ€å¤§çš„ä¼˜åŠ¿æ˜¯å®ƒå¯ä»¥æ ¹æ®ç¨‹åºçš„è¿è¡Œæƒ…å†µè‡ªåŠ¨æ¥è°ƒæ•´çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡</p></li><li><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</div><div class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</div><div class="line">                                  <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>CachedThreadPoolä¸­æ˜¯æ²¡æœ‰æ ¸å¿ƒçº¿ç¨‹çš„ï¼Œä½†æ˜¯å®ƒçš„æœ€å¤§çº¿ç¨‹æ•°å´ä¸ºInteger.MAX_VALUE</p></li><li><p>å®ƒæ˜¯æœ‰çº¿ç¨‹è¶…æ—¶æœºåˆ¶çš„ï¼Œè¶…æ—¶æ—¶é—´ä¸º60ç§’</p></li><li><p>æœ€å¤§çº¿ç¨‹æ•°ä¸ºæ— é™å¤§</p></li><li><p>æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡è¿›æ¥çš„æ—¶å€™ï¼Œå¦‚æœçº¿ç¨‹æ± ä¸­æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œåˆ™ç”±è¯¥ç©ºé—²çš„çº¿ç¨‹æ‰§è¡Œæ–°ä»»åŠ¡</p></li><li><p>æ²¡æœ‰ç©ºé—²çº¿ç¨‹ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</p></li><li><p>CachedThreadPoolä¸­æ²¡æœ‰æ–°ä»»åŠ¡çš„æ—¶å€™ï¼Œå®ƒé‡Œè¾¹æ‰€æœ‰çš„çº¿ç¨‹éƒ½ä¼šå› ä¸ºè¶…æ—¶è€Œè¢«ç»ˆæ­¢</p></li><li><p>ä»»åŠ¡é˜Ÿåˆ—SynchronousQueueç›¸å½“äºä¸€ä¸ªç©ºé›†åˆï¼Œå¯¼è‡´ä»»ä½•ä»»åŠ¡éƒ½ä¼šè¢«ç«‹å³æ‰§è¡Œ</p></li><li><p>å¯ä»¥åœ¨æœ‰å¤§é‡ä»»åŠ¡è¯·æ±‚çš„æ—¶å€™ä½¿ç”¨CachedThreadPool</p></li></ul></li><li><p>ScheduleThreadPool</p><ul><li><p>å…·æœ‰å®šæ—¶å®šæœŸæ‰§è¡Œä»»åŠ¡åŠŸèƒ½çš„çº¿ç¨‹æ± </p></li><li><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ScheduledThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(corePoolSize, Integer.MAX_VALUE,</div><div class="line">          DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS,</div><div class="line">          <span class="keyword">new</span> DelayedWorkQueue());</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>æ ¸å¿ƒçº¿ç¨‹æ•°é‡æ˜¯å›ºå®šçš„</p></li><li>éæ ¸å¿ƒçº¿ç¨‹æ˜¯æ— ç©·å¤§,å½“éæ ¸å¿ƒçº¿ç¨‹é—²ç½®æ—¶ï¼Œåˆ™ä¼šè¢«ç«‹å³å›æ”¶ã€‚</li><li>æ”¯æŒå»¶è¿Ÿæ‰§è¡Œä»»åŠ¡ï¼›å®šæ—¶æ‰§è¡Œä»»åŠ¡ï¼›å»¶è¿Ÿå®šæ—¶æ‰§è¡Œä»»åŠ¡</li></ul></li></ul><h4 id="çº¿ç¨‹æ± çš„å…¶ä»–åŠŸèƒ½"><a href="#çº¿ç¨‹æ± çš„å…¶ä»–åŠŸèƒ½" class="headerlink" title="çº¿ç¨‹æ± çš„å…¶ä»–åŠŸèƒ½"></a>çº¿ç¨‹æ± çš„å…¶ä»–åŠŸèƒ½</h4><ol><li><strong>shutDownï¼ˆï¼‰</strong>ï¼šå…³é—­çº¿ç¨‹æ± ï¼Œä¸å½±å“å·²ç»æäº¤çš„ä»»åŠ¡</li><li><strong>shutDownNowï¼ˆï¼‰</strong>ï¼šå…³é—­çº¿ç¨‹æ± ï¼Œå¹¶å°è¯•ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹</li><li><strong>allowCoreThreadTimeOut(boolean value)</strong>ï¼šå…è®¸æ ¸å¿ƒçº¿ç¨‹é—²ç½®è¶…æ—¶è¢«å›æ”¶</li><li><strong>submit</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨executeæ¥æäº¤ä»»åŠ¡ï¼Œä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½ä¹Ÿä¼šç”¨åˆ°submitï¼Œä½¿ç”¨submitçš„å¥½å¤„æ˜¯submitæœ‰è¿”å›å€¼</li></ol><h4 id="çº¿ç¨‹æ± ç®€å•å°è£…"><a href="#çº¿ç¨‹æ± ç®€å•å°è£…" class="headerlink" title="çº¿ç¨‹æ± ç®€å•å°è£…"></a>çº¿ç¨‹æ± ç®€å•å°è£…</h4><p>ThreadPoolManager.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.LinkedBlockingQueue;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</div><div class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fengan on 2017/12/25.</div><div class="line"> * email:fengan1102@gmail.com</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolManager</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadPoolManager Instance;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ThreadPoolExecutor threadPoolExecutor;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ThreadPoolManager</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">//æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></div><div class="line"><span class="comment">//æœ€å¤§çº¿ç¨‹æ•°é‡</span></div><div class="line"><span class="comment">//éæ ¸å¿ƒçº¿ç¨‹çš„è¶…æ—¶æ—¶é•¿</span></div><div class="line"><span class="comment">//æ—¶é—´å•ä½</span></div><div class="line"><span class="comment">//ç¼“å†²é˜Ÿåˆ—ï¼Œç”¨äºå­˜æ”¾ç­‰å¾…ä»»åŠ¡ï¼ŒLinkedçš„å…ˆè¿›å…ˆå‡º</span></div><div class="line"><span class="comment">//åˆ›å»ºçº¿ç¨‹çš„å·¥å‚</span></div><div class="line"><span class="comment">//ç”¨æ¥å¯¹è¶…å‡ºmaximumPoolSizeçš„ä»»åŠ¡çš„å¤„ç†ç­–ç•¥</span></div><div class="line">        threadPoolExecutor = <span class="keyword">new</span> ThreadPoolExecutor(corePoolSize,<span class="comment">//æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></div><div class="line">                maximumPoolSize,<span class="comment">//æœ€å¤§çº¿ç¨‹æ•°é‡</span></div><div class="line">                keepAliveTime,<span class="comment">//éæ ¸å¿ƒçº¿ç¨‹çš„è¶…æ—¶æ—¶é•¿</span></div><div class="line">                unit,<span class="comment">//æ—¶é—´å•ä½</span></div><div class="line">                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),<span class="comment">//ç¼“å†²é˜Ÿåˆ—ï¼Œç”¨äºå­˜æ”¾ç­‰å¾…ä»»åŠ¡ï¼ŒLinkedçš„å…ˆè¿›å…ˆå‡º</span></div><div class="line">                Executors.defaultThreadFactory(), <span class="comment">//åˆ›å»ºçº¿ç¨‹çš„å·¥å‚</span></div><div class="line">                <span class="keyword">new</span> ThreadPoolExecutor.AbortPolicy() <span class="comment">//ç”¨æ¥å¯¹è¶…å‡ºmaximumPoolSizeçš„ä»»åŠ¡çš„å¤„ç†ç­–ç•¥</span></div><div class="line">        );</div><div class="line">        threadPoolExecutor.allowCoreThreadTimeOut(<span class="keyword">true</span>);<span class="comment">//è®¾ç½®æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶æ—¶é—´å¯ç”¨</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ThreadPoolManager <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (Instance == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">synchronized</span> (ThreadPoolManager.class) &#123;</div><div class="line">                <span class="keyword">if</span> (Instance == <span class="keyword">null</span>) &#123;</div><div class="line">                    Instance = <span class="keyword">new</span> ThreadPoolManager();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> Instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//å½“å‰è®¾å¤‡å¯ç”¨å¤„ç†å™¨æ ¸å¿ƒæ•°*2 + 1,èƒ½å¤Ÿè®©cpuçš„æ•ˆç‡å¾—åˆ°æœ€å¤§ç¨‹åº¦æ‰§è¡Œï¼ˆæœ‰ç ”ç©¶è®ºè¯çš„ï¼‰</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> corePoolSize = Runtime.getRuntime().availableProcessors() * <span class="number">2</span> + <span class="number">1</span>;</div><div class="line">    <span class="comment">//æœ€å¤§çº¿ç¨‹æ•°ç­‰äºæ ¸å¿ƒçº¿ç¨‹æ•°</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> maximumPoolSize = corePoolSize;</div><div class="line">    <span class="comment">//è¶…æ—¶æ—¶é—´ï¼Œ1å°æ—¶</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> keepAliveTime = <span class="number">1</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TimeUnit unit = TimeUnit.HOURS;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * æ‰§è¡Œä»»åŠ¡</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable runnable)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (runnable == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line"></div><div class="line">        threadPoolExecutor.execute(runnable);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * ä»çº¿ç¨‹æ± ä¸­ç§»é™¤ä»»åŠ¡</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Runnable runnable)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (runnable == <span class="keyword">null</span>) <span class="keyword">return</span>;</div><div class="line"></div><div class="line">        threadPoolExecutor.remove(runnable);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="å†æ¬¡æ¯”è¾ƒå››ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦ç»†æ¯”è¾ƒ"><a href="#å†æ¬¡æ¯”è¾ƒå››ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦ç»†æ¯”è¾ƒ" class="headerlink" title="å†æ¬¡æ¯”è¾ƒå››ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦ç»†æ¯”è¾ƒ"></a><span id="jump">å†æ¬¡æ¯”è¾ƒå››ç§å¸¸è§çš„çº¿ç¨‹æ± </span><a href="#jumpback">è¯¦ç»†æ¯”è¾ƒ</a></h4><p><strong>ä¸ç®¡å“ªç§çº¿ç¨‹æ± ï¼Œéƒ½æ˜¯é ThreadPoolExecutorçš„ä¸ƒä¸ªå‚æ•°çš„æ„é€ æ¥å®ç°çš„</strong></p><table><thead><tr><th></th><th>æ ¸å¿ƒçº¿ç¨‹</th><th>æœ€å¤§çº¿ç¨‹</th><th></th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><font color="red">FixThreadPool</font></td><td>æœ‰</td><td>æ— ï¼ˆéæ ¸å¿ƒçº¿ç¨‹ï¼‰</td><td>ä¸ä¼šè¢«å›æ”¶</td><td>åªæœ‰å›ºå®šæ•°é‡çš„æ ¸å¿ƒçº¿ç¨‹ï¼Œçº¿ç¨‹éƒ½æ´»åŠ¨æ—¶ï¼Œæ–°ä»»åŠ¡ç­‰å¾…</td></tr><tr><td><font color="red">SingleThreadPool</font></td><td>1</td><td>æ— ï¼ˆéæ ¸å¿ƒçº¿ç¨‹ï¼‰</td><td>ä¸ä¼šè¢«å›æ”¶</td><td>æ‰€æœ‰ä»»åŠ¡éƒ½åœ¨ç»Ÿä¸€çº¿ç¨‹æ‰§è¡Œï¼Œä¸éœ€è¦å¤„ç†çº¿ç¨‹åŒæ­¥é—®é¢˜</td></tr><tr><td><font color="red">CachedThreadPool</font></td><td>æ— </td><td>Integer.MAX_VALUE</td><td>è¶…æ—¶æ—¶é—´60ç§’</td><td>ä»»ä½•ä»»åŠ¡ç«‹å³æ‰§è¡Œ</td></tr><tr><td><font color="red">ScheduledThreadPool</font></td><td>æœ‰</td><td>Integer.MAX_VALUE</td><td>éæ ¸å¿ƒçº¿ç¨‹é—²ç½®ï¼Œç«‹å³å›æ”¶</td><td>å¯ä»¥å»¶è¿Ÿå’Œå®šæ—¶æ‰§è¡Œ</td></tr></tbody></table><p>ç›¸å…³èµ„æ–™ï¼š</p><p><a href="http://blog.csdn.net/xiangyunwan/article/details/72550948" target="_blank" rel="external">å‚è€ƒ1</a></p><p><a href="http://blog.csdn.net/u012702547/article/details/52259529" target="_blank" rel="external">å‚è€ƒ2</a></p><p><a href="http://blog.csdn.net/cswhale/article/details/39053857" target="_blank" rel="external">å‚è€ƒ3</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>AsyncTaskçš„å¼Šç«¯</title>
      <link href="/2016/12/20/AsyncTask%E7%BC%BA%E9%99%B7%E6%80%BB%E7%BB%93/"/>
      <content type="html"><![CDATA[<p>Androidå¼€å‘ä¸­ï¼ŒAsyncTaskå¯ä»¥æ›¿ä»£Handlerå’ŒThreadæ¥å¤„ç†åå°æ“ä½œå’Œé€šçŸ¥Uiåˆ·æ–°ï¼Œé€‚ç”¨äºå¤„ç†å¼‚æ­¥æ•°æ®ï¼Œå¹¶å°†æ›´æ–°Uiçš„åœºæ™¯ï¼ŒAsyncTaské€‚ç”¨äºåå°æ“ä½œåªæœ‰å‡ ç§’çš„çŸ­æ—¶æ“ä½œã€‚ä½†æ˜¯AsyncTaskæœ¬èº«å­˜åœ¨å¾ˆå¤šç³Ÿç³•çš„é—®é¢˜ï¼Œå¦‚æœä½¿ç”¨ä¸­ä¸æ³¨æ„ï¼Œå°†ä¼šå½±å“ç¨‹åºçš„å¥å£®æ€§ã€‚</p><a id="more"></a><h2 id="AsyncTaskå’ŒHandlerå¯¹æ¯”"><a href="#AsyncTaskå’ŒHandlerå¯¹æ¯”" class="headerlink" title="AsyncTaskå’ŒHandlerå¯¹æ¯”"></a>AsyncTaskå’ŒHandlerå¯¹æ¯”</h2><p><strong>æ³¨æ„ï¼šæŒ‰ç…§Androidå®˜æ–¹æ–‡æ¡£æ”¯å‡º,AsyncTaskè¢«æ¨èä¸ºå¤„ç†çŸ­æ—¶é—´(10ç§’ä»¥å†…)çš„æ“ä½œ,å³æœ¬åœ°çš„è½»é‡IOæ“ä½œ.ä¸é€‚åˆä½¿ç”¨ç½‘ç»œè¿™æ ·æ—¶é—´ä¸å®šçš„æ“ä½œ.</strong></p><h3 id="å…±åŒç‚¹"><a href="#å…±åŒç‚¹" class="headerlink" title="å…±åŒç‚¹"></a>å…±åŒç‚¹</h3><p>éƒ½æ˜¯ä¸ºäº†è§£å†³è€—æ—¶æ“ä½œçš„é—®é¢˜ï¼Œä¸»è¦åŒºåˆ«åœ¨äºä¸€ä¸ªæµç¨‹å®Œå–„ï¼Œæ‹¿æ¥å°±ç”¨ï¼ˆAsyncTaskï¼‰ï¼Œä¸€ä¸ªåå‘è‡ªä¸»å®šåˆ¶ï¼Œæ‰©å±•æ€§é«˜ï¼ˆHandler+Threadï¼‰ã€‚</p><ul><li><strong>AsyncTaskæ¯”Handlerè½»é‡çº§ï¼Œå¯¹å—ï¼Ÿ</strong></li></ul><ol><li>é€šè¿‡çœ‹æºç ï¼Œå‘ç°AsyncTaskå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè€Œç½‘ä¸Šçš„è¯´æ³•æ˜¯AsyncTaskæ¯”handlerè¦è½»é‡çº§ï¼Œæ˜¾ç„¶ä¸Šä¸å‡†ç¡®çš„ï¼Œåªèƒ½è¿™æ ·è¯´ï¼ŒAsyncTaskåœ¨ä»£ç ä¸Šæ¯”handlerè¦è½»é‡çº§åˆ«ï¼Œè€Œå®é™…ä¸Šè¦æ¯”handleræ›´è€—èµ„æºï¼Œå› ä¸ºAsyncTaskåº•å±‚æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼è€ŒHandlerä»…ä»…å°±æ˜¯å‘é€äº†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿çº¿ç¨‹éƒ½æ²¡æœ‰å¼€ã€‚</li><li>ä½†æ˜¯ï¼Œå¦‚æœå¼‚æ­¥ä»»åŠ¡çš„æ•°æ®ç‰¹åˆ«åºå¤§ï¼ŒAsyncTaskè¿™ç§çº¿ç¨‹æ± ç»“æ„çš„ä¼˜åŠ¿å°±ä½“ç°å‡ºæ¥äº†ã€‚</li></ol><ul><li><strong>AsyncTaskå®ç°çš„åŸç†,å’Œé€‚ç”¨çš„ä¼˜ç¼ºç‚¹</strong></li></ul><p>AsyncTask,æ˜¯androidæä¾›çš„è½»é‡çº§çš„å¼‚æ­¥ç±»,å¯ä»¥ç›´æ¥ç»§æ‰¿AsyncTask,åœ¨ç±»ä¸­å®ç°å¼‚æ­¥æ“ä½œ,å¹¶æä¾›æ¥å£åé¦ˆå½“å‰å¼‚æ­¥æ‰§è¡Œçš„ç¨‹åº¦(å¯ä»¥é€šè¿‡æ¥å£å®ç°UIè¿›åº¦æ›´æ–°),æœ€ååé¦ˆæ‰§è¡Œçš„ç»“æœç»™UIä¸»çº¿ç¨‹.</p><p>ä½¿ç”¨çš„ä¼˜ç‚¹:</p><p>l  ç®€å•,å¿«æ·</p><p>l  è¿‡ç¨‹å¯æ§</p><p>ä½¿ç”¨çš„ç¼ºç‚¹:</p><p>l åœ¨ä½¿ç”¨å¤šä¸ªå¼‚æ­¥æ“ä½œçš„åŒæ—¶ï¼Œå…±åŒè¿›è¡ŒUiå˜æ›´æ—¶,å°±å˜å¾—å¤æ‚èµ·æ¥.</p><p>l æœ€å¤§å¹¶å‘æ•°ä¸è¶…è¿‡5</p><ul><li><strong>Handlerå¼‚æ­¥å®ç°çš„åŸç†å’Œé€‚ç”¨çš„ä¼˜ç¼ºç‚¹</strong></li></ul><p>åœ¨Handler å¼‚æ­¥å®ç°æ—¶,æ¶‰åŠåˆ° Handler, Looper, Message,Threadå››ä¸ªå¯¹è±¡ï¼Œå®ç°å¼‚æ­¥çš„æµç¨‹æ˜¯ä¸»çº¿ç¨‹å¯åŠ¨Threadï¼ˆå­çº¿ç¨‹ï¼‰Ã thread(å­çº¿ç¨‹)è¿è¡Œå¹¶ç”ŸæˆMessage-Ã Looperè·å–Messageå¹¶ä¼ é€’ç»™HandlerÃ Handleré€ä¸ªè·å–Looperä¸­çš„Messageï¼Œå¹¶è¿›è¡ŒUIå˜æ›´ã€‚</p><p><strong>ä½¿ç”¨çš„ä¼˜ç‚¹ï¼š</strong></p><p>l  ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½å®šä¹‰æ˜ç¡®</p><p>l  å¯¹äºå¤šä¸ªåå°ä»»åŠ¡æ—¶ï¼Œç®€å•ï¼Œæ¸…æ™°</p><p><strong>ä½¿ç”¨çš„ç¼ºç‚¹ï¼š</strong></p><p>l  åœ¨å•ä¸ªåå°å¼‚æ­¥å¤„ç†æ—¶ï¼Œæ˜¾å¾—ä»£ç è¿‡å¤šï¼Œç»“æ„è¿‡äºå¤æ‚ï¼ˆç›¸å¯¹æ€§ï¼‰</p><h2 id="AsyncTaskçš„ä½¿ç”¨ï¼š"><a href="#AsyncTaskçš„ä½¿ç”¨ï¼š" class="headerlink" title="AsyncTaskçš„ä½¿ç”¨ï¼š"></a>AsyncTaskçš„ä½¿ç”¨ï¼š</h2><ul><li><strong>å¿…é€‰æ–¹æ³•ï¼š</strong></li></ul><p>1ï¼Œ  doinbackground(paramsâ€¦) åå°æ‰§è¡Œï¼Œæ¯”è¾ƒè€—æ—¶çš„æ“ä½œéƒ½å¯ä»¥æ”¾åœ¨è¿™é‡Œã€‚</p><p>æ³¨æ„è¿™é‡Œä¸èƒ½ç›´æ¥æ“ä½œUIã€‚æ­¤æ–¹æ³•åœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œå®Œæˆä»»åŠ¡çš„ä¸»è¦å·¥ä½œ</p><p>ï¼Œé€šå¸¸éœ€è¦è¾ƒé•¿çš„æ—¶é—´ã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è°ƒç”¨</p><p>Public progress(progressâ€¦)æ¥æ›´æ–°ä»»åŠ¡çš„è¿›åº¦ã€‚</p><p>2ï¼Œ  onpostexecute(result)ç›¸å½“äºhandlerå¤„ç†UIçš„æ–¹å¼ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨åœ¨</p><p>doinbackgroundå¾—åˆ°çš„ç»“æœå¤„ç†æ“ä½œUIã€‚æ­¤æ–¹æ³•åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œä»»åŠ¡æ‰§è¡Œçš„ç»“æœä½œä¸ºæ­¤æ–¹æ³•çš„å‚æ•°è¿”å›ã€‚</p><ul><li><strong>å¯é€‰æ–¹æ³•ï¼š</strong></li></ul><p>1ï¼Œ  onprogressupdate(progressâ€¦) å¯ä»¥ä½¿ç”¨è¿›åº¦æ¡å¢åŠ ç”¨æˆ·ä½“éªŒåº¦ã€‚æ­¤æ–¹æ³•åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œç”¨æˆ·æ˜¾ç¤ºä»»åŠ¡æ‰§è¡Œçš„è¿›åº¦ã€‚</p><p>2ï¼Œ  onpreExecute()  è¿™é‡Œæ˜¯æœ€æ–°ç”¨æˆ·è°ƒç”¨excuteæ—¶çš„æ¥å£ï¼Œå½“ä»»åŠ¡æ‰§è¡Œä¹‹å‰å¼€å§‹è°ƒç”¨æ­¤æ–¹æ³•ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºè¿›åº¦å¯¹è¯æ¡†ã€‚</p><p>3ï¼Œ  onCancelled()  ç”¨æˆ·è°ƒç”¨å–æ¶ˆæ—¶ï¼Œè¦åšçš„æ“ä½œ</p><ul><li><strong>AsyncTaskä¸‰ä¸ªçŠ¶æ€ï¼š</strong></li></ul><p>pending,running,finished</p><ul><li><strong>ä½¿ç”¨AsyncTaskç±»ï¼Œéµå®ˆçš„å‡†åˆ™ï¼š</strong></li></ul><p>1ï¼Œ  Taskçš„å®ä¾‹å¿…é¡»åœ¨UI threadä¸­åˆ›å»ºï¼›</p><p>2ï¼Œ  Executeæ–¹æ³•å¿…é¡»åœ¨UI threadä¸­è°ƒç”¨</p><p>3ï¼Œ  ä¸è¦æ‰‹åŠ¨çš„è°ƒç”¨onPfreexecute()ï¼ŒonPostExecute(result)</p><p>Doinbackground(paramsâ€¦),onProgressupdate(progressâ€¦)è¿™å‡ ä¸ªæ–¹æ³•ï¼›</p><p>4ï¼Œ  è¯¥taskåªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¦åˆ™å¤šæ¬¡è°ƒç”¨æ—¶å°†ä¼šå‡ºç°å¼‚å¸¸;</p><h2 id="AsyncTaskç¼ºé™·æ€»ç»“ï¼š"><a href="#AsyncTaskç¼ºé™·æ€»ç»“ï¼š" class="headerlink" title="AsyncTaskç¼ºé™·æ€»ç»“ï¼š"></a>AsyncTaskç¼ºé™·æ€»ç»“ï¼š</h2><ul><li><p><strong>ç”Ÿå‘½å‘¨æœŸ</strong></p><p>å¾ˆå¤šå¼€å‘è€…ä¼šè®¤ä¸ºåœ¨ä¸€ä¸ªActivityä¸­åˆ›å»ºçš„AsyncTaskä¼šéšç€Activityé”€æ¯è€Œé”€æ¯ï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼ŒAsyncTaskä¼šéšç€doInBackgroundï¼ˆï¼‰æ–¹æ³•æ‰§è¡Œå®Œæ¯•æ‰é”€æ¯ï¼Œç„¶åï¼Œcancelï¼ˆï¼‰è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆonCancelä¼šæ‰§è¡Œï¼›å¦åˆ™æ‰§è¡ŒpostExecuteæ–¹æ³•ä¼šæ‰§è¡Œã€‚å¦‚æœåœ¨AsyncTaskæ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œå°±é”€æ¯äº†Activityï¼ŒAsyncTaskå¯èƒ½ä¼šå´©æºƒï¼Œå› ä¸ºå®ƒæƒ³è¦å¤„ç†çš„viewå·²ç»ä¸å­˜åœ¨äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æ€»æ˜¯å¿…é¡»ç¡®ä¿åœ¨é”€æ¯æ´»åŠ¨ä¹‹å‰å–æ¶ˆä»»åŠ¡ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬ä½¿ç”¨AsyncTaskéœ€è¦ç¡®ä¿AsyncTaskæ­£ç¡®åœ°å–æ¶ˆã€‚</p><p>å¦å¤–ï¼Œå³ä½¿æˆ‘ä»¬æ­£ç¡®åœ°è°ƒç”¨äº†cancle() ä¹Ÿæœªå¿…èƒ½çœŸæ­£åœ°å–æ¶ˆä»»åŠ¡ã€‚å› ä¸ºå¦‚æœåœ¨doInBackgroudé‡Œæœ‰ä¸€ä¸ªä¸å¯ä¸­æ–­çš„æ“ä½œï¼Œæ¯”å¦‚BitmapFactory.decodeStream()ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œä¼šç»§ç»­ä¸‹å»ã€‚</p></li><li><p><strong>å†…å­˜æ³„æ¼</strong></p><p>å¦‚æœAsyncTaskæœªå£°æ˜æˆé™æ€ï¼Œåˆ™ä¼šæŒæœ‰å¤–éƒ¨ç±»Activityçš„å¼•ç”¨ï¼Œå½“Activityé”€æ¯ä¹‹åï¼ŒAsyncTaskè¿˜åœ¨æ‰§è¡Œï¼Œå®ƒå°†åœ¨å†…å­˜ä¸­ä¾æ—§ä¿æŒè¿™ä¸ªå¼•ç”¨ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼</p></li><li><p><strong>ç»“æœä¸¢å¤±</strong></p><p>å½“å±å¹•æ—‹è½¬Activityé”€æ¯é‡æ–°åˆ›å»ºï¼ˆæœªé…ç½®android:configChanges=â€orientation|screenSizeâ€çš„æƒ…å†µï¼‰ä¹‹å‰è¿è¡Œçš„AsyncTaskä¼šæŒæœ‰ä¹‹å‰Activityçš„å¼•ç”¨ï¼Œè¿™æ—¶è°ƒç”¨onPostExecute()å†å»æ›´æ–°ç•Œé¢å°†ä¸å†ç”Ÿæ•ˆã€‚</p></li><li><p><strong>å¹¶è¡Œè¿˜æ˜¯ä¸²è¡Œ</strong></p><p>å½“æƒ³è¦ä¸²è¡Œæ‰§è¡Œæ—¶ï¼Œç›´æ¥æ‰§è¡Œexecute()æ–¹æ³•ï¼Œå¦‚æœéœ€è¦å¹¶è¡Œæ‰§è¡Œï¼Œåˆ™è¦æ‰§è¡ŒexecuteOnExecutor(Executor)ã€‚</p></li></ul><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29761059&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹åŸå‹æ¨¡å¼</title>
      <link href="/2016/12/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
      <content type="html"><![CDATA[<p>åŸå‹è®¾è®¡æ¨¡å¼çš„æ˜¯ä¸€ç§åˆ›å»ºå‹çš„è®¾è®¡æ¨¡å¼ï¼Œå¦‚æœåˆ›å»ºè¿‡ç¨‹ç¬”è®°å¤æ‚è€—æ—¶çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŸå‹è®¾è®¡æ¨¡å¼ï¼›é€šè¿‡å…‹éš†å·²æœ‰çš„å¯¹è±¡æ¥è·å–ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹å…‹éš†å¯¹è±¡çš„éƒ¨åˆ†å±æ€§å†ä½¿ç”¨ï¼Œä½¿å¾—æˆ‘ä»¬çš„ç¨‹åºæ›´åŠ é«˜æ•ˆ<br><a id="more"></a></p><h5 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h5><ul><li>å¦‚æœä¸€ä¸ªç±»çš„åˆå§‹åŒ–éœ€è¦å¾ˆå¤šèµ„æºï¼Œè¿™ä¸ªèµ„æºåŒ…æ‹¬æ•°æ®æˆ–è€…ç¡¬ä»¶èµ„æºç­‰ï¼Œé€šè¿‡åŸå‹æ‹·è´å·²æœ‰çš„å¯¹è±¡æ¥é¿å…è¿™äº›æ¶ˆè€—</li><li>é€šè¿‡newäº§ç”Ÿçš„ä¸€ä¸ªå¯¹è±¡éœ€è¦éå¸¸ç¹ççš„æ•°æ®å‡†å¤‡æˆ–è€…æƒé™ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼ã€‚</li><li>ä¸€ä¸ªå¯¹è±¡éœ€è¦æä¾›ç»™å…¶ä»–å¯¹è±¡è®¿é—®ï¼Œè€Œä¸”å„ä¸ªè°ƒç”¨è€…å¯èƒ½<strong>éƒ½</strong>éœ€è¦ä¿®æ”¹å…¶å€¼æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŸå‹æ¨¡å¼æ‹·è´å¤šä¸ªå¯¹è±¡ä¾›è°ƒç”¨è€…ä½¿ç”¨ï¼Œå³ä¿æŠ¤æ€§æ‹·è´ã€‚</li></ul><h5 id="å¦‚ä½•å®ç°"><a href="#å¦‚ä½•å®ç°" class="headerlink" title="å¦‚ä½•å®ç°"></a>å¦‚ä½•å®ç°</h5><p>é¦–å…ˆæˆ‘ä»¬å¾—å®ç°Cloneableæ¥å£ï¼Œå¤å†™cloneæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.it.fengan.designpattern.pattern;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fengan on 2017/12/22.</div><div class="line"> * email:fengan1102@gmail.com</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> String des;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> money;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> des;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDes</span><span class="params">(String des)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.des = des;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> money;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(<span class="keyword">double</span> money)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.money = money;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"Worker&#123;"</span> +</div><div class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</div><div class="line">                <span class="string">", des='"</span> + des + <span class="string">'\''</span> +</div><div class="line">                <span class="string">", money="</span> + money +</div><div class="line">                <span class="string">'&#125;'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Worker <span class="title">clone</span><span class="params">()</span> </span>&#123;</div><div class="line">        Worker worker = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            worker = (Worker) <span class="keyword">super</span>.clone();</div><div class="line">            worker.money = <span class="keyword">this</span>.money;</div><div class="line">            worker.name = <span class="keyword">this</span>.name;</div><div class="line">            worker.des = <span class="keyword">this</span>.des;</div><div class="line"></div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> worker;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong></p><ol><li>cloneè¿™ä¸ªæ–¹æ³•ä¸æ˜¯Cloneableæ¥å£ä¸­çš„ï¼ˆCloneableæ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼‰</li><li>cloneæ˜¯Objectä¸­çš„æ–¹æ³•</li><li>Cloneableæ˜¯ä¸€ä¸ªæ ‡è¯†æ¥å£ï¼Œå®ƒè¡¨æ˜è¿™ä¸ªç±»çš„å¯¹è±¡æ˜¯å¯ä»¥æ‹·è´çš„</li><li>å¦‚æœæ²¡æœ‰å®ç°Cloneableæ¥å£å´è°ƒç”¨äº†clone()å‡½æ•°å°†æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><h5 id="æµ…æ‹·è´å’Œæ·±æ‹·è´"><a href="#æµ…æ‹·è´å’Œæ·±æ‹·è´" class="headerlink" title="æµ…æ‹·è´å’Œæ·±æ‹·è´"></a>æµ…æ‹·è´å’Œæ·±æ‹·è´</h5><p><strong>æµ…æ‹·è´</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">protected</span> User <span class="title">clone</span><span class="params">()</span> </span>&#123;</div><div class="line">       User user = <span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span>&#123;</div><div class="line">           user = (User)<span class="keyword">super</span>.clone();</div><div class="line">       &#125; <span class="keyword">catch</span> (CloneNotSupportedException e)&#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> user;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨å®ç°cloneæ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸ªé—®é¢˜ï¼Œåƒä¸Šé¢é‚£æ ·ï¼Œç›´æ¥è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">user = (User)<span class="keyword">super</span>.clone();</div></pre></td></tr></table></figure><p>è¿™æ ·åªæ˜¯ç®€å•çš„æ‹·è´äº†å¯¹è±¡ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯å°†åŸå§‹æ–‡æ¡£çš„æ‰€æœ‰å­—æ®µéƒ½é‡æ–°æ„é€ äº†ä¸€ä»½ï¼Œè€Œæ˜¯å‰¯æœ¬æ–‡æ¡£çš„å­—æ®µå¼•ç”¨åŸå§‹æ–‡æ¡£çš„å­—æ®µã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fmplwxu1opj30h60alaan.jpg" alt="æµ…æ‹·è´"></p><p><strong>æ·±æ‹·è´</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> WordDocument <span class="title">clone</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            WordDocument doc = (WordDocument) <span class="keyword">super</span>.clone();</div><div class="line">            doc.mText = <span class="keyword">this</span>.mText;</div><div class="line">            doc.mImages = (ArrayList&lt;String&gt;) <span class="keyword">this</span>.mImages.clone();</div><div class="line">            <span class="keyword">return</span> doc;</div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure><h5 id="Androidä¸­çš„åº”ç”¨"><a href="#Androidä¸­çš„åº”ç”¨" class="headerlink" title="Androidä¸­çš„åº”ç”¨"></a>Androidä¸­çš„åº”ç”¨</h5><p>Intenetæºç </p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">*</div><div class="line"> * &lt;p&gt;These are the possible flags that can be used in the Intent via</div><div class="line"> * &#123;@link #setFlags&#125; and &#123;@link #addFlags&#125;.  See &#123;@link #setFlags&#125; for a list</div><div class="line"> * of all possible flags.</div><div class="line"> */</div><div class="line">public class Intent implements Parcelable, Cloneable &#123;</div><div class="line">    </div><div class="line">    ...</div><div class="line">    @Override</div><div class="line">    public Object clone() &#123;</div><div class="line">        return new Intent(this);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Intent(Intent o) &#123;</div><div class="line">        this.mAction = o.mAction;</div><div class="line">        this.mData = o.mData;</div><div class="line">        this.mType = o.mType;</div><div class="line">        this.mPackage = o.mPackage;</div><div class="line">        this.mComponent = o.mComponent;</div><div class="line">        this.mFlags = o.mFlags;</div><div class="line">        this.mContentUserHint = o.mContentUserHint;</div><div class="line">        if (o.mCategories != null) &#123;</div><div class="line">            this.mCategories = new ArraySet&lt;String&gt;(o.mCategories);</div><div class="line">        &#125;</div><div class="line">        if (o.mExtras != null) &#123;</div><div class="line">            this.mExtras = new Bundle(o.mExtras);</div><div class="line">        &#125;</div><div class="line">        if (o.mSourceBounds != null) &#123;</div><div class="line">            this.mSourceBounds = new Rect(o.mSourceBounds);</div><div class="line">        &#125;</div><div class="line">        if (o.mSelector != null) &#123;</div><div class="line">            this.mSelector = new Intent(o.mSelector);</div><div class="line">        &#125;</div><div class="line">        if (o.mClipData != null) &#123;</div><div class="line">            this.mClipData = new ClipData(o.mClipData);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯ä»¥è§åˆ°ï¼Œæˆ‘ä»¬çš„Intentæ˜¯æ·±åº¦æ‹·è´ï¼Œè€Œä¸”æ˜¯ç›´æ¥newä¸€ä¸ªçš„æ·±åº¦æ‹·è´ã€‚å¯è§å…¶è®¾è®¡åˆè¡·ä¸æ˜¯å› ä¸ºå…¶ä¸æ˜¯ä¸ºäº†è§£å†³æ„å»ºå¤æ‚å¯¹è±¡çš„èµ„æºæ¶ˆè€—é—®é¢˜ã€‚</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><ul><li>åŸå‹æ¨¡å¼æœ¬è´¨ä¸Šå°±æ˜¯å¯¹è±¡æ‹·è´ï¼Œä¸ C++ ä¸­çš„æ‹·è´æ„é€ å‡½æ•°æœ‰äº›ç±»ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´å®¹æ˜“å‡ºç°çš„é—®é¢˜ä¹Ÿéƒ½æ˜¯æ·±æ‹·è´ã€æµ…æ‹·è´ã€‚ä½¿ç”¨åŸå‹æ¨¡å¼å¯ä»¥<strong>è§£å†³æ„å»ºå¤æ‚å¯¹è±¡çš„èµ„æºæ¶ˆè€—é—®é¢˜</strong>ï¼Œèƒ½å¤Ÿåœ¨æŸäº›åœºæ™¯ä¸‹<strong>æå‡åˆ›å»ºå¯¹è±¡çš„æ•ˆç‡</strong>ã€‚è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„é€”å¾„å°±æ˜¯ä¿æŠ¤æ€§æ‹·è´ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªå¯¹è±¡å¯¹å¤–å¯èƒ½æ˜¯åªè¯»çš„ï¼Œä¸ºäº†é˜²æ­¢å¤–éƒ¨å¯¹è¿™ä¸ªåªè¯»å¯¹è±¡ä¿®æ”¹ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªå¯¹è±¡æ‹·è´çš„å½¢å¼å®ç°åªè¯»çš„é™åˆ¶ã€‚</li><li>ä¼˜ç‚¹ï¼šåŸå‹æ¨¡å¼æ˜¯åœ¨å†…å­˜ä¸­äºŒè¿›åˆ¶æµçš„æ‹·è´ï¼Œè¦æ¯”ç›´æ¥ new ä¸€ä¸ªå¯¹è±¡æ€§èƒ½å¥½å¾ˆå¤šï¼Œç‰¹åˆ«æ˜¯è¦åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…äº§ç”Ÿå¤§é‡çš„å¯¹è±¡æ—¶ï¼ŒåŸå‹æ¨¡å¼å¯ä»¥æ›´å¥½æ»´ä½“ç°å…¶ä¼˜ç‚¹ã€‚</li><li>ç¼ºç‚¹ï¼šè¿™æ—¢æ˜¯å®ƒçš„ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ï¼Œç›´æ¥åœ¨å†…å­˜ä¸­æ‹·è´ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œåœ¨å®é™…å¼€å‘ä¸­åº”è¯¥æ³¨æ„è¿™ä¸ªæ½œåœ¨é—®é¢˜</li></ul>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/2016/12/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <content type="html"><![CDATA[<p>è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½èƒ½å¾—åˆ°é€šçŸ¥å¹¶å¯ä»¥è‡ªåŠ¨ä½œå‡ºå¤„ç†</p><a id="more"></a><p>æ¯”å¦‚è¯´ï¼šæŠ¥çº¸çš„è®¢é˜…ï¼Œä¸€æ—¦è®¢é˜…ï¼Œå½“æœ‰æ–°çš„æŠ¥çº¸å‘å¸ƒï¼Œæ‰€æœ‰çš„è®¢é˜…è€…éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯</p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h3><ol><li>è§‚å¯Ÿè€…ï¼šObserverï¼Œä¹Ÿå«è®¢é˜…è€…ï¼Œå³Subscriberï¼ˆRxjavaï¼‰</li><li>è¢«è§‚å¯Ÿè€…ï¼šObservable</li></ol><h3 id="javaä¸­çš„ä½“ç°"><a href="#javaä¸­çš„ä½“ç°" class="headerlink" title="javaä¸­çš„ä½“ç°"></a>javaä¸­çš„ä½“ç°</h3><p>javaä¸­æä¾›äº†<strong>Observable</strong>å’Œ<strong>Observe</strong>æ¥å£ä¾›æˆ‘ä»¬å¿«é€Ÿå®ç°è¿™ç§æ¨¡å¼</p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><ul><li>å‡å¦‚æœ‰ä¸‹é¢è¿™æ ·çš„ä¸€ä¸ªå®ä½“ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Weather</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String description;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Weather</span><span class="params">(String description)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.description = description;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> description;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.description = description;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"Weather&#123;"</span> +</div><div class="line">                <span class="string">"description='"</span> + description + <span class="string">'\''</span> +</div><div class="line">                <span class="string">'&#125;'</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>å®šä¹‰è§‚å¯Ÿè€…æ¥å£ï¼ˆå› ä¸ºè§‚å¯Ÿè€…å¯èƒ½æœ‰å¾ˆå¤šç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰æˆä¸€ä¸ªæ¥å£ï¼Œå¦‚æœæƒ³è¦è®¢é˜…è¿™ä¸ªäº‹ä»¶ï¼Œå®ç°è¿™ä¸ªæ¥å£å³å¯ï¼Œå¦å¤–ä¸€èˆ¬è®¢é˜…ä¹‹åï¼Œåœ¨å®ç°æ¥å£ä¸­çš„æ–¹æ³•çš„å‚æ•°ä¸­ä¼šæ‹¿åˆ°å‘å¸ƒçš„æ•°æ®ï¼Œæ•°æ®çš„ç±»å‹ä¸å›ºå®šæ‰€ä»¥è¿™ä¸ªè§‚å¯Ÿè€…æ¥å£éœ€è¦å®šä¹‰èŒƒå‹ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onUpdate</span><span class="params">(Observable&lt;T&gt; observable,T data)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>å®šä¹‰è¢«è§‚å¯Ÿè€…å¯¹è±¡ï¼ˆå¯ä»¥è®¾è®¡æˆå•ä¾‹æ¨¡å¼ï¼Œç±»ä¼¼EventBusï¼Œå†…éƒ¨ç»´æŒä¸€ä¸ªé›†åˆï¼Œç”¨æ¥ä¿å­˜è§‚å¯Ÿè€…å¯¹è±¡ï¼›registeræ–¹æ³•å’Œunregisteræ–¹æ³•ç”¨æ¥å°†è§‚å¯Ÿè€…å¯¹è±¡ä»é›†åˆä¸­æ·»åŠ å’Œç§»é™¤å‡ºæ¥ï¼Œpostæ–¹æ³•ç”¨æ¥å‘å¸ƒï¼Œå¾ªç¯éå†é›†åˆï¼Œä¾æ¬¡è°ƒç”¨è§‚å¯Ÿè€…çš„ç›¸å…³å›è°ƒæ–¹æ³•ï¼Œå¹¶å°†å‘å¸ƒçš„å‚æ•°ä¼ å…¥ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.it.fengan.designpattern.pattern;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fengan on 2017/12/12.</div><div class="line"> * email:fengan1102@gmail.com</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Observable</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Observable observable;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Observable</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Observable <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (observable == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">synchronized</span> (Observable.class) &#123;</div><div class="line">                <span class="keyword">if</span> (observable == <span class="keyword">null</span>) &#123;</div><div class="line">                    observable = <span class="keyword">new</span> Observable();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> observable;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observers = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(Observer&lt;T&gt; observer)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (observer == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"observer error"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">synchronized</span> (Observable.class) &#123;</div><div class="line">            <span class="keyword">if</span> (!observers.contains(observer)) &#123;</div><div class="line">                observers.add(observer);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unregister</span><span class="params">(Observer&lt;T&gt; observer)</span> </span>&#123;</div><div class="line">        observers.remove(observer);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">post</span><span class="params">(T data)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (Observer observer : observers) &#123;</div><div class="line">            observer.onUpdate(<span class="keyword">this</span>, data);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>æ³¨å†Œå’Œåæ³¨å†Œè¿‡ç¨‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testObserver</span><span class="params">()</span> </span>&#123;</div><div class="line">        Observer&lt;Weather&gt; objectObserver1 = <span class="keyword">new</span> Observer&lt;Weather&gt;()&#123;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpdate</span><span class="params">(Observable&lt;Weather&gt; observable, Weather data)</span> </span>&#123;</div><div class="line">                Log.e(<span class="string">"testObserver"</span>, <span class="string">"objectObserver1:data="</span> + data.toString());</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        Observer&lt;Weather&gt; objectObserver2 = <span class="keyword">new</span> Observer&lt;Weather&gt;()&#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpdate</span><span class="params">(Observable&lt;Weather&gt; observable, Weather data)</span> </span>&#123;</div><div class="line">                Log.e(<span class="string">"testObserver"</span>, <span class="string">"objectObserver2:data="</span> + data.toString());</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        Observable observable = Observable.getInstance();</div><div class="line">        observable.register(objectObserver1);</div><div class="line">        observable.register(objectObserver2);</div><div class="line">        Weather weather = <span class="keyword">new</span> Weather(<span class="string">"æ™´å¤©"</span>);</div><div class="line">        observable.post(weather);</div><div class="line">        observable.unregister(objectObserver2);</div><div class="line">        observable.post(weather);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p>logcatè¾“å‡º</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">12</span><span class="number">-19</span> <span class="number">15</span>:<span class="number">18</span>:<span class="number">44.780</span> <span class="number">2004</span><span class="number">-2036</span><span class="regexp">/? E/</span><span class="string">testObserver:</span> <span class="string">objectObserver1:</span>data=Weather&#123;description=<span class="string">'æ™´å¤©'</span>&#125;</div><div class="line"><span class="number">12</span><span class="number">-19</span> <span class="number">15</span>:<span class="number">18</span>:<span class="number">44.780</span> <span class="number">2004</span><span class="number">-2036</span><span class="regexp">/? E/</span><span class="string">testObserver:</span> <span class="string">objectObserver2:</span>data=Weather&#123;description=<span class="string">'æ™´å¤©'</span>&#125;</div><div class="line"><span class="number">12</span><span class="number">-19</span> <span class="number">15</span>:<span class="number">18</span>:<span class="number">44.780</span> <span class="number">2004</span><span class="number">-2036</span><span class="regexp">/? E/</span><span class="string">testObserver:</span> <span class="string">objectObserver1:</span>data=Weather&#123;description=<span class="string">'æ™´å¤©'</span>&#125;</div></pre></td></tr></table></figure><h2 id="Androidä¸­çš„åº”ç”¨"><a href="#Androidä¸­çš„åº”ç”¨" class="headerlink" title="Androidä¸­çš„åº”ç”¨"></a>Androidä¸­çš„åº”ç”¨</h2><ul><li>ä¸€å¯¹ä¸€çš„è§‚å¯Ÿè€…ï¼ˆä¸€èˆ¬ç§°ä¹‹ä¸ºå›è°ƒï¼Œåªæœ‰ä¸€ä¸ªè§‚å¯Ÿè€…ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Button btn=<span class="keyword">new</span> Button(<span class="keyword">this</span>);</div><div class="line">btn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</div><div class="line">Log.e(<span class="string">"TAG"</span>,<span class="string">"click"</span>);</div><div class="line">&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><ul><li>åªè¦æ˜¯setç³»åˆ—çš„è®¾ç½®ç›‘å¬å™¨çš„æ–¹æ³•æœ€å¤šéƒ½åªèƒ½ç®—å›è°ƒï¼Œä½†æ˜¯æœ‰ä¸€äº›ç›‘å¬å™¨å¼addè¿›å»çš„ï¼Œè¿™ç§å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼äº†ï¼ˆæ¯”å¦‚RecyclerViewä¸­çš„addOnScrollListeneræ–¹æ³•ï¼‰</li></ul><blockquote><p>RecycleView.java</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">private</span> List&lt;OnScrollListener&gt; mScrollListeners;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Add a listener that will be notified of any changes in scroll state or position.</div><div class="line"> *</div><div class="line"> * &lt;p&gt;Components that add a listener should take care to remove it when finished.</div><div class="line"> * Other components that take ownership of a view may call &#123;<span class="doctag">@link</span> #clearOnScrollListeners()&#125;</div><div class="line"> * to remove all attached listeners.&lt;/p&gt;</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> listener listener to set or null to clear</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addOnScrollListener</span><span class="params">(OnScrollListener listener)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (mScrollListeners == <span class="keyword">null</span>) &#123;</div><div class="line">        mScrollListeners = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    &#125;</div><div class="line">    mScrollListeners.add(listener);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Remove a listener that was notified of any changes in scroll state or position.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> listener listener to set or null to clear</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeOnScrollListener</span><span class="params">(OnScrollListener listener)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (mScrollListeners != <span class="keyword">null</span>) &#123;</div><div class="line">        mScrollListeners.remove(listener);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Remove all secondary listener that were notified of any changes in scroll state or position.</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearOnScrollListeners</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (mScrollListeners != <span class="keyword">null</span>) &#123;</div><div class="line">        mScrollListeners.clear();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>Androidçš„å¹¿æ’­æœºåˆ¶ï¼Œå…¶æœ¬è´¨ä¹Ÿæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¿™é‡Œä¸ºäº†ç®€å•æ–¹ä¾¿ï¼Œç›´æ¥æ‹¿æœ¬åœ°å¹¿æ’­çš„ä»£ç è¯´æ˜ï¼Œå³LocalBroadcastManager</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">LocalBroadcastManager localBroadcastManager=LocalBroadcastManager.getInstance(<span class="keyword">this</span>);</div><div class="line">localBroadcastManager.registerReceiver(BroadcastReceiver receiver, IntentFilter filter);</div><div class="line">localBroadcastManager.unregisterReceiver(BroadcastReceiver receiver);</div><div class="line">localBroadcastManager.sendBroadcast(Intent intent)</div></pre></td></tr></table></figure><ul><li>å¼€æºåº“ï¼ˆEventBusï¼‰</li></ul><p>è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸‰ä¸ªå…¸å‹æ–¹æ³•å®ƒéƒ½å…·æœ‰ï¼Œå³æ³¨å†Œï¼Œå–æ¶ˆæ³¨å†Œï¼Œå‘é€äº‹ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">EventBus.getDefault().register(Object subscriber);</div><div class="line">EventBus.getDefault().unregister(Object subscriber);</div><div class="line"></div><div class="line">EventBus.getDefault().post(Object event);</div></pre></td></tr></table></figure><ul><li>é‡é‡çº§çš„åº“ï¼Œå®ƒå°±æ˜¯RxJava</li></ul><p>åˆ›å»ºä¸€ä¸ªè¢«è§‚å¯Ÿè€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Observable&lt;String&gt; myObservable = Observable.create(  </div><div class="line">    <span class="keyword">new</span> Observable.OnSubscribe&lt;String&gt;() &#123;  </div><div class="line">        <span class="meta">@Override</span>  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> String&gt; sub)</span> </span>&#123;  </div><div class="line">            sub.onNext(<span class="string">"Hello, world!"</span>);  </div><div class="line">            sub.onCompleted();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">);</div></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Subscriber&lt;String&gt; mySubscriber = <span class="keyword">new</span> Subscriber&lt;String&gt;() &#123;  </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123; System.out.println(s); &#125;  </div><div class="line">  </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123; &#125;  </div><div class="line">  </div><div class="line">    <span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123; &#125;  </div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>è§‚å¯Ÿè€…è¿›è¡Œäº‹ä»¶çš„è®¢é˜…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">myObservable.subscribe(mySubscriber);</div></pre></td></tr></table></figure><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=453062799&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼</title>
      <link href="/2016/12/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
      <content type="html"><![CDATA[<p>ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ï¼Œå…¶ç”¨æ„æ˜¯é’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…åˆ°<strong>å…·æœ‰å…¬å…±æ¥å£</strong>çš„<strong>ç‹¬ç«‹çš„ç±»</strong>ä¸­ï¼Œä»è€Œåœ¨ä¸å½±å“å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å¯ä»¥åˆ‡æ¢ç›¸åº”çš„ç®—æ³•ã€‚<br><a id="more"></a></p><h4 id="æœªä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹"><a href="#æœªä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹" class="headerlink" title="æœªä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹"></a>æœªä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TravelStrategy</span> </span>&#123;</div><div class="line"><span class="keyword">enum</span> Strategy&#123;</div><div class="line">WALK,PLANE,SUBWAY</div><div class="line">&#125;</div><div class="line"><span class="keyword">private</span> Strategy strategy;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">TravelStrategy</span><span class="params">(Strategy strategy)</span></span>&#123;</div><div class="line"><span class="keyword">this</span>.strategy=strategy;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(strategy==Strategy.WALK)&#123;</div><div class="line">print(<span class="string">"walk"</span>);</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(strategy==Strategy.PLANE)&#123;</div><div class="line">print(<span class="string">"plane"</span>);</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(strategy==Strategy.SUBWAY)&#123;</div><div class="line">print(<span class="string">"subway"</span>);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String str)</span></span>&#123;</div><div class="line">System.out.println(<span class="string">"å‡ºè¡Œæ—…æ¸¸çš„æ–¹å¼ä¸ºï¼š"</span>+str);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">TravelStrategy walk=<span class="keyword">new</span> TravelStrategy(Strategy.WALK);</div><div class="line">walk.travel();</div><div class="line"></div><div class="line">TravelStrategy plane=<span class="keyword">new</span> TravelStrategy(Strategy.PLANE);</div><div class="line">plane.travel();</div><div class="line"></div><div class="line">TravelStrategy subway=<span class="keyword">new</span> TravelStrategy(Strategy.SUBWAY);</div><div class="line">subway.travel();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>é€šè¿‡switchæˆ–è€…ifè¯­å¥ï¼Œæ¥åˆ¤æ–­é€‰æ‹©å“ªä¸€ç§ç­–ç•¥ç®—æ³•ï¼Œä¸€æ—¦ç­–ç•¥å¢åŠ æˆ–è€…å‡å°‘ä¿®æ”¹ï¼Œå°±ä¸å¾—ä¸å¢åŠ æ–°çš„è¯­å¥ï¼Œè¿™å°±è¿èƒŒäº†é¢å‘å¯¹è±¡çš„åŸåˆ™ä¹‹ä¸€ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚</p><h4 id="ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹"><a href="#ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹" class="headerlink" title="ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹"></a>ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹</h4><p><strong>å®šä¹‰ç­–ç•¥æ¥å£ï¼ˆæŠ½è±¡ç­–ç•¥ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å°†ä¸åŒçš„ç®—æ³•å°è£…åˆ°å®ç°è¯¥ç­–ç•¥æ¥å£çš„å…·ä½“çš„ç±»ä¸­ï¼ˆå…·ä½“ç­–ç•¥ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WalkStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span> </span>&#123;</div><div class="line">System.out.println(<span class="string">"walk"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PlaneStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span> </span>&#123;</div><div class="line">System.out.println(<span class="string">"plane"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubwayStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span> </span>&#123;</div><div class="line">System.out.println(<span class="string">"subway"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>ç­–ç•¥ç¯å¢ƒï¼ˆæŒæœ‰æŠ½è±¡ç­–ç•¥å¼•ç”¨çš„ç¯å¢ƒç±»ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TravelContext</span> </span>&#123;</div><div class="line">Strategy strategy;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Strategy <span class="title">getStrategy</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">return</span> strategy;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStrategy</span><span class="params">(Strategy strategy)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.strategy = strategy;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">if</span> (strategy != <span class="keyword">null</span>) &#123;</div><div class="line">strategy.travel();</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å…·ä½“ä½¿ç”¨</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">TravelContext travelContext=<span class="keyword">new</span> TravelContext();</div><div class="line">travelContext.setStrategy(<span class="keyword">new</span> PlaneStrategy());</div><div class="line">travelContext.travel();</div><div class="line">travelContext.setStrategy(<span class="keyword">new</span> WalkStrategy());</div><div class="line">travelContext.travel();</div><div class="line">travelContext.setStrategy(<span class="keyword">new</span> SubwayStrategy());</div><div class="line">travelContext.travel();</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>è‹¥æƒ³å¢åŠ æ–°çš„ç­–ç•¥ï¼ˆæ·»åŠ æ–°çš„ç­–ç•¥å®ç°ç±»å³å¯ï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BikeStrategy</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">travel</span><span class="params">()</span> </span>&#123;</div><div class="line">System.out.println(<span class="string">"bike"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">TravelContext travelContext=<span class="keyword">new</span> TravelContext();</div><div class="line">travelContext.setStrategy(<span class="keyword">new</span> BikeStrategy());</div><div class="line">travelContext.travel();</div></pre></td></tr></table></figure><p><strong>æ€»ç»“</strong></p><p>é¢å‘å¯¹è±¡çš„<strong>å¯¹ä¿®æ”¹å°é—­</strong>ï¼Œ<strong>å¯¹æ‰©å±•å¼€æ”¾</strong>ã€‚</p><h4 id="Androidæºç ä¸­çš„ä½¿ç”¨"><a href="#Androidæºç ä¸­çš„ä½¿ç”¨" class="headerlink" title="Androidæºç ä¸­çš„ä½¿ç”¨"></a>Androidæºç ä¸­çš„ä½¿ç”¨</h4><ul><li><strong>å±æ€§åŠ¨ç”»çš„æ’å€¼å™¨</strong></li></ul><p>ç­–ç•¥æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TypeEvaluator</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, T startValue, T endValue)</span></span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¤šä¸ªç­–ç•¥å®ç°ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Integer startValue, Integer endValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> startInt = startValue;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)(startInt + fraction * (endValue - startInt));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatEvaluator</span> <span class="keyword">implements</span> <span class="title">TypeEvaluator</span>&lt;<span class="title">Number</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Float <span class="title">evaluate</span><span class="params">(<span class="keyword">float</span> fraction, Number startValue, Number endValue)</span> </span>&#123;</div><div class="line">        <span class="keyword">float</span> startFloat = startValue.floatValue();</div><div class="line">        <span class="keyword">return</span> startFloat + fraction * (endValue.floatValue() - startFloat);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å…¶ä»–ç•¥â€¦</p><h4 id="å…¶ä»–ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹"><a href="#å…¶ä»–ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹" class="headerlink" title="å…¶ä»–ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹"></a>å…¶ä»–ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</h4><p><strong>ä¾‹å¦‚ï¼šä¸€ä¸ªç”µå•†ç±»å¹³å°ç­‰è´­ç‰©è½¦ç³»ç»Ÿï¼Œé™¤äº†æŠŠè´§å“çš„å•ä»·ä¹˜ä»¥æ•°é‡ä¹‹å¤–ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ä¼˜æƒ æ´»åŠ¨ã€‚æ¯”å¦‚è¯´ï¼Œå¯¹é«˜çº§ä¼šå‘˜æä¾›5æŠ˜ä¼˜æƒ ï¼Œå¯¹ä¸­çº§ä¼šå‘˜æä¾›7æŠ˜ä¼˜æƒ ï¼Œå¯¹åˆçº§ä¼šå‘˜æä¾›9æŠ˜ä¼˜æƒ </strong></p><p>é‚£ä¹ˆè¿™å°±æ¶‰åŠåˆ°äº†ä¸‰ç§ç®—æ³•</p><p><strong>é¦–å…ˆå®šä¹‰æŠ˜æ‰£æŠ½æ ·ç­–ç•¥æ¥å£</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MemberStrategy</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¡ç®—å›¾ä¹¦çš„ä»·æ ¼</div><div class="line">     * <span class="doctag">@param</span> booksPrice    å›¾ä¹¦çš„åŸä»·</div><div class="line">     * <span class="doctag">@return</span>    è®¡ç®—å‡ºæ‰“æŠ˜åçš„ä»·æ ¼</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calcPrice</span><span class="params">(<span class="keyword">double</span> booksPrice)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>åˆçº§ä¼šå‘˜æŠ˜æ‰£ç­–ç•¥</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimaryMemberStrategy</span> <span class="keyword">implements</span> <span class="title">MemberStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calcPrice</span><span class="params">(<span class="keyword">double</span> booksPrice)</span> </span>&#123;</div><div class="line">        </div><div class="line">        System.out.println(<span class="string">"å¯¹äºåˆçº§ä¼šå‘˜çš„9æŠ˜æŠ˜æ‰£"</span>);</div><div class="line">        <span class="keyword">return</span> booksPrice*<span class="number">0.9</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdvancedMemberStrategy</span> <span class="keyword">implements</span> <span class="title">MemberStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calcPrice</span><span class="params">(<span class="keyword">double</span> booksPrice)</span> </span>&#123;</div><div class="line">        </div><div class="line">        System.out.println(<span class="string">"å¯¹äºé«˜çº§ä¼šå‘˜çš„æŠ˜æ‰£ä¸º5æŠ˜"</span>);</div><div class="line">        <span class="keyword">return</span> booksPrice * <span class="number">0.5</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntermediateMemberStrategy</span> <span class="keyword">implements</span> <span class="title">MemberStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calcPrice</span><span class="params">(<span class="keyword">double</span> booksPrice)</span> </span>&#123;</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"å¯¹äºä¸­çº§ä¼šå‘˜çš„æŠ˜æ‰£ä¸º7æŠ˜"</span>);</div><div class="line">        <span class="keyword">return</span> booksPrice * <span class="number">0.7</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>ç­–ç•¥ç¯å¢ƒç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Price</span> </span>&#123;</div><div class="line">    <span class="comment">//æŒæœ‰ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥å¯¹è±¡</span></div><div class="line">    <span class="keyword">private</span> MemberStrategy strategy;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * æ„é€ å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥å¯¹è±¡</div><div class="line">     * <span class="doctag">@param</span> strategy    å…·ä½“çš„ç­–ç•¥å¯¹è±¡</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Price</span><span class="params">(MemberStrategy strategy)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.strategy = strategy;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è®¡ç®—å›¾ä¹¦çš„ä»·æ ¼</div><div class="line">     * <span class="doctag">@param</span> booksPrice    å›¾ä¹¦çš„åŸä»·</div><div class="line">     * <span class="doctag">@return</span>    è®¡ç®—å‡ºæ‰“æŠ˜åçš„ä»·æ ¼</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">quote</span><span class="params">(<span class="keyword">double</span> booksPrice)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.strategy.calcPrice(booksPrice);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å®¢æˆ·ç«¯çš„ä½¿ç”¨</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        <span class="comment">//é€‰æ‹©å¹¶åˆ›å»ºéœ€è¦ä½¿ç”¨çš„ç­–ç•¥å¯¹è±¡</span></div><div class="line">        MemberStrategy strategy = <span class="keyword">new</span> AdvancedMemberStrategy();</div><div class="line">        <span class="comment">//åˆ›å»ºç¯å¢ƒ</span></div><div class="line">        Price price = <span class="keyword">new</span> Price(strategy);</div><div class="line">        <span class="comment">//è®¡ç®—ä»·æ ¼</span></div><div class="line">        <span class="keyword">double</span> quote = price.quote(<span class="number">300</span>);</div><div class="line">        System.out.println(<span class="string">"å›¾ä¹¦çš„æœ€ç»ˆä»·æ ¼ä¸ºï¼š"</span> + quote);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><strong>å¯ä»¥çœ‹å‡º</strong></p><ol><li>ç­–ç•¥æ¨¡å¼çš„é‡å¿ƒä¸æ˜¯æä¾›ç®—æ³•ï¼Œè€Œæ˜¯å¯¹å¤šç§ç®—æ³•çš„å°è£…</li><li>å„ä¸ªç®—æ³•ç›¸å¯¹ç‹¬ç«‹å¹³ç­‰</li><li>ç®—æ³•å¯ä»¥ç›¸äº’åˆ‡æ¢ï¼Œä½†åœ¨åŒä¸€æ—¶åˆ»åªèƒ½ä½¿ç”¨ä¸€ç§ç­–ç•¥</li><li>é¢å‘å¯¹è±¡çš„ï¼šå¯¹ä¿®æ”¹å°é—­ï¼Œå¯¹æ‹“å±•å¼€æ”¾</li><li>é¿å…ä½¿ç”¨switchå’Œifå¤šé‡æ¡ä»¶è¯­å¥ï¼Œæ–¹ä¾¿ç»´æŠ¤</li><li>ç¼ºç‚¹ï¼šå®¢æˆ·ç«¯äº‹å…ˆçŸ¥é“æœ‰å¤šå°‘ç§ç­–ç•¥ï¼Œå¹¶ä¸”æ¯ä¸ªç­–ç•¥çš„åŒºåˆ«</li></ol><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=28864975&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Design Pattern </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼</title>
      <link href="/2016/12/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <content type="html"><![CDATA[<p>å»ºé€ è€…æ¨¡å¼ï¼Œå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—æ„å»ºè¿‡ç¨‹å¯ä»¥ä»¥åˆ†éƒ¨è¿›è¡Œçš„é“¾å¼è°ƒç”¨æ¥å®Œæˆ</p><a id="more"></a><h2 id="è‹¥ä¸ç”¨Buildæ¨¡å¼"><a href="#è‹¥ä¸ç”¨Buildæ¨¡å¼" class="headerlink" title="è‹¥ä¸ç”¨Buildæ¨¡å¼"></a>è‹¥ä¸ç”¨Buildæ¨¡å¼</h2><h3 id="å®šä¹‰ä¸€ä¸ªPersonç±»"><a href="#å®šä¹‰ä¸€ä¸ªPersonç±»" class="headerlink" title="å®šä¹‰ä¸€ä¸ªPersonç±»"></a>å®šä¹‰ä¸€ä¸ªPersonç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> height;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> weight;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.age = age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> height;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">double</span> height)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.height = height;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWeight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWeight</span><span class="params">(<span class="keyword">double</span> weight)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.weight = weight;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªæ„é€ æ–¹æ³•ã€‚"><a href="#å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªæ„é€ æ–¹æ³•ã€‚" class="headerlink" title="å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªæ„é€ æ–¹æ³•ã€‚"></a>å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªæ„é€ æ–¹æ³•ã€‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, <span class="keyword">double</span> height, <span class="keyword">double</span> weight)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line"><span class="keyword">this</span>.age = age;</div><div class="line"><span class="keyword">this</span>.height = height;</div><div class="line"><span class="keyword">this</span>.weight = weight;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å¯¹åº”ä¸åŒçš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šå®šä¹‰å¥½å‡ ç§æ„é€ æ–¹æ³•"><a href="#å¯¹åº”ä¸åŒçš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šå®šä¹‰å¥½å‡ ç§æ„é€ æ–¹æ³•" class="headerlink" title="å¯¹åº”ä¸åŒçš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šå®šä¹‰å¥½å‡ ç§æ„é€ æ–¹æ³•"></a>å¯¹åº”ä¸åŒçš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šå®šä¹‰å¥½å‡ ç§æ„é€ æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line"><span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, <span class="keyword">double</span> height)</span> </span>&#123;</div><div class="line"><span class="keyword">this</span>.name = name;</div><div class="line"><span class="keyword">this</span>.age = age;</div><div class="line"><span class="keyword">this</span>.height = height;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="ä½¿ç”¨çš„æ—¶å€™å°±å˜æˆè¿™æ ·äº†"><a href="#ä½¿ç”¨çš„æ—¶å€™å°±å˜æˆè¿™æ ·äº†" class="headerlink" title="ä½¿ç”¨çš„æ—¶å€™å°±å˜æˆè¿™æ ·äº†"></a>ä½¿ç”¨çš„æ—¶å€™å°±å˜æˆè¿™æ ·äº†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Person p1=<span class="keyword">new</span> Person();</div><div class="line">Person p2=<span class="keyword">new</span> Person(<span class="string">"å¼ ä¸‰"</span>);</div><div class="line">Person p3=<span class="keyword">new</span> Person(<span class="string">"æå››"</span>,<span class="number">18</span>);</div><div class="line">Person p4=<span class="keyword">new</span> Person(<span class="string">"ç‹äº”"</span>,<span class="number">21</span>,<span class="number">180</span>);</div><div class="line">Person p5=<span class="keyword">new</span> Person(<span class="string">"èµµå…­"</span>,<span class="number">17</span>,<span class="number">170</span>,<span class="number">65.4</span>);</div></pre></td></tr></table></figure><h3 id="è¿™æ ·çš„åå¤„ï¼š"><a href="#è¿™æ ·çš„åå¤„ï¼š" class="headerlink" title="è¿™æ ·çš„åå¤„ï¼š"></a>è¿™æ ·çš„åå¤„ï¼š</h3><ul><li>æ„é€ å‡½æ•°æœ‰å¤šä¸ªå‚æ•°ï¼Œä¸å¥½ç¡®å®šæ¯ä¸ªå‚æ•°å…·ä½“æ„æ€ï¼Œå¯è¯»æ€§ä¸å¼º</li><li>è‹¥å‚æ•°è¾ƒå¤šçš„æ—¶å€™ï¼Œéº»çƒ¦</li></ul><h2 id="è‹¥ä½¿ç”¨Builderæ¨¡å¼"><a href="#è‹¥ä½¿ç”¨Builderæ¨¡å¼" class="headerlink" title="è‹¥ä½¿ç”¨Builderæ¨¡å¼"></a>è‹¥ä½¿ç”¨Builderæ¨¡å¼</h2><h3 id="å…·ä½“ä»£ç å®ç°"><a href="#å…·ä½“ä»£ç å®ç°" class="headerlink" title="å…·ä½“ä»£ç å®ç°"></a>å…·ä½“ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> height;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">double</span> weight;</div><div class="line"></div><div class="line">    privatePerson(Builder builder) &#123;</div><div class="line">        <span class="keyword">this</span>.name=builder.name;</div><div class="line">        <span class="keyword">this</span>.age=builder.age;</div><div class="line">        <span class="keyword">this</span>.height=builder.height;</div><div class="line">        <span class="keyword">this</span>.weight=builder.weight;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.age = age;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> height;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">double</span> height)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.height = height;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWeight</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWeight</span><span class="params">(<span class="keyword">double</span> weight)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.weight = weight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span>&#123;</div><div class="line">        <span class="keyword">private</span> String name;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">double</span> height;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">double</span> weight;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">name</span><span class="params">(String name)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.name=name;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">age</span><span class="params">(<span class="keyword">int</span> age)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.age=age;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">height</span><span class="params">(<span class="keyword">double</span> height)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.height=height;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">weight</span><span class="params">(<span class="keyword">double</span> weight)</span></span>&#123;</div><div class="line">            <span class="keyword">this</span>.weight=weight;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> Person <span class="title">build</span><span class="params">()</span></span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="keyword">this</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å¤§æ¦‚æµç¨‹"><a href="#å¤§æ¦‚æµç¨‹" class="headerlink" title="å¤§æ¦‚æµç¨‹"></a>å¤§æ¦‚æµç¨‹</h3><ul><li>å®šä¹‰é™æ€Builderç±»</li><li>Builderç±»ä¸­å£°æ˜å’Œå¤–éƒ¨ç±»ä¸€æ ·çš„å˜é‡</li><li>å®šä¹‰å¤šä¸ªsetæ–¹æ³•ï¼Œè¿”å›ç»“æœä¸ºBuilderæœ¬èº«ï¼ˆthisï¼‰</li><li>Builderç±»ä¸­å¢åŠ buildï¼ˆï¼‰æ–¹æ³•ï¼Œè¿”å›å¤–éƒ¨ç±»Personå¯¹è±¡</li><li>å¤–éƒ¨ç±»Personä¸­å£°æ˜ä¸€ä¸ªå‚æ•°ä¸ºBuilderçš„æ„é€ å‡½æ•°</li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Person.Builder builder=<span class="keyword">new</span> Person.Builder();</div><div class="line">Person person=builder</div><div class="line">.name(<span class="string">"å¼ ä¸‰"</span>)</div><div class="line">.age(<span class="number">18</span>)</div><div class="line">.height(<span class="number">178.5</span>)</div><div class="line">.weight(<span class="number">67.4</span>)</div><div class="line">.build();</div></pre></td></tr></table></figure><h2 id="Androidä¸­å“ªäº›åœ°æ–¹ä½¿ç”¨åˆ°Builderæ¨¡å¼"><a href="#Androidä¸­å“ªäº›åœ°æ–¹ä½¿ç”¨åˆ°Builderæ¨¡å¼" class="headerlink" title="Androidä¸­å“ªäº›åœ°æ–¹ä½¿ç”¨åˆ°Builderæ¨¡å¼"></a>Androidä¸­å“ªäº›åœ°æ–¹ä½¿ç”¨åˆ°Builderæ¨¡å¼</h2><h3 id="å¯¹è¯æ¡†çš„åˆ›å»ºï¼ŒAlertDialog"><a href="#å¯¹è¯æ¡†çš„åˆ›å»ºï¼ŒAlertDialog" class="headerlink" title="å¯¹è¯æ¡†çš„åˆ›å»ºï¼ŒAlertDialog"></a>å¯¹è¯æ¡†çš„åˆ›å»ºï¼ŒAlertDialog</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">AlertDialog.Builder builder=<span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>);</div><div class="line">AlertDialog dialog=builder.setTitle(<span class="string">"æ ‡é¢˜"</span>)</div><div class="line">.setIcon(android.R.drawable.ic_dialog_alert)</div><div class="line">.setView(R.layout.myview)</div><div class="line">.setPositiveButton(R.string.positive, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;)</div><div class="line">.setNegativeButton(R.string.negative, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;)</div><div class="line">.create();</div><div class="line">dialog.show();</div></pre></td></tr></table></figure><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=487379429&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼</title>
      <link href="/2016/12/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <content type="html"><![CDATA[<p>Androidä¸­å•ä¾‹æ¨¡å¼æ•´ç†è®°å½•</p><a id="more"></a><ul><li>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼</li></ul><p>ä½¿ç”¨æ—¶ï¼Œå•ä¾‹æ¨¡å¼çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œä¸å…è®¸è‡ªç”±çš„æ„é€ å¯¹è±¡</p><ul><li>å•ä¾‹æ¨¡å¼ä½¿ç”¨åœºæ™¯</li></ul><p>ç¡®ä¿æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹</p><p>â€¦ â€¦</p><ul><li>å¦‚ä½•ä½¿ç”¨å•ä¾‹</li></ul><ol><li>ç§æœ‰æ„é€ å‡½æ•°ï¼Œç¦æ­¢å¤–éƒ¨ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡</li><li>é€šè¿‡ä¸€ä¸ªé™æ€æ–¹æ³•æˆ–è€…æšä¸¾æ¥æä¾›è¿”å›å•ä¾‹å®ä¾‹</li><li>ç¡®ä¿å•ä¾‹ç±»çš„å¯¹è±¡åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¸ä¼šé‡æ–°æ„å»ºå¯¹è±¡</li><li>ç¡®ä¿åœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªå®ä¾‹</li></ol><ul><li>å•ä¾‹æ¨¡å¼åˆ†ç±»</li></ul><h3 id="1-é¥¿æ±‰å¼"><a href="#1-é¥¿æ±‰å¼" class="headerlink" title="1,é¥¿æ±‰å¼"></a>1,é¥¿æ±‰å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="2-æ‡’æ±‰å¼"><a href="#2-æ‡’æ±‰å¼" class="headerlink" title="2,æ‡’æ±‰å¼"></a>2,æ‡’æ±‰å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance ;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</div><div class="line">            instance = <span class="keyword">new</span> Singleton();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><blockquote><p>é¥¿æ±‰å¼å’Œæ‡’æ±‰å¼çš„åŒºåˆ«</p></blockquote><p>é¥¿æ±‰å¼ï¼šåœ¨å£°æ˜é™æ€å¯¹è±¡çš„æ—¶å€™å°±åˆå§‹åŒ–</p><p>æ‡’æ±‰å¼ï¼šå£°æ˜ä¸€ä¸ªé™æ€å˜é‡ï¼Œå¹¶ä¸”åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceçš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–</p><p>â€‹        ä¼˜ç‚¹ï¼šå•ä¾‹åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼Œä¸€å®šç¨‹åº¦ä¸ŠèŠ‚çº¦äº†èµ„æº</p><p>â€‹                ç¼ºç‚¹ï¼šç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ä¼šåˆå§‹åŒ–ï¼Œååº”ç¨æ…¢ï¼Œæœ€å¤§çš„é—®é¢˜æ˜¯æ¯æ¬¡è°ƒç”¨getInstanceéƒ½è¿›è¡ŒåŒæ­¥ï¼Œé€ æˆäº†ä¸å¿…è¦çš„åŒæ­¥å¼€é”€ï¼Œä¸€èˆ¬ä¸ä»‹æ„è¿™ä¹ˆç”¨ã€‚</p><h3 id="3-Double-check-lockï¼ˆDCLï¼‰"><a href="#3-Double-check-lockï¼ˆDCLï¼‰" class="headerlink" title="3,Double check lockï¼ˆDCLï¼‰"></a>3,Double check lockï¼ˆDCLï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</div><div class="line">                instance = <span class="keyword">new</span> Singleton();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>DCL  :</p><p>ä»‹ç»DCL åœ¨getInstance æ–¹æ³•ä¸­ å¯¹instance è¿›è¡Œä¸¤æ¬¡åˆ¤ç©ºï¼šç›¸ä¿¡å¾ˆå¤šäººå¯¹æ­¤éƒ½æœ‰äº›ç–‘æƒ‘ã€‚ä¸ºä»€ä¹ˆè¦åˆ¤æ–­ä¸¤æ¬¡ï¼Œç¬¬ä¸€ä¸ªåˆ¤ç©ºæ˜¯ä¸ºäº†é¿å…ä¸å¿…è¦çš„åŒæ­¥ï¼Œç¬¬äºŒå±‚åˆ¤æ–­æ˜¯ä¸ºäº†åœ¨null æƒ…å†µä¸‹åˆ›å»ºå®ä¾‹ã€‚instance=new Singleton(); è¯­å¥çœ‹èµ·æ¥æ˜¯æœ‰ä»£ç ï¼Œå•å®é™…æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œæœ€ç»ˆä¼šè¢«ç¼–è¯‘æˆå¤šæ¡æ±‡ç¼–æŒ‡ä»¤ï¼Œå¤§è‡´åšäº†ä¸‰ä»¶äº‹ï¼š</p><p>1.ç»™Singleton åˆ†é…å†…å­˜</p><p>2.è°ƒç”¨Singleton çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å­—æ®µ</p><p>3.å°†instance å¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ï¼ˆæ­¤æ—¶instance å°±ä¸æ˜¯null äº†ï¼‰ä½†æ˜¯jdk 1.5 ä»¥åjava ç¼–è¯‘å™¨å…è®¸ä¹±åºæ‰§è¡Œ ã€‚æ‰€ä»¥æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯1-3-2 æˆ–è€… 1-2-3.å¦‚æœæ˜¯å‰è€…å…ˆæ‰§è¡Œ3 çš„è¯ åˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹ï¼Œinstance æ­¤æ—¶ å·²ç»æ˜¯éç©ºäº†ï¼Œæ­¤çº¿ç¨‹å°±ä¼šç›´æ¥å–èµ°instance ï¼Œç›´æ¥ä½¿ç”¨ï¼Œè¿™æ ·å°±å›å‡ºé”™ã€‚DCL å¤±æ•ˆã€‚è§£å†³æ–¹æ³• SUN å®˜æ–¹å·²ç»ç»™æˆ‘ä»¬äº†ã€‚å°†instance å®šä¹‰æˆ privatevolatilestatic Singleton instance =null: </p><p>å³å¯DCL çš„ä¼˜ç‚¹ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡ŒgetInstance æ—¶æ‰ä¼šè¢«å®ä¾‹åŒ–ï¼Œæ•ˆç‡é«˜ã€‚ç¼ºç‚¹ï¼šç¬¬ä¸€æ¬¡åŠ è½½ååº”æ…¢ï¼Œä¹Ÿç”±äºjava å†…å­˜ æ¨¡å‹çš„åŸå› å¶å°”ä¼šå¤±è´¥ï¼Œåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œæœ‰ä¸€å®šç¼ºé™·ï¼Œè™½ç„¶å‘ç”Ÿæ¦‚ç‡å¾ˆå°ã€‚(å¾ˆå¸¸ç”¨)</p><h3 id="4-é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"><a href="#4-é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼" class="headerlink" title="4.é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"></a>4.é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> SingletonHolder.instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton instance = <span class="keyword">new</span> Singleton();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>åŠ è½½singleton ç±»æ—¶ä¸ä¼šåˆå§‹åŒ–instance åªæœ‰åœ¨è°ƒç”¨getInstance æ–¹æ³•æ—¶ï¼Œæ‰ä¼šå¯¼è‡´instance è¢«åˆå§‹åŒ–,è¿™ä¸ªæ–¹æ³•ä¸ä»…èƒ½å¤Ÿç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½å¤Ÿä¿è¯ å•ä¾‹å¯¹è±¡çš„å”¯ä¸€æ€§,åŒæ—¶ä¹Ÿå»¶è¿Ÿäº†å•ä¾‹çš„å®ä¾‹åŒ–ï¼Œæ˜¯<strong>æ¨èä½¿ç”¨</strong>çš„å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼ã€‚</p><h3 id="5ï¼Œé˜²æ­¢ååºåˆ—åŒ–è¿‡ç¨‹ä¸­åˆ›å»ºå¤šä¸ªå¯¹è±¡"><a href="#5ï¼Œé˜²æ­¢ååºåˆ—åŒ–è¿‡ç¨‹ä¸­åˆ›å»ºå¤šä¸ªå¯¹è±¡" class="headerlink" title="5ï¼Œé˜²æ­¢ååºåˆ—åŒ–è¿‡ç¨‹ä¸­åˆ›å»ºå¤šä¸ªå¯¹è±¡"></a>5ï¼Œé˜²æ­¢ååºåˆ—åŒ–è¿‡ç¨‹ä¸­åˆ›å»ºå¤šä¸ªå¯¹è±¡</h3><p>åŠ å…¥ä¸‹åˆ—æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> Singleton <span class="title">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException </span>&#123;</div><div class="line">    <span class="keyword">return</span> SingletonHolder.instance;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è€Œå½“å®ç°äº†readResolveæ–¹æ³•åï¼Œjvmå°±ä¼šæœ‰readResolveè¿”å›æŒ‡å®šå¯¹è±¡ï¼Œä¹Ÿå°±ä¿è¯äº†å•ä¾‹æ€§ã€‚å®éªŒè¯æ˜ï¼Œå¦‚æœæ²¡æœ‰å£°æ˜readResolveæ–¹æ³•ï¼Œå­˜å…¥å¯¹è±¡çš„hashcodeå’Œå–å‡ºå¯¹è±¡çš„hashcodeä¸ä¸€è‡´ã€‚</p><p>æ¨èä¸‹åˆ—æ–¹å¼ï¼ˆå¦‚æœéœ€è¦åºåˆ—åŒ–çš„è¯ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> SingletonHolder.instance;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">final</span> Singleton instance = <span class="keyword">new</span> Singleton();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> Singleton <span class="title">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException </span>&#123;</div><div class="line">        <span class="keyword">return</span> SingletonHolder.instance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="6-volatileå…³é”®å­—çš„ä½¿ç”¨"><a href="#6-volatileå…³é”®å­—çš„ä½¿ç”¨" class="headerlink" title="6,volatileå…³é”®å­—çš„ä½¿ç”¨"></a>6,volatileå…³é”®å­—çš„ä½¿ç”¨</h3><p>å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸º volatile ä¹‹åï¼Œå°†å…·å¤‡ä¸¤ç§ç‰¹æ€§ï¼š</p><p>ã€€ã€€1.ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çš„çº¿ç¨‹çš„å¯è§æ€§ï¼Œè¿™é‡Œçš„â€œå¯è§æ€§â€ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œvolatile ä¿è¯äº†æ–°å€¼èƒ½ç«‹å³åŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œä»¥åŠæ¯æ¬¡ä½¿ç”¨å‰ç«‹å³ä»ä¸»å†…å­˜åˆ·æ–°ã€‚ä½†æ™®é€šå˜é‡åšä¸åˆ°è¿™ç‚¹ï¼Œæ™®é€šå˜é‡çš„å€¼åœ¨çº¿ç¨‹é—´ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜ï¼ˆè¯¦è§ï¼š<a href="http://www.cnblogs.com/zhengbin/p/6407137.html" target="_blank" rel="external">Javaå†…å­˜æ¨¡å‹</a>ï¼‰æ¥å®Œæˆã€‚</p><p>ã€€ã€€2.ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚æœ‰volatileä¿®é¥°çš„å˜é‡ï¼Œèµ‹å€¼åå¤šæ‰§è¡Œäº†ä¸€ä¸ªâ€œload addl $0x0, (%esp)â€æ“ä½œï¼Œè¿™ä¸ªæ“ä½œç›¸å½“äºä¸€ä¸ª<strong>å†…å­˜å±éšœ</strong>ï¼ˆæŒ‡ä»¤é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤é‡æ’åºåˆ°å†…å­˜å±éšœä¹‹å‰çš„ä½ç½®ï¼‰ï¼Œåªæœ‰ä¸€ä¸ªCPUè®¿é—®å†…å­˜æ—¶ï¼Œå¹¶ä¸éœ€è¦å†…å­˜å±éšœï¼›ï¼ˆä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’åºï¼šæ˜¯æŒ‡CPUé‡‡ç”¨äº†å…è®¸å°†å¤šæ¡æŒ‡ä»¤ä¸æŒ‰ç¨‹åºè§„å®šçš„é¡ºåºåˆ†å¼€å‘é€ç»™å„ç›¸åº”ç”µè·¯å•å…ƒå¤„ç†ï¼‰ã€‚</p><p>volatile æ€§èƒ½ï¼š</p><p>ã€€ã€€volatile çš„è¯»æ€§èƒ½æ¶ˆè€—ä¸æ™®é€šå˜é‡å‡ ä¹ç›¸åŒï¼Œä½†æ˜¯å†™æ“ä½œç¨æ…¢ï¼Œå› ä¸ºå®ƒéœ€è¦åœ¨æœ¬åœ°ä»£ç ä¸­æ’å…¥è®¸å¤šå†…å­˜å±éšœæŒ‡ä»¤æ¥ä¿è¯å¤„ç†å™¨ä¸å‘ç”Ÿä¹±åºæ‰§è¡Œã€‚</p><h3 id="7-Androidæºç æˆ–è€…æ¡†æ¶ä½¿ç”¨"><a href="#7-Androidæºç æˆ–è€…æ¡†æ¶ä½¿ç”¨" class="headerlink" title="7,Androidæºç æˆ–è€…æ¡†æ¶ä½¿ç”¨"></a>7,Androidæºç æˆ–è€…æ¡†æ¶ä½¿ç”¨</h3><ul><li>ImageLoader</li><li>EventBus</li><li>InputMethodManager</li><li>AccessibilityManager</li><li>ActivityManager(è‡ªå®šä¹‰å…³é—­æ‰€æœ‰Activityçš„å·¥å…·ç±»)</li></ul><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=471797594&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>éšæ»‘åŠ¨æ”¹å˜çš„çš„åŠ¨æ€çŸ©å½¢èƒŒæ™¯</title>
      <link href="/2016/10/11/%E9%9A%8F%E6%BB%91%E5%8A%A8%E6%94%B9%E5%8F%98%E7%9A%84%E7%9A%84%E5%8A%A8%E6%80%81%E7%9F%A9%E5%BD%A2%E8%83%8C%E6%99%AF/"/>
      <content type="html"><![CDATA[<p>å¯èƒ½çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜æœ‰ç‚¹æ‡µé€¼,æœ¬å±Œçš„è¡¨è¾¾èƒ½åŠ›æœ‰é™,æœ€è¿‘å·¥ä½œæ¯”è¾ƒæ¸…é—²,æœ‹å‹å…¬å¸æ­£åœ¨åšåˆ°è¿™ä¸ªæ•ˆæœ,æ‰€ä»¥å°±å¸®åŸºå‹å†™äº†ä¸€ä¸ªå°Demo.</p><a id="more"></a><h3 id="githubç§»æ­¥"><a href="#githubç§»æ­¥" class="headerlink" title="githubç§»æ­¥:"></a>githubç§»æ­¥:</h3><p><a href="https://github.com/itfengan/DynamicRectangleView" target="_blank" rel="external">https://github.com/itfengan/DynamicRectangleView</a></p><h4 id="æœ‹å‹å…¬å¸éœ€è¦è¾¾åˆ°çš„æ•ˆæœ"><a href="#æœ‹å‹å…¬å¸éœ€è¦è¾¾åˆ°çš„æ•ˆæœ" class="headerlink" title="æœ‹å‹å…¬å¸éœ€è¦è¾¾åˆ°çš„æ•ˆæœ"></a>æœ‹å‹å…¬å¸éœ€è¦è¾¾åˆ°çš„æ•ˆæœ</h4><p><img src="http://img.blog.csdn.net/20171011155803164?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZmVuZ2FuaXQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><h4 id="Demoä¸­çš„æ•ˆæœ"><a href="#Demoä¸­çš„æ•ˆæœ" class="headerlink" title="Demoä¸­çš„æ•ˆæœ"></a>Demoä¸­çš„æ•ˆæœ</h4><p><img src="http://img.blog.csdn.net/20171011155905764?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZmVuZ2FuaXQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><h3 id="ä½¿ç”¨è¿‡ç¨‹"><a href="#ä½¿ç”¨è¿‡ç¨‹" class="headerlink" title="ä½¿ç”¨è¿‡ç¨‹"></a>ä½¿ç”¨è¿‡ç¨‹</h3><h4 id="layout"><a href="#layout" class="headerlink" title="layout"></a>layout</h4><pre><code>&lt;com.fengan.dynamicrectangledemo.DynamicRectangleViewandroid:id=&quot;@+id/drv&quot;android:layout_width=&quot;match_parent&quot;android:layout_height=&quot;250dp&quot;app:fengan_limit_percent=&quot;0.2&quot;app:fengan_percent=&quot;0.5&quot;&gt;&lt;/com.fengan.dynamicrectangledemo.DynamicRectangleView&gt;</code></pre><h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><pre><code> @Overrideprotected void onCreate(Bundle savedInstanceState) {    super.onCreate(savedInstanceState);    setContentView(R.layout.activity_main);    SeekBar seekBar = (SeekBar) findViewById(R.id.sb);    final DynamicRectangleView dynamicRectangleView = (DynamicRectangleView) findViewById(R.id.drv);    seekBar.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {        @Override        public void onProgressChanged(SeekBar seekBar, int i, boolean b) {            dynamicRectangleView.setPercent((float)i/100);        }        @Override        public void onStartTrackingTouch(SeekBar seekBar) {        }        @Override        public void onStopTrackingTouch(SeekBar seekBar) {        }    });    findViewById(R.id.btn_scrollview).setOnClickListener(new View.OnClickListener() {        @Override        public void onClick(View view) {            startActivity(new Intent(MainActivity.this,ScrollViewActivity.class));        }    });}</code></pre><h4 id="attrs-xml"><a href="#attrs-xml" class="headerlink" title="attrs.xml"></a>attrs.xml</h4><p>(æœ‰çµæ€§çš„å“¥å“¥ä»¬åº”è¯¥çŒœå¾—åˆ°åˆ†åˆ«å¯¹åº”çš„ä»€ä¹ˆæ„æ€å’¯)</p><pre><code>&lt;resources&gt;&lt;declare-styleable name=&quot;DynamicRectangleView&quot;&gt;    &lt;attr name=&quot;fengan_percent&quot; format=&quot;float&quot;/&gt;    &lt;attr name=&quot;fengan_limit_percent&quot; format=&quot;float&quot;/&gt;    &lt;attr name=&quot;fengan_start_color&quot; format=&quot;color&quot;/&gt;    &lt;attr name=&quot;fengan_end_color&quot; format=&quot;color&quot;/&gt;&lt;/declare-styleable&gt;&lt;/resources&gt;</code></pre><ol><li>fengan_percent:å³ä¾§çŸ­è¾¹å å·¦ä¾§çš„ç™¾åˆ†æ¯”</li><li>fengan_limit_percent:å½“æ»‘åŠ¨åˆ°æœ€å°çš„ç™¾åˆ†æ¯”</li><li>fengan_start_color:æ¸å˜è‰²çš„åˆå§‹é¢œè‰²(ps:æœ‹å‹å…¬å¸æ•ˆæœå›¾æ˜¯æ¸å˜è‰²,å½“ç„¶ä¹Ÿå¯ä»¥ä¸éœ€è¦)</li><li>fengan_end_color:æ¸å˜è‰²çš„ç»ˆæ­¢é¢œè‰²</li></ol><blockquote><p>DynamicRectangleView.java</p></blockquote><pre><code>package com.fengan.dynamicrectangledemo;import android.content.Context;import android.content.res.TypedArray;import android.graphics.Canvas;import android.graphics.Color;import android.graphics.LinearGradient;import android.graphics.Paint;import android.graphics.Path;import android.graphics.Shader;import android.util.AttributeSet;import android.util.Log;import android.view.View;/** * Created by fengan on 2017/10/11/011. */ public class DynamicRectangleView extends View { // Default  valuesprivate final static int DEFAULT_START_COLOR = Color.parseColor(&quot;#88D94600&quot;);private final static int DEFAULT_END_COLOR = Color.parseColor(&quot;#D94600&quot;);private final static float DEFAULT_PERCENT = (float) 0.5;//å³è¾¹é«˜åº¦å å·¦è¾¹é«˜åº¦çš„ç™¾åˆ†æ¯”private final static float DEFAULT_LIMIT_PERCENT = (float) 0.2;//æœ€å°é«˜åº¦å å·¦è¾¹é«˜åº¦çš„ç™¾åˆ†æ¯”private Paint mPaint;private float OriginalRightHeight;private float OriginalLeftHeight;private float currentRightHeight;private float currentLeftHeight;private float minHeight;private float maxHeight;private int mStartColor;private int mEndColor;private float mPercent;private float mLimitPercent;private Path mPath;public DynamicRectangleView(Context context) {    this(context, null);}public DynamicRectangleView(Context context, AttributeSet attrs) {    this(context, attrs, 0);}public DynamicRectangleView(Context context, AttributeSet attrs, int defStyleAttr) {    super(context, attrs, defStyleAttr);    // Retrieve attributes from xml    final TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.DynamicRectangleView);    try {        mPercent = typedArray.getFloat(R.styleable.DynamicRectangleView_fengan_percent, DEFAULT_PERCENT);        mLimitPercent = typedArray.getFloat(R.styleable.DynamicRectangleView_fengan_percent, DEFAULT_LIMIT_PERCENT);        mStartColor = typedArray.getColor(R.styleable.DynamicRectangleView_fengan_start_color, DEFAULT_START_COLOR);        mEndColor = typedArray.getColor(R.styleable.DynamicRectangleView_fengan_end_color, DEFAULT_END_COLOR);    } finally {        typedArray.recycle();    }    initView(context);}private void initView(Context context) {    mPaint = new Paint();    mPath = new Path();    mPaint.setAntiAlias(true);//        mPaint.setColor(Color.RED);//çº¯è‰²}@Overrideprotected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {    super.onMeasure(widthMeasureSpec, heightMeasureSpec);}@Overrideprotected void onSizeChanged(int w, int h, int oldw, int oldh) {    super.onSizeChanged(w, h, oldw, oldh);    OriginalLeftHeight = getMeasuredHeight();    OriginalRightHeight = getMeasuredHeight()*mPercent;    minHeight = getMeasuredHeight() *mLimitPercent;    maxHeight = OriginalRightHeight;    //è®¾ç½®å½“å‰é«˜åº¦    currentRightHeight = OriginalRightHeight;    currentLeftHeight = OriginalLeftHeight;    // LinearGradient ç¬¬ä¸€ä¸ªå‚æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸º èµ·å§‹ä½ç½®x,y  ä¸‰å››å‚æ•°ä¸ºç»ˆç‚¹ä½ç½®x,yã€‚    // å¦‚æœxä¸å˜åˆ™ä¸ºyè½´æ¸å˜ï¼Œ yä¸å˜åˆ™ä¸ºxè½´æ¸å˜    // ç¬¬äº”ä¸ªå‚æ•°ä¸ºé¢œè‰²æ¸å˜ï¼Œæ­¤å¤„ä¸ºçº¢è‰²æ¸å˜ä¸ºç»¿è‰²    // ç¬¬ä¸ƒä¸ªå‚æ•°ä¸ºæ¸å˜æ¬¡æ•°ï¼Œå¯repeat    Shader mShader = new LinearGradient(0, 0, maxHeight, maxHeight,            new int[]{mStartColor, mEndColor},            null, Shader.TileMode.CLAMP);    // Shader.TileModeä¸‰ç§æ¨¡å¼    // REPEAT:æ²¿ç€æ¸å˜æ–¹å‘å¾ªç¯é‡å¤    // CLAMP:å¦‚æœåœ¨é¢„å…ˆå®šä¹‰çš„èŒƒå›´å¤–ç”»çš„è¯ï¼Œå°±é‡å¤è¾¹ç•Œçš„é¢œè‰²    // MIRROR:ä¸REPEATä¸€æ ·éƒ½æ˜¯å¾ªç¯é‡å¤ï¼Œä½†è¿™ä¸ªä¼šå¯¹ç§°é‡å¤    mPaint.setShader(mShader);// ç”¨Shaderä¸­å®šä¹‰å®šä¹‰çš„é¢œè‰²æ¥è¯}@Overrideprotected void onDraw(Canvas canvas) {    super.onDraw(canvas);    mPath.reset();    mPath.moveTo(0, 0);    mPath.lineTo(getMeasuredWidth(), 0);    mPath.lineTo(getMeasuredWidth(), currentRightHeight);    mPath.lineTo(0, currentLeftHeight);    mPath.close();    canvas.drawPath(mPath, mPaint);}public void setPercent(float percent) {    Log.e(&quot;fengan&quot;, &quot;percent=&quot; + percent);    currentRightHeight = OriginalRightHeight * (1 - percent);    currentLeftHeight = OriginalLeftHeight * (1 - percent);    if (currentLeftHeight &lt; minHeight) {        currentLeftHeight = minHeight;    }    if (currentRightHeight &lt; minHeight) {        currentRightHeight = minHeight;    }    postInvalidate();}}</code></pre>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Gsonå°è£…</title>
      <link href="/2016/08/21/Gson%E5%B0%81%E8%A3%85/"/>
      <content type="html"><![CDATA[<p>Gsonå°è£…</p><ul><li>Gsonå°è£…çš„å·¥å…·ç±»</li><li>javabeanå’Œé›†åˆç›¸äº’è½¬æ¢</li></ul><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by fengan on 2017/7/6/006.</div><div class="line"> */</div><div class="line"></div><div class="line">import com.google.gson.Gson;</div><div class="line">import com.google.gson.JsonArray;</div><div class="line">import com.google.gson.JsonElement;</div><div class="line">import com.google.gson.JsonParser;</div><div class="line">import com.google.gson.reflect.TypeToken;</div><div class="line"></div><div class="line">import java.util.ArrayList;</div><div class="line">import java.util.<span class="keyword">List</span>;</div><div class="line">import java.util.Map;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GsonUtil</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Gson gson = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        <span class="keyword">if</span> (gson == <span class="keyword">null</span>) &#123;</div><div class="line">            gson = <span class="keyword">new</span> Gson();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> GsonUtil() &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆjson</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> object</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String GsonString(Object object) &#123;</div><div class="line">        String gsonString = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span> (gson != <span class="keyword">null</span>) &#123;</div><div class="line">            gsonString = gson.toJson(object);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> gsonString;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆbean</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> gsonString</div><div class="line">     * <span class="doctag">@param</span> cls</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T GsonToBean(String gsonString, <span class="class"><span class="keyword">Class</span>&lt;<span class="title">T</span>&gt; <span class="title">cls</span>) </span>&#123;</div><div class="line">        T t = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span> (gson != <span class="keyword">null</span>) &#123;</div><div class="line">            t = gson.fromJson(gsonString, cls);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> t;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆlist</div><div class="line">     * æ³›å‹åœ¨ç¼–è¯‘æœŸç±»å‹è¢«æ“¦é™¤å¯¼è‡´æŠ¥é”™</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> gsonString</div><div class="line">     * <span class="doctag">@param</span> cls</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">List</span>&lt;T&gt; GsonToList(String gsonString, <span class="class"><span class="keyword">Class</span>&lt;<span class="title">T</span>&gt; <span class="title">cls</span>) </span>&#123;</div><div class="line">        <span class="keyword">List</span>&lt;T&gt; <span class="keyword">list</span> = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span> (gson != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">list</span> = gson.fromJson(gsonString, <span class="keyword">new</span> TypeToken&lt;<span class="keyword">List</span>&lt;T&gt;&gt;() &#123;</div><div class="line">            &#125;.getType());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">list</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆlist</div><div class="line">     * è§£å†³æ³›å‹é—®é¢˜</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> json</div><div class="line">     * <span class="doctag">@param</span> cls</div><div class="line">     * <span class="doctag">@param</span> &lt;T&gt;</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">List</span>&lt;T&gt; jsonToList(String json, <span class="class"><span class="keyword">Class</span>&lt;<span class="title">T</span>&gt; <span class="title">cls</span>) </span>&#123;</div><div class="line">        Gson gson = <span class="keyword">new</span> Gson();</div><div class="line">        <span class="keyword">List</span>&lt;T&gt; <span class="keyword">list</span> = <span class="keyword">new</span> ArrayList&lt;T&gt;();</div><div class="line">        JsonArray <span class="keyword">array</span> = <span class="keyword">new</span> JsonParser().parse(json).getAsJsonArray();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> JsonElement elem : <span class="keyword">array</span>) &#123;</div><div class="line">            <span class="keyword">list</span>.add(gson.fromJson(elem, cls));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">list</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆlistä¸­æœ‰mapçš„</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> gsonString</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="keyword">List</span>&lt;Map&lt;String, T&gt;&gt; GsonToListMaps(String gsonString) &#123;</div><div class="line">        <span class="keyword">List</span>&lt;Map&lt;String, T&gt;&gt; <span class="keyword">list</span> = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span> (gson != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">list</span> = gson.fromJson(gsonString,</div><div class="line">                    <span class="keyword">new</span> TypeToken&lt;<span class="keyword">List</span>&lt;Map&lt;String, T&gt;&gt;&gt;() &#123;</div><div class="line">                    &#125;.getType());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">list</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * è½¬æˆmapçš„</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span> gsonString</div><div class="line">     * <span class="doctag">@return</span></div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Map&lt;String, T&gt; GsonToMaps(String gsonString) &#123;</div><div class="line">        Map&lt;String, T&gt; map = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">if</span> (gson != <span class="keyword">null</span>) &#123;</div><div class="line">            map = gson.fromJson(gsonString, <span class="keyword">new</span> TypeToken&lt;Map&lt;String, T&gt;&gt;() &#123;</div><div class="line">            &#125;.getType());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> map;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=415792881&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>viewè¢«è½¯é”®ç›˜æŒ¡ä½å’Œç‚¹å‡»å¤–éƒ¨è½¯é”®ç›˜æ¶ˆå¤±</title>
      <link href="/2016/08/21/view%E8%A2%AB%E8%BD%AF%E9%94%AE%E7%9B%98%E6%8C%A1%E4%BD%8F%E5%92%8C%E7%82%B9%E5%87%BB%E5%A4%96%E9%83%A8%E8%BD%AF%E9%94%AE%E7%9B%98%E6%B6%88%E5%A4%B1/"/>
      <content type="html"><![CDATA[<p>è½¯é”®ç›˜é®æŒ¡å’Œç‚¹å‡»ç©ºç™½åŒºåŸŸå…³é—­é”®ç›˜</p><a id="more"></a><h3 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h3><ul><li>ç™»é™†buttonæŒ¡ä½è¾“å…¥æ¡†</li><li>è½¯é”®ç›˜å¼¹å‡ºæŒ¡ä½å…¶ä»–æ§ä»¶</li><li>è½¯é”®ç›˜å¼¹å‡ºï¼Œç‚¹å‡»ç©ºç™½åŒºåŸŸå…³é—­è½¯ä»¶ç›˜</li></ul><h4 id="ç‚¹å‡»buttonï¼Œé”®ç›˜å°†buttoné¡¶ä¸Šå»"><a href="#ç‚¹å‡»buttonï¼Œé”®ç›˜å°†buttoné¡¶ä¸Šå»" class="headerlink" title="ç‚¹å‡»buttonï¼Œé”®ç›˜å°†buttoné¡¶ä¸Šå»"></a>ç‚¹å‡»buttonï¼Œé”®ç›˜å°†buttoné¡¶ä¸Šå»</h4><blockquote><p><img src="http://img.blog.csdn.net/20170615102440904?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZmVuZ2FuaXQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="å¼•ç”¨å—å†…å®¹"></p></blockquote><pre><code>//    æ§åˆ¶æ˜¯å¦ç§»åŠ¨å¸ƒå±€ã€‚æ¯”å¦‚åªæœ‰å¯†ç è¾“å…¥æ¡†è·å–åˆ°ç„¦ç‚¹æ—¶æ‰æ‰§è¡Œã€‚public  boolean flag = true;/** * @param act          activiryç”¨äºè·å–åº•éƒ¨å¯¼èˆªæ é«˜åº¦ã€‚ * @param root         æœ€å¤–å±‚å¸ƒå±€ï¼Œéœ€è¦è°ƒæ•´çš„å¸ƒå±€ * @param scrollToView è¢«é”®ç›˜é®æŒ¡çš„scrollToViewï¼Œæ»šåŠ¨root,ä½¿scrollToViewåœ¨rootå¯è§†åŒºåŸŸçš„åº•éƒ¨ */public  void controlKeyboardLayout(Context act, final View root, final View scrollToView) {    final int navigationBarHeight = getNavigationBarHeight(act);    root.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {        @Override        public void onGlobalLayout() {            Rect rect = new Rect();            //è·å–rootåœ¨çª—ä½“çš„å¯è§†åŒºåŸŸ            root.getWindowVisibleDisplayFrame(rect);            //è·å–rootåœ¨çª—ä½“çš„ä¸å¯è§†åŒºåŸŸé«˜åº¦(è¢«å…¶ä»–Viewé®æŒ¡çš„åŒºåŸŸé«˜åº¦)            int rootInvisibleHeight = root.getRootView().getHeight() - rect.bottom;            //è‹¥ä¸å¯è§†åŒºåŸŸé«˜åº¦å¤§äº100ï¼Œåˆ™é”®ç›˜æ˜¾ç¤º            if (rootInvisibleHeight &gt; navigationBarHeight &amp;&amp; flag) {                int[] location = new int[2];                //è·å–scrollToViewåœ¨çª—ä½“çš„åæ ‡                scrollToView.getLocationInWindow(location);                //è®¡ç®—rootæ»šåŠ¨é«˜åº¦ï¼Œä½¿scrollToViewåœ¨å¯è§åŒºåŸŸ                int srollHeight = (location[1] + scrollToView.getHeight()) - rect.bottom;                if (root.getScrollY() != 0) {// å¦‚æœå·²ç»æ»šåŠ¨ï¼Œè¦æ ¹æ®ä¸Šæ¬¡æ»šåŠ¨ï¼Œé‡æ–°è®¡ç®—ä½ç½®ã€‚                    srollHeight += root.getScrollY();                }                root.scrollTo(0, srollHeight);            } else {                //é”®ç›˜éšè—                root.scrollTo(0, 0);            }        }    });}</code></pre><h3 id="è§£å†³æ§åˆ¶ç‚¹å‡»å¯é€‰æ‹©çš„åŒºåŸŸè®©è½¯é”®ç›˜æ¶ˆå¤±æˆ–è€…ä¸æ¶ˆå¤±"><a href="#è§£å†³æ§åˆ¶ç‚¹å‡»å¯é€‰æ‹©çš„åŒºåŸŸè®©è½¯é”®ç›˜æ¶ˆå¤±æˆ–è€…ä¸æ¶ˆå¤±" class="headerlink" title="è§£å†³æ§åˆ¶ç‚¹å‡»å¯é€‰æ‹©çš„åŒºåŸŸè®©è½¯é”®ç›˜æ¶ˆå¤±æˆ–è€…ä¸æ¶ˆå¤±"></a>è§£å†³æ§åˆ¶ç‚¹å‡»å¯é€‰æ‹©çš„åŒºåŸŸè®©è½¯é”®ç›˜æ¶ˆå¤±æˆ–è€…ä¸æ¶ˆå¤±</h3><pre><code>  /** * è·å–åº•éƒ¨å¯¼èˆªæ é«˜åº¦ * * @param act * @return */private  int getNavigationBarHeight(Context act) {    Resources resources = act.getResources();    int resourceId = resources.getIdentifier(&quot;navigation_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);    int height = resources.getDimensionPixelSize(resourceId);    Log.v(&quot;dbw&quot;, &quot;Navi height:&quot; + height);    return height;}//è½¯é”®ç›˜æ¶ˆå¤±çš„ç®¡ç†//regionè½¯é”®ç›˜çš„å¤„ç†/** * æ¸…é™¤editTextçš„ç„¦ç‚¹ * * @param v   ç„¦ç‚¹æ‰€åœ¨View * @param ids è¾“å…¥æ¡† */public void clearViewFocus(View v, int... ids) {    if (null != v &amp;&amp; null != ids &amp;&amp; ids.length &gt; 0) {        for (int id : ids) {            if (v.getId() == id) {                v.clearFocus();                break;            }        }    }}/** * éšè—é”®ç›˜ * * @param v   ç„¦ç‚¹æ‰€åœ¨View * @param ids è¾“å…¥æ¡† * @return trueä»£è¡¨ç„¦ç‚¹åœ¨editä¸Š */public boolean isFocusEditText(View v, int... ids) {    if (v instanceof EditText) {        EditText tmp_et = (EditText) v;        for (int id : ids) {            if (tmp_et.getId() == id) {                return true;            }        }    }    return false;}//æ˜¯å¦è§¦æ‘¸åœ¨æŒ‡å®šviewä¸Šé¢,å¯¹æŸä¸ªæ§ä»¶è¿‡æ»¤public boolean isTouchView(View[] views, MotionEvent ev) {    if (views == null || views.length == 0) return false;    int[] location = new int[2];    for (View view : views) {        view.getLocationOnScreen(location);        int x = location[0];        int y = location[1];        if (ev.getX() &gt; x &amp;&amp; ev.getX() &lt; (x + view.getWidth())                &amp;&amp; ev.getY() &gt; y &amp;&amp; ev.getY() &lt; (y + view.getHeight())) {            return true;        }    }    return false;}//region å³æ»‘è¿”å›ä¸Šçº§@Overridepublic boolean dispatchTouchEvent(MotionEvent ev) {    if (ev.getAction() == MotionEvent.ACTION_DOWN) {        if (isTouchView(filterViewByIds(), ev)) return super.dispatchTouchEvent(ev);        if (hideSoftByEditViewIds() == null || hideSoftByEditViewIds().length == 0)            return super.dispatchTouchEvent(ev);        View v = getCurrentFocus();        if (isFocusEditText(v, hideSoftByEditViewIds())) {            //éšè—é”®ç›˜            hideInputForce(this);            clearViewFocus(v, hideSoftByEditViewIds());        }    }    return super.dispatchTouchEvent(ev);}/** * ä¼ å…¥EditTextçš„Id * æ²¡æœ‰ä¼ å…¥çš„EditTextä¸åšå¤„ç† * * @return id æ•°ç»„ */public int[] hideSoftByEditViewIds() {    return null;}/** * ä¼ å…¥è¦è¿‡æ»¤çš„View * è¿‡æ»¤ä¹‹åç‚¹å‡»å°†ä¸ä¼šæœ‰éšè—è½¯é”®ç›˜çš„æ“ä½œ * * @return id æ•°ç»„ */public View[] filterViewByIds() {    return null;}/** * des:éšè—è½¯é”®ç›˜,è¿™ç§æ–¹å¼å‚æ•°ä¸ºactivity * * @param activity */public static void hideInputForce(Activity activity) {    if (activity == null || activity.getCurrentFocus() == null)        return;    ((InputMethodManager) activity.getSystemService(INPUT_METHOD_SERVICE))            .hideSoftInputFromWindow(activity.getCurrentFocus()                    .getWindowToken(), InputMethodManager.HIDE_NOT_ALWAYS);}</code></pre><h3 id="ä»¥ä¸‹Demoå…¨éƒ¨ä»£ç "><a href="#ä»¥ä¸‹Demoå…¨éƒ¨ä»£ç " class="headerlink" title="ä»¥ä¸‹Demoå…¨éƒ¨ä»£ç "></a>ä»¥ä¸‹Demoå…¨éƒ¨ä»£ç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line"><span class="keyword">private</span> EditText mEt1;</div><div class="line"><span class="keyword">private</span> EditText mEt2;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">    setContentView(R.layout.activity_main);</div><div class="line">    Button btn = (Button) findViewById(R.id.btn);</div><div class="line">    mEt1 = (EditText) findViewById(R.id.et1);</div><div class="line">    mEt2 = (EditText) findViewById(R.id.et2);</div><div class="line">    LinearLayout LL = (LinearLayout) findViewById(R.id.LL);</div><div class="line">    controlKeyboardLayout(<span class="keyword">this</span>,LL,btn);</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//    æ§åˆ¶æ˜¯å¦ç§»åŠ¨å¸ƒå±€ã€‚æ¯”å¦‚åªæœ‰å¯†ç è¾“å…¥æ¡†è·å–åˆ°ç„¦ç‚¹æ—¶æ‰æ‰§è¡Œã€‚</span></div><div class="line"><span class="keyword">public</span>  <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> act          activiryç”¨äºè·å–åº•éƒ¨å¯¼èˆªæ é«˜åº¦ã€‚</div><div class="line"> * <span class="doctag">@param</span> root         æœ€å¤–å±‚å¸ƒå±€ï¼Œéœ€è¦è°ƒæ•´çš„å¸ƒå±€</div><div class="line"> * <span class="doctag">@param</span> scrollToView è¢«é”®ç›˜é®æŒ¡çš„scrollToViewï¼Œæ»šåŠ¨root,ä½¿scrollToViewåœ¨rootå¯è§†åŒºåŸŸçš„åº•éƒ¨</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">controlKeyboardLayout</span><span class="params">(Context act, <span class="keyword">final</span> View root, <span class="keyword">final</span> View scrollToView)</span> </span>&#123;</div><div class="line">    <span class="keyword">final</span> <span class="keyword">int</span> navigationBarHeight = getNavigationBarHeight(act);</div><div class="line"></div><div class="line">    root.getViewTreeObserver().addOnGlobalLayoutListener(<span class="keyword">new</span> ViewTreeObserver.OnGlobalLayoutListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onGlobalLayout</span><span class="params">()</span> </span>&#123;</div><div class="line">            Rect rect = <span class="keyword">new</span> Rect();</div><div class="line">            <span class="comment">//è·å–rootåœ¨çª—ä½“çš„å¯è§†åŒºåŸŸ</span></div><div class="line">            root.getWindowVisibleDisplayFrame(rect);</div><div class="line">            <span class="comment">//è·å–rootåœ¨çª—ä½“çš„ä¸å¯è§†åŒºåŸŸé«˜åº¦(è¢«å…¶ä»–Viewé®æŒ¡çš„åŒºåŸŸé«˜åº¦)</span></div><div class="line">            <span class="keyword">int</span> rootInvisibleHeight = root.getRootView().getHeight() - rect.bottom;</div><div class="line">            <span class="comment">//è‹¥ä¸å¯è§†åŒºåŸŸé«˜åº¦å¤§äº100ï¼Œåˆ™é”®ç›˜æ˜¾ç¤º</span></div><div class="line">            <span class="keyword">if</span> (rootInvisibleHeight &gt; navigationBarHeight &amp;&amp; flag) &#123;</div><div class="line">                <span class="keyword">int</span>[] location = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">                <span class="comment">//è·å–scrollToViewåœ¨çª—ä½“çš„åæ ‡</span></div><div class="line">                scrollToView.getLocationInWindow(location);</div><div class="line">                <span class="comment">//è®¡ç®—rootæ»šåŠ¨é«˜åº¦ï¼Œä½¿scrollToViewåœ¨å¯è§åŒºåŸŸ</span></div><div class="line">                <span class="keyword">int</span> srollHeight = (location[<span class="number">1</span>] + scrollToView.getHeight()) - rect.bottom;</div><div class="line">                <span class="keyword">if</span> (root.getScrollY() != <span class="number">0</span>) &#123;<span class="comment">// å¦‚æœå·²ç»æ»šåŠ¨ï¼Œè¦æ ¹æ®ä¸Šæ¬¡æ»šåŠ¨ï¼Œé‡æ–°è®¡ç®—ä½ç½®ã€‚</span></div><div class="line">                    srollHeight += root.getScrollY();</div><div class="line">                &#125;</div><div class="line">                root.scrollTo(<span class="number">0</span>, srollHeight);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//é”®ç›˜éšè—</span></div><div class="line">                root.scrollTo(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * è·å–åº•éƒ¨å¯¼èˆªæ é«˜åº¦</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> act</div><div class="line"> * <span class="doctag">@return</span></div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">private</span>  <span class="keyword">int</span> <span class="title">getNavigationBarHeight</span><span class="params">(Context act)</span> </span>&#123;</div><div class="line">    Resources resources = act.getResources();</div><div class="line">    <span class="keyword">int</span> resourceId = resources.getIdentifier(<span class="string">"navigation_bar_height"</span>, <span class="string">"dimen"</span>, <span class="string">"android"</span>);</div><div class="line">    <span class="keyword">int</span> height = resources.getDimensionPixelSize(resourceId);</div><div class="line">    Log.v(<span class="string">"dbw"</span>, <span class="string">"Navi height:"</span> + height);</div><div class="line">    <span class="keyword">return</span> height;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è½¯é”®ç›˜æ¶ˆå¤±çš„ç®¡ç†</span></div><div class="line"><span class="comment">//regionè½¯é”®ç›˜çš„å¤„ç†</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * æ¸…é™¤editTextçš„ç„¦ç‚¹</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> v   ç„¦ç‚¹æ‰€åœ¨View</div><div class="line"> * <span class="doctag">@param</span> ids è¾“å…¥æ¡†</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clearViewFocus</span><span class="params">(View v, <span class="keyword">int</span>... ids)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != v &amp;&amp; <span class="keyword">null</span> != ids &amp;&amp; ids.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> id : ids) &#123;</div><div class="line">            <span class="keyword">if</span> (v.getId() == id) &#123;</div><div class="line">                v.clearFocus();</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * éšè—é”®ç›˜</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> v   ç„¦ç‚¹æ‰€åœ¨View</div><div class="line"> * <span class="doctag">@param</span> ids è¾“å…¥æ¡†</div><div class="line"> * <span class="doctag">@return</span> trueä»£è¡¨ç„¦ç‚¹åœ¨editä¸Š</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFocusEditText</span><span class="params">(View v, <span class="keyword">int</span>... ids)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (v <span class="keyword">instanceof</span> EditText) &#123;</div><div class="line">        EditText tmp_et = (EditText) v;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> id : ids) &#123;</div><div class="line">            <span class="keyword">if</span> (tmp_et.getId() == id) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ˜¯å¦è§¦æ‘¸åœ¨æŒ‡å®šviewä¸Šé¢,å¯¹æŸä¸ªæ§ä»¶è¿‡æ»¤</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isTouchView</span><span class="params">(View[] views, MotionEvent ev)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (views == <span class="keyword">null</span> || views.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span>[] location = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</div><div class="line">    <span class="keyword">for</span> (View view : views) &#123;</div><div class="line">        view.getLocationOnScreen(location);</div><div class="line">        <span class="keyword">int</span> x = location[<span class="number">0</span>];</div><div class="line">        <span class="keyword">int</span> y = location[<span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> (ev.getX() &gt; x &amp;&amp; ev.getX() &lt; (x + view.getWidth())</div><div class="line">                &amp;&amp; ev.getY() &gt; y &amp;&amp; ev.getY() &lt; (y + view.getHeight())) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//region å³æ»‘è¿”å›ä¸Šçº§</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent ev)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (ev.getAction() == MotionEvent.ACTION_DOWN) &#123;</div><div class="line">        <span class="keyword">if</span> (isTouchView(filterViewByIds(), ev)) <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">        <span class="keyword">if</span> (hideSoftByEditViewIds() == <span class="keyword">null</span> || hideSoftByEditViewIds().length == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">        View v = getCurrentFocus();</div><div class="line">        <span class="keyword">if</span> (isFocusEditText(v, hideSoftByEditViewIds())) &#123;</div><div class="line">            <span class="comment">//éšè—é”®ç›˜</span></div><div class="line">            hideInputForce(<span class="keyword">this</span>);</div><div class="line">            clearViewFocus(v, hideSoftByEditViewIds());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * ä¼ å…¥EditTextçš„Id</div><div class="line"> * æ²¡æœ‰ä¼ å…¥çš„EditTextä¸åšå¤„ç†</div><div class="line"> *</div><div class="line"> * <span class="doctag">@return</span> id æ•°ç»„</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] hideSoftByEditViewIds() &#123;</div><div class="line">    <span class="keyword">int</span> []  ids = &#123;R.id.et1,R.id.et2&#125;;</div><div class="line">    <span class="keyword">return</span> ids;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * ä¼ å…¥è¦è¿‡æ»¤çš„View</div><div class="line"> * è¿‡æ»¤ä¹‹åç‚¹å‡»å°†ä¸ä¼šæœ‰éšè—è½¯é”®ç›˜çš„æ“ä½œ</div><div class="line"> *</div><div class="line"> * <span class="doctag">@return</span> id æ•°ç»„</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> View[] filterViewByIds() &#123;</div><div class="line">    View [] views = &#123;mEt1,mEt2&#125;;<span class="comment">//ç‚¹å‡»è¿™ä¸¤ä¸ªæ§ä»¶,è½¯é”®ç›˜ä¸ä¼šæ¶ˆå¤±</span></div><div class="line">    <span class="keyword">return</span> views;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * des:éšè—è½¯é”®ç›˜,è¿™ç§æ–¹å¼å‚æ•°ä¸ºactivity</div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> activity</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">hideInputForce</span><span class="params">(Activity activity)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (activity == <span class="keyword">null</span> || activity.getCurrentFocus() == <span class="keyword">null</span>)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line"></div><div class="line">    ((InputMethodManager) activity.getSystemService(INPUT_METHOD_SERVICE))</div><div class="line">            .hideSoftInputFromWindow(activity.getCurrentFocus()</div><div class="line">                    .getWindowToken(), InputMethodManager.HIDE_NOT_ALWAYS);</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="ä»¥ä¸‹æ˜¯å¸ƒå±€æ–‡ä»¶"><a href="#ä»¥ä¸‹æ˜¯å¸ƒå±€æ–‡ä»¶" class="headerlink" title="ä»¥ä¸‹æ˜¯å¸ƒå±€æ–‡ä»¶"></a>ä»¥ä¸‹æ˜¯å¸ƒå±€æ–‡ä»¶</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line"><span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line"><span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line"><span class="attr">android:id</span>=<span class="string">"@+id/activity_main"</span></div><div class="line"><span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line"><span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line"><span class="attr">android:orientation</span>=<span class="string">"vertical"</span></div><div class="line"><span class="attr">tools:context</span>=<span class="string">"fengan.softinputdemo.MainActivity"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/LL"</span></div><div class="line">    <span class="attr">android:layout_marginTop</span>=<span class="string">"100dp"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</div><div class="line"><span class="tag">&lt;<span class="name">EditText</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/et1"</span></div><div class="line">    <span class="attr">android:layout_marginTop</span>=<span class="string">"60dp"</span></div><div class="line">    <span class="attr">android:background</span>=<span class="string">"#ff0"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"60dp"</span>/&gt;</div><div class="line"><span class="tag">&lt;<span class="name">EditText</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/et2"</span></div><div class="line">    <span class="attr">android:layout_marginTop</span>=<span class="string">"20dp"</span></div><div class="line">    <span class="attr">android:background</span>=<span class="string">"#ff0"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"60dp"</span>/&gt;</div><div class="line"><span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">    <span class="attr">android:text</span>=<span class="string">"è½¯é”®ç›˜æŒ¡ä½button"</span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/btn"</span></div><div class="line">    <span class="attr">android:layout_marginTop</span>=<span class="string">"30dp"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure><ul><li>å¯ä»¥å°†éšè—æ˜¾ç¤ºçš„ä»£ç å°è£…åˆ°BaseActivity</li></ul><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=448707059&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°</title>
      <link href="/2016/08/21/%E4%BF%9D%E5%AD%98%E5%9B%BE%E7%89%87%E5%88%B0%E6%9C%AC%E5%9C%B0/"/>
      <content type="html"><![CDATA[<p>ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚,å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°,çŸ«æ­£å›¾ç‰‡è§’åº¦ï¼Œé€šçŸ¥å›¾åº“æ›´æ–°<br><a id="more"></a></p><blockquote><p>æ­¥éª¤</p></blockquote><ol><li>ä½¿ç”¨Gildeè·å–å›¾ç‰‡çš„Drawable</li><li>Drawableè½¬æˆBitmap</li><li>bigtmapå‹ç¼©å¹¶é€šè¿‡æµå†™å…¥</li><li>é€šçŸ¥ç³»ç»Ÿå›¾åº“æ›´æ–°</li></ol><blockquote><p>ä»£ç å—</p></blockquote><ul><li>ä¿å­˜å›¾ç‰‡,æµå†™å…¥,å‹ç¼©</li><li><pre><code>public static void saveImageToGallery(Context context, Bitmap bmp) {File appDir = new File(Environment.getExternalStorageDirectory(), &quot;fengandev&quot;);if (!appDir.exists()) {    appDir.mkdir();}String fileName = System.currentTimeMillis() + &quot;.jpg&quot;;File file = new File(appDir, fileName);try {    FileOutputStream fos = new FileOutputStream(file);    bmp.compress(Bitmap.CompressFormat.JPEG, 100, fos);    fos.flush();    fos.close();} catch (FileNotFoundException e) {    e.printStackTrace();} catch (IOException e) {    e.printStackTrace();}// å…¶æ¬¡æŠŠæ–‡ä»¶æ’å…¥åˆ°ç³»ç»Ÿå›¾åº“try {    MediaStore.Images.Media.insertImage(context.getContentResolver(),            file.getAbsolutePath(), fileName, null);} catch (FileNotFoundException e) {    e.printStackTrace();}// æœ€åé€šçŸ¥å›¾åº“æ›´æ–°context.sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.fromFile(new File(file.getPath()))));ToastUtil.showShort(&quot;ä¿å­˜åˆ°&quot; + file.getPath());</code></pre><p>  }`</p><blockquote><p>é€šè¿‡glideå›è°ƒ,è·å–å›¾ç‰‡Drawable</p></blockquote></li></ul><pre><code>  mTvSave.setOnClickListener(new View.OnClickListener() {    @Override    public void onClick(View v) {        showLoadding();        GlideUtils.loadImage(Utils.getContext(), imaUrl), mIvImg,new GlideUtils.ImageLoadListener&lt;String, GlideDrawable&gt;() {            @Override            public void onLoadingComplete(String uri, ImageView view, GlideDrawable resource) {                FileUtils.saveImageToGallery(Utils.getContext(), BitmapUtils.drawableToBitmap(resource));            }            @Override            public void onLoadingError(String source, Exception e) {                showState(&quot;ä¿å­˜å¤±è´¥&quot;,0);            }        });    }});</code></pre><blockquote><p>åˆ†äº«ä¸€ä¸ªGlideå°è£…</p></blockquote><ul><li>Glideå°è£…ç±»</li></ul><pre><code>public abstract class GlideUtils {/** * ç®€å•å›¾ç‰‡åŠ è½½å›è°ƒ * * @param &lt;T&gt; å›¾ç‰‡url æˆ–èµ„æºid æˆ– æ–‡ä»¶ * @param &lt;K&gt; è¿”å›çš„èµ„æº,GlideDrawableæˆ–è€…Bitmapæˆ–è€…GifDrawable,ImageView.setImageRecourseè®¾ç½® */public interface ImageLoadListener&lt;T, K&gt; {    /**     * å›¾ç‰‡åŠ è½½æˆåŠŸå›è°ƒ     *     * @param uri      å›¾ç‰‡url æˆ–èµ„æºid æˆ– æ–‡ä»¶     * @param view     ç›®æ ‡è½½ä½“ï¼Œä¸ä¼ åˆ™ä¸ºç©º     * @param resource è¿”å›çš„èµ„æº,GlideDrawableæˆ–è€…Bitmapæˆ–è€…GifDrawable,ImageView.setImageRecourseè®¾ç½®     */    void onLoadingComplete(T uri, ImageView view, K resource);    /**     * å›¾ç‰‡åŠ è½½å¼‚å¸¸è¿”å›     *     * @param source å›¾ç‰‡åœ°å€ã€Fileã€èµ„æºid     * @param e      å¼‚å¸¸ä¿¡æ¯     */    void onLoadingError(T source, Exception e);}/** * è¯¦ç»†åŠ è½½å›¾ç‰‡åŠ è½½å›è°ƒ * * @param &lt;T&gt; å›¾ç‰‡url æˆ–èµ„æºid æˆ– æ–‡ä»¶ * @param &lt;K&gt; è¿”å›çš„èµ„æº */public interface ImageLoadDetailListener&lt;T, K&gt; {    /**     * å›¾ç‰‡åŠ è½½æˆåŠŸå›è°ƒ     *     * @param uri      å›¾ç‰‡url æˆ–èµ„æºid æˆ– æ–‡ä»¶     * @param view     ç›®æ ‡è½½ä½“ï¼Œä¸ä¼ åˆ™ä¸ºç©º     * @param resource è¿”å›çš„èµ„æº,GlideDrawableæˆ–è€…Bitmapæˆ–è€…GifDrawable,ImageView.setImageRecourseè®¾ç½®     */    void onLoadingComplete(T uri, ImageView view, K resource);    /**     * å›¾ç‰‡åŠ è½½å¼‚å¸¸è¿”å›     *     * @param source        å›¾ç‰‡åœ°å€ã€Fileã€èµ„æºid     * @param errorDrawable åŠ è½½é”™è¯¯å ä½å›¾     * @param e             å¼‚å¸¸ä¿¡æ¯     */    void onLoadingError(T source, Drawable errorDrawable, Exception e);    /**     * åŠ è½½å¼€å§‹     *     * @param source      å›¾ç‰‡æ¥æº     * @param placeHolder å¼€å§‹åŠ è½½å ä½å›¾     */    void onLoadingStart(T source, Drawable placeHolder);}/** * æ ¹æ®ä¸Šä¸‹æ–‡å’Œ urlè·å– Glideçš„DrawableTypeRequest * * @param context ä¸Šä¸‹æ–‡ * @param url     å›¾ç‰‡è¿æ¥ * @param &lt;T&gt;     Contextç±»å‹ * @param &lt;K&gt;     urlç±»å‹ * @return è¿”å›DrawableTypeRequst&lt;K&gt; ç±»å‹ */private static &lt;T, K&gt; DrawableTypeRequest&lt;K&gt; getDrawableTypeRequest(T context, K url) {    DrawableTypeRequest&lt;K&gt; type = null;    try {        if (context instanceof android.support.v4.app.Fragment) {            type = Glide.with((android.support.v4.app.Fragment) context).load(url);        } else if (context instanceof android.app.Fragment) {            type = Glide.with((android.app.Fragment) context).load(url);        } else if (context instanceof Activity) {    //åŒ…æ‹¬FragmentActivity            type = Glide.with((Activity) context).load(url);        } else if (context instanceof Context) {            type = Glide.with((Context) context).load(url);        }    } catch (Exception e) {        e.printStackTrace();    }    return type;}/** * å›¾ç‰‡åŠ è½½ç›‘å¬ç±» * * @param &lt;T&gt; å›¾ç‰‡é“¾æ¥ çš„ç±»å‹ * @param &lt;K&gt; å›¾ç‰‡èµ„æºè¿”å›ç±»å‹ * @param &lt;Z&gt; è¿”å›çš„å›¾ç‰‡url */private static class GlideListener&lt;T, K, Z&gt; implements RequestListener&lt;T, K&gt; {    ImageLoadListener&lt;Z, K&gt; imageLoadListener = null;    Z url;    ImageView imageView = null;    GlideListener(ImageLoadListener&lt;Z, K&gt; imageLoadListener, Z url, ImageView view) {        this.imageLoadListener = imageLoadListener;        this.url = url;        this.imageView = view;    }    GlideListener(ImageLoadListener&lt;Z, K&gt; imageLoadListener, Z url) {        this.imageLoadListener = imageLoadListener;        this.url = url;    }    GlideListener(Z url) {        this.url = url;    }    @Override    public boolean onResourceReady(K resource, T model, Target&lt;K&gt; target, boolean isFromMemoryCache, boolean isFirstResource) {        if (null != imageLoadListener) {            if (imageView != null) {                imageLoadListener.onLoadingComplete(url, imageView, resource);            } else {                imageLoadListener.onLoadingComplete(url, null, resource);            }        }        return false;    }    @Override    public boolean onException(Exception e, T model, Target&lt;K&gt; target, boolean isFirstResource) {        //LogUtil.e(&quot;Glideå›¾ç‰‡åŠ è½½å¤±è´¥:&quot;+e + &quot; åœ°å€ä¸º:&quot;+url);        if (imageLoadListener != null) {            imageLoadListener.onLoadingError(url, e);        }        return false;    }}/** * è·å–å­˜å‚¨å™¨ä¸Šçš„å›¾ç‰‡,å›è°ƒè¿”å›GlideDrawable * * @param context           ä¸Šä¸‹æ–‡å¹´ * @param file              æ–‡ä»¶File * @param imageLoadListener å›è°ƒç›‘å¬å™¨ */public static &lt;T&gt; DrawableRequestBuilder&lt;File&gt; loadImage(T context, @NonNull File file, @NonNull ImageLoadListener&lt;File, GlideDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;File&gt; type = getDrawableTypeRequest(context, file);    if (type != null) {        return type.listener(new GlideListener&lt;File, GlideDrawable, File&gt;(imageLoadListener, file));    } else {        return null;    }}/** * è·å–èµ„æºä¸­çš„å›¾ç‰‡ï¼Œå›è°ƒè¿”å›GlideDrawable * * @param context           ä¸Šä¸‹æ–‡ * @param resourceId        èµ„æºid * @param imageLoadListener å›è°ƒç›‘å¬å™¨ */public static &lt;T&gt; DrawableRequestBuilder&lt;Integer&gt; loadImage(T context, @DrawableRes int resourceId, @NonNull ImageLoadListener&lt;Integer, GlideDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;Integer&gt; type = getDrawableTypeRequest(context, resourceId);    if (type != null) {        return type.listener(new GlideListener&lt;Integer, GlideDrawable, Integer&gt;(imageLoadListener, resourceId));    } else {        return null;    }}/** * è·å–ç½‘ç»œå›¾ç‰‡ï¼Œå›è°ƒè¿”å› GlideDrawable * * @param context           ä¸Šä¸‹æ–‡ * @param url               å›¾ç‰‡url * @param imageLoadListener å›è°ƒç›‘å¬å™¨ */public static &lt;T&gt; DrawableRequestBuilder&lt;String&gt; loadImage(T context, @NonNull final String url, @NonNull ImageLoadListener&lt;String, GlideDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(context, url);    if (type != null) {        return type.listener(new GlideListener&lt;String, GlideDrawable, String&gt;(imageLoadListener, url));    } else {        return null;    }}/** * åŠ è½½å­˜å‚¨å™¨ä¸Šçš„å›¾ç‰‡åˆ°ç›®æ ‡è½½ä½“ * * @param file      æ–‡ä»¶File * @param imageView è¦æ˜¾ç¤ºåˆ°çš„å›¾ç‰‡ImageView */public static Target&lt;GlideDrawable&gt; loadImage(@NonNull final File file, @NonNull ImageView imageView, ImageLoadListener&lt;File, GlideDrawable&gt; imageLoadListener) {    return getDrawableTypeRequest(imageView.getContext(), file)            .diskCacheStrategy(DiskCacheStrategy.NONE)//ç¦ç”¨ç£ç›˜ç¼“å­˜            .skipMemoryCache(true)//è·³è¿‡å†…å­˜ç¼“å­˜            .dontAnimate()            .listener(new GlideListener&lt;File, GlideDrawable, File&gt;(imageLoadListener, file, imageView))            .into(imageView);}/** * åŠ è½½èµ„æºä¸­çš„å›¾ç‰‡åˆ°ç›®æ ‡è½½ä½“ * * @param resourceId èµ„æºid * @param imageView  å›¾ç‰‡View */public static Target&lt;GlideDrawable&gt; loadImage(@DrawableRes int resourceId, @NonNull ImageView imageView, ImageLoadListener&lt;Integer, GlideDrawable&gt; imageLoadListener) {    return getDrawableTypeRequest(imageView.getContext(), resourceId)            .listener(new GlideListener&lt;Integer, GlideDrawable, Integer&gt;(imageLoadListener, resourceId, imageView))            .into(imageView);}/** * åŠ è½½æˆåœ†å½¢å¤´åƒåˆ°æ™®é€šImageViewï¼Œæœ‰åŠ¨ç”»æ•ˆæœ * * @param url               å›¾ç‰‡url * @param imageView         è¦æ˜¾ç¤ºåˆ°çš„ImageView * @param imageLoadListener åŠ è½½å›è°ƒç›‘å¬å™¨ * @param parms             è®¾ç½®å ä½ç¬¦å’ŒåŠ è½½å¤±è´¥å›¾ç‰‡(å¯å˜å‚æ•°é»˜è®¤ä¸¤å¼ ,ç¬¬ä¸€å¼ ä¸ºå ä½ç¬¦,ç¬¬äºŒå¼ æ˜¯é»˜è®¤å›¾ç‰‡) * @return è¿”å›Target&lt;GlideDrawable&gt; */public static Target&lt;GlideDrawable&gt; loadCircleImage(@NonNull String url, @NonNull ImageView imageView, ImageLoadListener&lt;String, GlideDrawable&gt; imageLoadListener, int... parms) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(imageView.getContext(), url);    if (parms != null &amp;&amp; parms.length &gt; 0) {        type.placeholder(parms[0]);   //å ä½ç¬¦        if (parms.length &gt; 1) {            type.error(parms[1]);    //å›¾ç‰‡åŠ è½½å¤±è´¥æ˜¾ç¤ºå›¾ç‰‡        }    }    type.transform(new CircleTransform(imageView.getContext()));    return type.listener(new GlideListener&lt;String, GlideDrawable, String&gt;(imageLoadListener, url, imageView))            .into(imageView);}/** * åŠ è½½ç½‘ç»œå›¾ç‰‡åˆ°æŒ‡å®šImageviewï¼Œæ”¯æŒCircleImageView * * @param url               å›¾ç‰‡url * @param imageView         è¦æ˜¾ç¤ºçš„Imageview * @param imageLoadListener å›¾ç‰‡åŠ è½½å›è°ƒ * @param parms             ç¬¬ä¸€ä¸ªæ˜¯errorçš„å›¾ç‰‡ */public static &lt;T&gt; Target&lt;GlideDrawable&gt; loadImage(T context, @NonNull String url, @NonNull ImageView imageView, ImageLoadListener&lt;String, GlideDrawable&gt; imageLoadListener, int... parms) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(context, url);    if (type != null) {        type.asBitmap();        if (parms != null &amp;&amp; parms.length &gt; 0) {            type.placeholder(parms[0]);   //å ä½ç¬¦            if (parms.length &gt; 1) {                type.error(parms[1]);    //å›¾ç‰‡åŠ è½½å¤±è´¥æ˜¾ç¤ºå›¾ç‰‡            }        }        //å•å¼ CircleImageViewä¸å…è®¸åŠ¨ç”»ï¼Œä¸ç„¶ä¼šä¸æ˜¾ç¤º,        if (imageView instanceof nfzr.zr.nf.nfzr.com.nongfaziran.nfzr.view.CircleImageView) {            type.dontAnimate();        }        return type                .listener(new GlideListener&lt;String, GlideDrawable, String&gt;(imageLoadListener, url, imageView))                .into(imageView);    } else {        return null;    }}/** * åŠ è½½ä¸€å¸§è§†é¢‘ï¼Œæ·»åŠ åœ†è§’ * * @param url       å›¾ç‰‡åœ°å€ * @param imageView è¦åŠ è½½åˆ°çš„ImageView */public static Target&lt;GlideDrawable&gt; loadImageFormVideo(@NonNull String url, @NonNull ImageView imageView) {    return getDrawableTypeRequest(imageView.getContext(), url)            .override(SizeUtil.dp2px(150), SizeUtil.dp2px(150))            //.placeholder(android.R.drawable.picture_frame)   //å ä½å›¾            .dontAnimate()            .into(imageView);}public static &lt;T&gt; Target&lt;GlideDrawable&gt; loadImageDetail(final T context, @NonNull final String url, @NonNull final ImageView imageView, final Drawable drawable, final ImageLoadDetailListener&lt;String, GlideDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(context, url);    if (type != null) {        return type.into(new SimpleTarget&lt;GlideDrawable&gt;() {            @Override            public void onResourceReady(GlideDrawable resource, GlideAnimation&lt;? super GlideDrawable&gt; glideAnimation) {                if (imageView != null &amp;&amp; resource != null) {                    imageView.setImageDrawable(resource);                }                if (imageLoadListener != null) {                    imageLoadListener.onLoadingComplete(url, imageView, resource);                }            }            @Override            public void onStart() {                super.onStart();                if (drawable != null &amp;&amp; imageView != null) {                    imageView.setImageDrawable(drawable);                }            }            @Override            public void onLoadStarted(Drawable placeholder) {                super.onLoadStarted(placeholder);                if (imageLoadListener != null) {                    imageLoadListener.onLoadingStart(url, placeholder);                }            }            @Override            public void onLoadFailed(Exception e, Drawable errorDrawable) {                super.onLoadFailed(e, errorDrawable);                if (imageLoadListener != null) {                    imageLoadListener.onLoadingError(url, errorDrawable, e);                }            }        });    } else {        return null;    }}/** * åŠ è½½bitmapï¼Œå›è°ƒè¿”å› Bitmap * * @param context           ä¸Šä¸‹æ–‡ * @param url               å›¾ç‰‡url * @param imageLoadListener å›¾ç‰‡åŠ è½½ç›‘å¬å™¨ * @param &lt;T&gt;               ä¸Šä¸‹æ–‡ç±»å‹ */public static &lt;T&gt; BitmapRequestBuilder&lt;String, Bitmap&gt; loadImageBitmap(T context, @NonNull String url,@NonNull ImageLoadListener&lt;String, Bitmap&gt; imageLoadListener) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(context, url);    if (type != null) {        return type.asBitmap()                .listener(new GlideListener&lt;String, Bitmap, String&gt;(imageLoadListener, url));    }else{        return null;    }}/** * åŠ è½½GifDrawableï¼Œå›è°ƒè¿”å› GifDrawable * * @param context           ä¸Šä¸‹æ–‡ * @param url               å›¾ç‰‡url * @param imageLoadListener å›¾ç‰‡åŠ è½½ç›‘å¬å™¨ */public static &lt;T&gt; GifRequestBuilder&lt;String&gt; loadImageGif(T context, @NonNull String url,@NonNull ImageLoadListener&lt;String, GifDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(context, url);    if (type != null) {        return type.asGif()                .diskCacheStrategy(DiskCacheStrategy.SOURCE)                .listener(new GlideListener&lt;String, GifDrawable, String&gt;(imageLoadListener, url));    }else{        return null;    }}/** * åŠ è½½Gifçš„ä¸€å¼ å›¾ç‰‡åˆ°ImageView * * @param url               å›¾ç‰‡url * @param imageLoadListener å›¾ç‰‡åŠ è½½ç›‘å¬å™¨ *                          @param imageView  *                          @param drawable ç¼©ç•¥å›¾ï¼Œå¯ä»¥ä¸ºç©º */public static Target&lt;Bitmap&gt; loadImageGifSingle(@NonNull String url, @NonNull ImageView imageView, ImageLoadListener&lt;String, Bitmap&gt; imageLoadListener, Drawable drawable) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(imageView.getContext(),url);    return type.asBitmap()            .placeholder(drawable)            .diskCacheStrategy(DiskCacheStrategy.SOURCE)            .listener(new GlideListener&lt;String, Bitmap, String&gt;(imageLoadListener, url))            .into(imageView);}/** * åŠ è½½gifå›¾ç‰‡åˆ°æŒ‡å®šImageView * * @param url               å›¾ç‰‡Url * @param imageView         å›¾ç‰‡View * @param imageLoadListener å›¾ç‰‡åŠ è½½ç›‘å¬å™¨ */public static Target&lt;GifDrawable&gt; loadImageGif(@NonNull String url, @NonNull ImageView imageView, ImageLoadListener&lt;String, GifDrawable&gt; imageLoadListener) {    DrawableTypeRequest&lt;String&gt; type = getDrawableTypeRequest(imageView.getContext(),url);    return type.asGif()            .diskCacheStrategy(DiskCacheStrategy.SOURCE)            .listener(new GlideListener&lt;String, GifDrawable, String&gt;(imageLoadListener, url, imageView))            .into(imageView);}/** * é‡Šæ”¾å†…å­˜ * * @param context ä¸Šä¸‹æ–‡ */public static void clearMemory(Context context) {    Glide.get(context).clearMemory();}/** * å–æ¶ˆæ‰€æœ‰æ­£åœ¨ä¸‹è½½æˆ–ç­‰å¾…ä¸‹è½½çš„ä»»åŠ¡ã€‚ * * @param context ä¸Šä¸‹æ–‡ */public static void cancelAllTasks(Context context) {    Glide.with(context).pauseRequests();}/** * æ¢å¤æ‰€æœ‰ä»»åŠ¡ */public static void resumeAllTasks(Context context) {    Glide.with(context).resumeRequests();}/** * æ¸…é™¤ç£ç›˜ç¼“å­˜ * * @param context ä¸Šä¸‹æ–‡ */public static void clearDiskCache(final Context context) {    new Thread(new Runnable() {        @Override        public void run() {            Glide.get(context).clearDiskCache();        }    }).start();}/** * æ¸…é™¤æ‰€æœ‰ç¼“å­˜ * * @param context ä¸Šä¸‹æ–‡ */public static void cleanAll(Context context) {    clearDiskCache(context);    clearMemory(context);}public class CircleTransform extends BitmapTransformation {public CircleTransform(Context context) {    super(context);}@Override protected Bitmap transform(BitmapPool pool, Bitmap toTransform, int outWidth, int outHeight) {    return circleCrop(pool, toTransform);}private static Bitmap circleCrop(BitmapPool pool, Bitmap source) {    if (source == null) return null;    int size = Math.min(source.getWidth(), source.getHeight());    int x = (source.getWidth() - size) / 2;    int y = (source.getHeight() - size) / 2;    Bitmap squared = Bitmap.createBitmap(source, x, y, size, size);    Bitmap result = pool.get(size, size, Bitmap.Config.ARGB_8888);    if (result == null) {        result = Bitmap.createBitmap(size, size, Bitmap.Config.ARGB_8888);    }    Canvas canvas = new Canvas(result);    Paint paint = new Paint();    paint.setShader(new BitmapShader(squared, BitmapShader.TileMode.CLAMP, BitmapShader.TileMode.CLAMP));    paint.setAntiAlias(true);    float r = size / 2f;    canvas.drawCircle(r, r, r, paint);    return result;}@Override public String getId() {    return getClass().getName();}}</code></pre><p>Drawableè½¬bigmap</p><pre><code>public class BitmapUtils {public static Bitmap drawableToBitmap(Drawable drawable) {    Bitmap bitmap = Bitmap.createBitmap(            drawable.getIntrinsicWidth(),            drawable.getIntrinsicHeight(),            drawable.getOpacity() != PixelFormat.OPAQUE ? Bitmap.Config.ARGB_8888                    : Bitmap.Config.RGB_565);    Canvas canvas = new Canvas(bitmap);    //canvas.setBitmap(bitmap);    drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());    drawable.draw(canvas);    return bitmap;}}</code></pre>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Android7.0ä¹‹åº”ç”¨é—´å…±äº«æ–‡ä»¶</title>
      <link href="/2016/07/23/Android7-0%E4%B9%8B%E5%BA%94%E7%94%A8%E9%97%B4%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6/"/>
      <content type="html"><![CDATA[<p>Android7.0é€‚é…ä¹‹åº”ç”¨é—´å…±äº«æ–‡ä»¶</p><a id="more"></a><h3 id="å‡ºç°é—®é¢˜"><a href="#å‡ºç°é—®é¢˜" class="headerlink" title="å‡ºç°é—®é¢˜"></a>å‡ºç°é—®é¢˜</h3><p>Android N(API 25),æ‰“å¼€ç›¸å†Œç¼–è¾‘é¡µé¢crash,æŠ¥å‡ºFileUriExposedExceptionå¼‚å¸¸</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">android<span class="selector-class">.os</span><span class="selector-class">.FileUriExposedException</span>: file:<span class="comment">////storage/emulated/0/temp/1474956193735.jpg exposed beyond app through Intent.getData()</span></div><div class="line">at android<span class="selector-class">.os</span><span class="selector-class">.StrictMode</span><span class="selector-class">.onFileUriExposed</span>(StrictMode<span class="selector-class">.java</span>:<span class="number">1799</span>)</div><div class="line">at android<span class="selector-class">.net</span><span class="selector-class">.Uri</span><span class="selector-class">.checkFileUriExposed</span>(Uri<span class="selector-class">.java</span>:<span class="number">2346</span>)</div><div class="line">at android<span class="selector-class">.content</span><span class="selector-class">.Intent</span><span class="selector-class">.prepareToLeaveProcess</span>(Intent<span class="selector-class">.java</span>:<span class="number">8933</span>)</div><div class="line">at android<span class="selector-class">.content</span><span class="selector-class">.Intent</span><span class="selector-class">.prepareToLeaveProcess</span>(Intent<span class="selector-class">.java</span>:<span class="number">8894</span>)</div><div class="line">at android<span class="selector-class">.app</span><span class="selector-class">.Instrumentation</span><span class="selector-class">.execStartActivity</span>(Instrumentation<span class="selector-class">.java</span>:<span class="number">1517</span>)</div><div class="line">at android<span class="selector-class">.app</span><span class="selector-class">.Activity</span><span class="selector-class">.startActivityForResult</span>(Activity<span class="selector-class">.java</span>:<span class="number">4223</span>)</div><div class="line">...</div><div class="line">at android<span class="selector-class">.app</span><span class="selector-class">.Activity</span><span class="selector-class">.startActivityForResult</span>(Activity<span class="selector-class">.java</span>:<span class="number">4182</span>)</div></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾åŸå› "><a href="#æŸ¥æ‰¾åŸå› " class="headerlink" title="æŸ¥æ‰¾åŸå› "></a>æŸ¥æ‰¾åŸå› </h3><p>Android Nçš„åº”ç”¨,APIç¦æ­¢å‘åº”ç”¨å¤–å…¬å¼€file://URI,å¦‚æœä¸€é¡¹åŒ…å«æ–‡ä»¶URIçš„Intentç¦»å¼€åº”ç”¨, åº”ç”¨crashå¹¶æŠ¥FileUriExposedExceptionå¼‚å¸¸</p><h3 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h3><p>è‹¥æƒ³è¦åœ¨åº”ç”¨é—´å…±äº«æ–‡ä»¶,åº”è¯¥å‘é€ä¸€é¡¹content://URI,å¹¶è¯¥URIä¸´æ—¶è®¿é—®æƒé™,è¿›è¡Œæ­¤æˆæƒçš„æ–¹å¼æ˜¯é€šè¿‡FileProviderç±» </p><h3 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h3><h4 id="1-æ¸…å•æ–‡ä»¶"><a href="#1-æ¸…å•æ–‡ä»¶" class="headerlink" title="[1] æ¸…å•æ–‡ä»¶"></a>[1] æ¸…å•æ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">    <span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">package</span>=<span class="string">"com.fengan.providerdemo"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">application</span></span></div><div class="line">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></div><div class="line">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></div><div class="line">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</div><div class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div><div class="line">           <span class="comment">&lt;!--authorities="ä½ çš„åŒ…å+fileprovider" --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">provider</span></span></div><div class="line">            <span class="attr">android:authorities</span>=<span class="string">"com.fengan.providerdemo.fileprovider"</span></div><div class="line">            <span class="attr">android:name</span>=<span class="string">"android.support.v4.content.FileProvider"</span></div><div class="line">            <span class="attr">android:grantUriPermissions</span>=<span class="string">"true"</span></div><div class="line">            <span class="attr">android:exported</span>=<span class="string">"false"</span>&gt;</div><div class="line">            <span class="tag">&lt;<span class="name">meta-data</span></span></div><div class="line">                <span class="attr">android:name</span>=<span class="string">"android.support.FILE_PROVIDER_PATHS"</span></div><div class="line">                <span class="attr">android:resource</span>=<span class="string">"@xml/filepaths"</span>/&gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">provider</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></div></pre></td></tr></table></figure><h4 id="2-resä¸‹xmlæ–‡ä»¶å¤¹"><a href="#2-resä¸‹xmlæ–‡ä»¶å¤¹" class="headerlink" title="[2] resä¸‹xmlæ–‡ä»¶å¤¹"></a>[2] resä¸‹xmlæ–‡ä»¶å¤¹</h4><p><img src="./1485158383668.png" alt="Alt text"><br>æ³¨æ„xmlæ–‡ä»¶åå’Œæ¸…å•æ–‡ä»¶ä¸­@xml/filepathsç›¸åŒ<br>xmlæ–‡ä»¶å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">    <span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">paths</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- external-path:sd ï¼›path:ä½ çš„åº”ç”¨ä¿å­˜æ–‡ä»¶çš„æ ¹ç›®å½•ï¼›nameéšä¾¿å®šä¹‰--&gt;</span></div><div class="line">    //<span class="tag">&lt;<span class="name">external-path</span> <span class="attr">path</span>=<span class="string">"fengan_imgs/"</span> <span class="attr">name</span>=<span class="string">"files_path"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">external-path</span> <span class="attr">path</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"files_path"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">paths</span>&gt;</span></div></pre></td></tr></table></figure><p>æ³¨æ„:<br>path=â€â€,æœ‰ç‰¹æ®Šæ„ä¹‰,å®ƒä»£è¡¨æ›´ç›®å½•,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥å‘åº”ç”¨å…±äº«æ ¹ç›®å½•åŠå…¶å­ç›®å½•ä¸‹ä»»ä½•ä¸€ä¸ªæ–‡ä»¶,å¦‚æœå°†pathå†™ä¸ºpath=â€fengan_imgs/â€œ,é‚£ä¹ˆåªèƒ½åœ¨fengan_imgs/ç›®å½•ä¸‹æ‰å¯ä»¥åˆ†äº«!<br>[3]æ ¸å¿ƒä»£ç <br>å°†Fileè½¬æ¢ä¸ºuri</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> Uri getUriForFile(Context context, <span class="keyword">File</span> <span class="keyword">file</span>) &#123;</div><div class="line">       <span class="keyword">if</span> (context == <span class="keyword">null</span> || <span class="keyword">file</span> == <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</div><div class="line">       &#125;</div><div class="line">       Uri uri;</div><div class="line">       <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">24</span>) &#123;</div><div class="line">       <span class="comment">//å’Œandroid:authorities="com.fengan.providerdemo.fileprovider"å¯¹åº”</span></div><div class="line">           uri = FileProvider.getUriForFile(context.getApplicationContext(), <span class="string">"com.fengan.providerdemo.fileprovider"</span>, <span class="keyword">file</span>);</div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           uri = Uri.fromFile(<span class="keyword">file</span>);</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> uri;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><ul><li>Uriçš„schemeç±»å‹ä¸ºfile,æ”¹æˆäº†åˆFileProvideråˆ›å»ºä¸€ä¸ªcontentç±»å‹çš„Uriæ‰“å¼€ç›¸æœº,æ‰“å°è¯¥Uriä¸ºcontent://com.fengan.providerdemo/files_path/temp/1474960080319.jpg`ã€‚<br>//å…¶ä¸­camera_photoså°±æ˜¯file_paths.xmlä¸­pathsçš„nameã€‚</li></ul><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    * æ‰“å¼€ç›¸æœº</div><div class="line">    * å…¼å®¹7.0</div><div class="line">    *</div><div class="line">    * <span class="doctag">@param</span> activity    Activity</div><div class="line">    * <span class="doctag">@param</span> file        File</div><div class="line">    * <span class="doctag">@param</span> requestCode result requestCode</div><div class="line">    */</div><div class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">startActionCapture</span><span class="params">(Activity activity, File file, <span class="keyword">int</span> requestCode)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (activity == <span class="keyword">null</span>) &#123;</div><div class="line">           <span class="keyword">return</span>;</div><div class="line">       &#125;</div><div class="line">       Intent intent = <span class="keyword">new</span> Intent(MediaStore.ACTION_IMAGE_CAPTURE);</div><div class="line">    intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); <span class="comment">//æ·»åŠ è¿™ä¸€å¥è¡¨ç¤ºå¯¹ç›®æ ‡åº”ç”¨ä¸´æ—¶æˆæƒè¯¥Uriæ‰€ä»£è¡¨çš„æ–‡ä»¶</span></div><div class="line">       intent.putExtra(MediaStore.EXTRA_OUTPUT, getUriForFile(activity, file));<span class="comment">//æ‹å–ç…§ç‰‡ä¿å­˜åˆ°æŒ‡å®šUri</span></div><div class="line">       activity.startActivityForResult(intent, requestCode);</div><div class="line">   &#125;</div></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>é’ˆå¯¹æ¶‰åŠåˆ°ä»Androidè®¾å¤‡ä¸Šè·å–ç…§ç‰‡(æ‹ç…§,æˆ–ä»ç›¸å†Œ,æ–‡ä»¶ä¸­é€‰æ‹©)æ‰“å¼€ç›¸æœº,è£å‰ªå›¾ç‰‡,å‹ç¼©å›¾ç‰‡,å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè½»é‡çº§å¼€æºåº“,TakePhoto!<br> <a href="https://github.com/crazycodeboy/TakePhoto/" target="_blank" rel="external">https://github.com/crazycodeboy/TakePhoto/</a></li></ul>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>appå¯åŠ¨æµç¨‹ç®€æ</title>
      <link href="/2016/03/16/app%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E7%AE%80%E6%9E%90/"/>
      <content type="html"><![CDATA[<p><strong>å‰è¨€</strong></p><p>Androidç³»ç»Ÿä¸­ï¼Œåº”ç”¨ç¨‹åºæ˜¯ç”±Activityç»„æˆçš„ï¼Œå› æ­¤ï¼Œåº”ç”¨ç¨‹åºçš„å¯åŠ¨è¿‡ç¨‹å®é™…ä¸Šå°±è¯´åº”ç”¨ç¨‹åºä¸­é»˜è®¤Activityçš„å¯åŠ¨è¿‡ç¨‹ï¼Œæœ¬æ–‡ä¸»è¦æ•´ç†å†·å¯åŠ¨çš„æƒ…å†µã€‚</p><a id="more"></a>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>webviewä¸­ç‚¹å‡»ç½‘é¡µå›¾ç‰‡è·³è½¬æŸ¥çœ‹å›¾ç‰‡</title>
      <link href="/2016/03/08/webview%E4%B8%AD%E7%82%B9%E5%87%BB%E7%BD%91%E9%A1%B5%E5%9B%BE%E7%89%87%E8%B7%B3%E8%BD%AC%E6%9F%A5%E7%9C%8B%E5%9B%BE%E7%89%87/"/>
      <content type="html"><![CDATA[<p><strong>å‰è¨€</strong></p><p>appä¸­å¾ˆå¤šå›¾æ–‡é¡µé¢ï¼Œç±»ä¼¼æ–°é—»è¯¦æƒ…é¡µï¼Œéƒ½æ˜¯ä¸€ä¸ªH5ç½‘é¡µï¼Œå½“æˆ‘ä»¬ç‚¹å‡»ç½‘é¡µä¸­çš„å›¾ç‰‡ï¼Œå¸Œæœ›è·³è½¬åˆ°ä¸€ä¸ªå¤šå›¾æ¸¸è§ˆçš„é¡µé¢ï¼Œå¹¶ä¸”æ”¯æŒæ‰‹åŠ¿ç¼©æ”¾å’Œä¿å­˜çš„ä¸€äº›åŠŸèƒ½ã€‚ä»Šå¤©ä¸»è¦æ•´ç†ä¸€ä¸‹ç‚¹å‡»ç½‘é¡µä¸­å›¾ç‰‡ï¼Œè·³è½¬åˆ°æŒ‡å®šå›¾ç‰‡çš„æŸ¥çœ‹é¡µé¢å³å¯ï¼Œæ‰‹åŠ¿ç¼©æ”¾å¯ä»¥ä½¿ç”¨photoviewã€‚</p><a id="more"></a><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fp5hh5mdkvg30bf0lgnpd.gif" alt="ç½‘é¡µç‚¹å‡»å›¾ç‰‡"></p><p><strong>åŸç†</strong></p><p>é¦–å…ˆç‚¹å‡»h5é¡µé¢ï¼Œè·³è½¬æœ¬åœ°é¡µé¢ï¼Œæ˜¯jsè°ƒç”¨åŸç”Ÿä»£ç </p><p><strong>Jsé€šè¿‡WebViewè°ƒç”¨Androidä»£ç æœ‰ä¸‰ç§æ–¹å¼</strong></p><ul><li>é€šè¿‡WebViewçš„addJavascriptInterfaceï¼ˆï¼‰è¿›è¡Œå¯¹è±¡æ˜ å°„</li><li>é€šè¿‡ WebViewClient çš„shouldOverrideUrlLoading ()æ–¹æ³•å›è°ƒæ‹¦æˆª url</li><li>é€šè¿‡ WebChromeClient çš„onJsAlert()ã€onJsConfirm()ã€onJsPromptï¼ˆï¼‰æ–¹æ³•å›è°ƒæ‹¦æˆªJSå¯¹è¯æ¡†alert()ã€confirm()ã€promptï¼ˆï¼‰ æ¶ˆæ¯</li></ul><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fp5hmm8ywuj31d60hqgqf.jpg" alt="jsè°ƒåŸç”Ÿ"></p><p>é€šè¿‡addJavascriptInterfaceå®šä¹‰jsæ¥å£çš„æ–¹å¼æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ‰€ä»¥æœ¬æ–‡é‡‡ç”¨çš„æ˜¯è¿™ç§æ–¹å¼ï¼Œè¯¦ç»†è§ä¸‹åˆ—ä»£ç </p><ul><li>å®šä¹‰jsæ¥å£</li><li>æ‰¾åˆ°ç½‘é¡µä¸­imgæ ‡ç­¾çš„ä»£ç å—ï¼Œè®¾ç½®ç‚¹å‡»</li><li>ç›¸å…³æƒé™å’Œæ··æ·†</li></ul><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="å®šä¹‰jsæ¥å£"><a href="#å®šä¹‰jsæ¥å£" class="headerlink" title="å®šä¹‰jsæ¥å£"></a>å®šä¹‰jsæ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">**</div><div class="line"> * Created by fengan on <span class="number">2016</span>/<span class="number">3</span>/<span class="number">8</span>.</div><div class="line"> * email:fengan1102<span class="meta">@gmail</span>.com</div><div class="line"> * ç‚¹å‡»webviewé¡µé¢å›¾ç‰‡ï¼Œè·³è½¬æŸ¥çœ‹å¤§å›¾é¡µé¢çš„jsæ¥å£</div><div class="line"> * æ£€æŸ¥æ··æ·†æ–‡ä»¶ï¼Œç¡®ä¿æœªè¢«æ··æ·†</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaScriptInterface</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Activity mContext;</div><div class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; mImgList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JavaScriptInterface</span><span class="params">(Activity context)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.mContext = context;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="comment">//æ–¹æ³•åè¦å’Œæ‰§è¡Œçš„jsä»£ç ä¸­ä¸€è‡´</span></div><div class="line">    <span class="meta">@JavascriptInterface</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addImageUrl</span><span class="params">(String img)</span> </span>&#123; </div><div class="line">        mImgList.add(img);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@JavascriptInterface</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">openImage</span><span class="params">(String img)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (ClickUtils.noDoubleClick()) &#123;</div><div class="line">            <span class="keyword">int</span> index = mImgList.indexOf(img);</div><div class="line">            PhotoListAty.startAty(index == -<span class="number">1</span> ? <span class="number">0</span> : index, mImgList, mContext);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰WebClient"><a href="#è‡ªå®šä¹‰WebClient" class="headerlink" title="è‡ªå®šä¹‰WebClient"></a>è‡ªå®šä¹‰WebClient</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWebViewClient</span> <span class="keyword">extends</span> <span class="title">WebViewClient</span> </span>&#123;  </div><div class="line"></div><div class="line">    <span class="meta">@Override</span>  </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>&#123;  </div><div class="line"></div><div class="line">        view.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);  </div><div class="line"></div><div class="line">      <span class="keyword">super</span>.onPageFinished(view, url);  </div><div class="line"></div><div class="line">    addImageClickListener(view);<span class="comment">//å¾…ç½‘é¡µåŠ è½½å®Œå…¨åè®¾ç½®å›¾ç‰‡ç‚¹å‡»çš„ç›‘å¬æ–¹æ³•  </span></div><div class="line"></div><div class="line">    &#125;  </div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">  <span class="meta">@Override</span>  </div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageStarted</span><span class="params">(WebView view, String url, Bitmap favicon)</span> </span>&#123;  </div><div class="line"></div><div class="line">        view.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);  </div><div class="line"></div><div class="line">       <span class="keyword">super</span>.onPageStarted(view, url, favicon);  </div><div class="line"></div><div class="line">   &#125;  </div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addImageClickListener</span><span class="params">(WebView webView)</span> </span>&#123;  </div><div class="line"> webView.loadUrl(<span class="string">"javascript:(function()&#123;"</span> +</div><div class="line">                <span class="string">"var objs = document.getElementsByTagName(\"img\"); "</span> +</div><div class="line">                <span class="string">"for(var i=0;i&lt;objs.length;i++)  "</span> +</div><div class="line">                <span class="string">"&#123;"</span> +</div><div class="line">                <span class="string">"window.imagelistener.addImageUrl(objs[i].src);  "</span> +</div><div class="line">                <span class="string">" objs[i].onclick=function()  "</span> +</div><div class="line">                <span class="string">" &#123;  "</span> +</div><div class="line">                <span class="string">" window.imagelistener.openImage(this.src);  "</span> +</div><div class="line">                <span class="string">"  &#125;  "</span> +</div><div class="line">                <span class="string">"&#125;"</span> +</div><div class="line">                <span class="string">"&#125;)()"</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//imagelistenerç”¨äºæš´éœ²jsçš„å¯¹è±¡ï¼Œéœ€è¦å¯¹åº”</span></div><div class="line"> mWebview.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);  </div><div class="line"> mWebview.addJavascriptInterface(<span class="keyword">new</span> JavaScriptInterface(<span class="keyword">this</span>), <span class="string">"imagelistener"</span>);</div><div class="line"> mWebview.setWebViewClient(<span class="keyword">new</span> MyWebViewClient());</div></pre></td></tr></table></figure><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>æ³¨æ„åœ¨æ··æ·†æ–‡ä»¶ä¸­æ·»åŠ </p><p>é¡¹ç›®ä¸­æš´éœ²çš„jsæ¥å£ç±»ï¼šMJavascriptInterfaceä¸èƒ½æ··æ·†ï¼Œå…¶è°ƒç”¨çš„æ–¹æ³•çš„å£°æ˜ä¹Ÿä¸èƒ½æ··æ·†ï¼Œæ‰€ä»¥è¿˜è¦æ·»åŠ å¦‚ä¸‹æ··æ·†è®¾ç½®ä»£ç ï¼ˆä»£ç å› åŒ…åè€Œå˜åŒ–ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-keepclassmembers class com.example.administrator.webviewpagescannerapp.other.MJavascriptInterface&#123;  </div><div class="line">  public *;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">-keepattributes *Annotation*  </div><div class="line">-keepattributes *JavascriptInterface*</div></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>äº§ç”Ÿ65535çš„åŸå› å’Œè§£å†³åŠæ³•</title>
      <link href="/2016/03/06/%E4%BA%A7%E7%94%9F65535%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%92%8C%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
      <content type="html"><![CDATA[<p>Androidå…³äº65535çš„é—®é¢˜</p><a id="more"></a><p>ç†Ÿæ‚‰Androidå¼€å‘çš„éƒ½çŸ¥é“ï¼Œåœ¨ç”ŸæˆDexè¿‡ç¨‹ä¸­ï¼Œæ–¹æ³•æ•°è¶…è¿‡65535å°±ä¼šæŠ¥é”™ï¼Œæœ¬æ–‡åªç®€è¿°ä¸€ä¸‹å¦‚ä½•è§£å†³ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨<a href="https://source.android.com/devices/tech/dalvik/dalvik-bytecode" target="_blank" rel="external">DalvikæŒ‡ä»¤é›†</a>ä¸­ï¼Œè°ƒç”¨æ–¹æ³•çš„<code>invoke-kind</code>æŒ‡ä»¤ä¸­ï¼Œmethod reference indexåªç»™äº†16bitsï¼Œæœ€å¤šèƒ½è°ƒç”¨65535ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆdexæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œå½“æ–¹æ³•æ•°è¶…è¿‡65535å°±ä¼šæŠ¥é”™ã€‚å…¶å®é™¤äº†methodï¼Œfiledå’Œclassçš„indexä¹Ÿæ˜¯16bitsï¼Œæ‰€ä»¥ä¹Ÿä¼šå­˜åœ¨65535çš„é—®é¢˜ï¼Œåªä¸è¿‡methodçš„æ•°é‡ä¸€èˆ¬æ˜¯æœ€å¤šçš„ï¼Œæ‰€ä»¥æœ€å¸¸è§çš„ä¹Ÿæ˜¯æ–¹æ³•æ•°æº¢å‡ºçš„é—®é¢˜ã€‚</p><h4 id="å¯¼å…¥multidexåŒ…ï¼Œé…ç½®gradleæ–‡ä»¶"><a href="#å¯¼å…¥multidexåŒ…ï¼Œé…ç½®gradleæ–‡ä»¶" class="headerlink" title="å¯¼å…¥multidexåŒ…ï¼Œé…ç½®gradleæ–‡ä»¶"></a>å¯¼å…¥multidexåŒ…ï¼Œé…ç½®gradleæ–‡ä»¶</h4><p><code>multiDexEnabled true</code></p><p><code>implementation &#39;com.android.support:multidex:1.0.2&#39;</code></p><h4 id="Applicationä¸­åˆå§‹åŒ–"><a href="#Applicationä¸­åˆå§‹åŒ–" class="headerlink" title="Applicationä¸­åˆå§‹åŒ–"></a>Applicationä¸­åˆå§‹åŒ–</h4><ul><li>ç»§æ‰¿MultiDexApplication</li><li>é‡å†™Application çš„attachBaseContextæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨onCreateä¹‹å‰æ‰§è¡Œçš„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span></span>&#123;  </div><div class="line">  </div><div class="line"><span class="meta">@Override</span>  </div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">attachBaseContext</span><span class="params">(Context base)</span> </span>&#123;  </div><div class="line">        <span class="keyword">super</span>.attachBaseContext(base);  </div><div class="line">        MultiDex.install(<span class="keyword">this</span>);  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™æ ·ä¼šç”Ÿæˆclasses.dex  classes2.dex  classes3.dex  â€¦å¤šä¸ªdexæ–‡ä»¶</p><h4 id="ä¸ºå•¥ä¼šæœ‰65536çš„é™åˆ¶"><a href="#ä¸ºå•¥ä¼šæœ‰65536çš„é™åˆ¶" class="headerlink" title="ä¸ºå•¥ä¼šæœ‰65536çš„é™åˆ¶"></a>ä¸ºå•¥ä¼šæœ‰65536çš„é™åˆ¶</h4><p>ä¸€ä¸ª dex æ–‡ä»¶çš„æ–¹æ³•å¼•ç”¨æ•°ä¸èƒ½å¤§äº 64kï¼Œ64k çš„å‡†ç¡®å€¼æ˜¯ï¼ˆ64 * 1024 = 65536ï¼‰ã€‚</p><p>invoke-kind ï¼ˆè°ƒç”¨å„ç±»æ–¹æ³•ï¼‰æŒ‡ä»¤ä¸­ï¼Œæ–¹æ³•å¼•ç”¨ç´¢å¼•æ•°æ˜¯ 16 ä½çš„ï¼Œä¹Ÿå°±æ˜¯æœ€å¤šè°ƒç”¨ 2^16 = 65536 ä¸ªæ–¹æ³•ï¼Œè¿™å°±æ˜¯ <strong>DexFormat</strong> ä¸­ <strong>MAX_MEMBER_IDX </strong>ä¸º 0xFFFF çš„åŸå› ã€‚</p><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5OTE4ODgzMw==&amp;mid=2247483766&amp;idx=1&amp;sn=3ab423d9a16824f4c4252c3fb3fdb8d2&amp;chksm=a73e01789049886e8ecec45a5b3a4f6132faf3f953e79a6d5717360dc91314d74a3589766efe&amp;scene=38#wechat_redirect" target="_blank" rel="external">è¯¦ç»†åŸå› æŸ¥çœ‹</a></p>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å›é¡¾é›†åˆä½“ç³»</title>
      <link href="/2015/12/26/%E5%9B%9E%E9%A1%BE%E9%9B%86%E5%90%88%E4%BD%93%E7%B3%BB/"/>
      <content type="html"><![CDATA[<p>é›†åˆä½“ç³»æ•´ç†</p><a id="more"></a><h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><ul><li>é¢å‘å¯¹è±¡è¯­è¨€å¯¹äº‹ç‰©çš„ä½“ç°éƒ½æ˜¯ä»¥å¯¹è±¡çš„å½¢å¼ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿å¯¹å¤šä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå°±éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œå­˜å‚¨</li><li>æ•°ç»„è™½ç„¶å¯ä»¥å­˜å‚¨å¯¹è±¡ï¼Œä½†æ˜¯é•¿åº¦ä¸Šå›ºå®šçš„</li><li>é›†åˆçš„é•¿åº¦æ˜¯å¯å˜çš„</li><li>æ•°ç»„ä¸­<strong>å¯ä»¥</strong>å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹</li><li>é›†åˆä¸­<strong>åªèƒ½</strong>å­˜å‚¨å¯¹è±¡</li></ul><h4 id="é›†åˆä½“ç³»å›¾"><a href="#é›†åˆä½“ç³»å›¾" class="headerlink" title="é›†åˆä½“ç³»å›¾"></a>é›†åˆä½“ç³»å›¾</h4><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fmwkdnlaooj30i80budid.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fmwjo9kq19j31kw15d15f.jpg" alt="é›†åˆä½“ç³»å›¾"></p><h4 id="Iteratoræ¥å£"><a href="#Iteratoræ¥å£" class="headerlink" title="Iteratoræ¥å£"></a>Iteratoræ¥å£</h4><ul><li>Iteratoræ¥å£ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºéå†é›†åˆä¸­å…ƒç´ çš„æ¥å£</li><li>ä¸»è¦åŒ…å«hashNext(),next(),remove()ä¸‰ç§æ–¹æ³•</li><li>å®ƒçš„ä¸€ä¸ªå­æ¥å£LinkedIteratoråœ¨å®ƒçš„åŸºç¡€ä¸Šåˆæ·»åŠ äº†ä¸‰ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯add(),previous(),hasPrevious()</li><li>Iteratoræ¥å£ï¼Œé‚£ä¹ˆåœ¨éå†é›†åˆä¸­å…ƒç´ çš„æ—¶å€™ï¼Œåªèƒ½å¾€åéå†ï¼Œè¢«éå†åçš„å…ƒç´ ä¸ä¼šåœ¨éå†åˆ°ï¼Œé€šå¸¸æ— åºé›†åˆå®ç°çš„éƒ½æ˜¯è¿™ä¸ªæ¥å£ï¼Œæ¯”å¦‚HashSetï¼ŒHashMap</li><li>å…ƒç´ æœ‰åºçš„é›†åˆï¼Œå®ç°çš„ä¸€èˆ¬éƒ½æ˜¯LinkedIteratoræ¥å£ï¼Œå®ç°è¿™ä¸ªæ¥å£çš„é›†åˆå¯ä»¥åŒå‘éå†ï¼Œæ—¢å¯ä»¥é€šè¿‡next()è®¿é—®ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåˆå¯ä»¥é€šè¿‡previous()è®¿é—®å‰ä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚ArrayListã€‚</li></ul><h4 id="Collectionæ¥å£"><a href="#Collectionæ¥å£" class="headerlink" title="Collectionæ¥å£"></a>Collectionæ¥å£</h4><ul><li>Collectionæ˜¯é›†åˆç±»æ ¹æ¥å£ï¼Œè¡ç”Ÿå‡ºä¸¤ä¸ªå­ç±»æ¥å£Listå’ŒSet</li><li>Collectionå®šä¹‰äº†é›†åˆæ¡†æ¶çš„å…±æ€§åŠŸèƒ½</li></ul><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fmwjn5w2rrj31a00ls122.jpg" alt="Collectionæ¥å£ä½“ç³»å›¾"></p><h5 id="Listæ¥å£"><a href="#Listæ¥å£" class="headerlink" title="Listæ¥å£"></a>Listæ¥å£</h5><p>Listé‡Œå­˜æ”¾çš„å¯¹è±¡æ˜¯æœ‰åºçš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¯ä»¥é‡å¤çš„ï¼ŒListå…³æ³¨çš„æ˜¯ç´¢å¼•ï¼Œæ‹¥æœ‰ä¸€ç³»åˆ—å’Œç´¢å¼•ç›¸å…³çš„æ–¹æ³•ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ã€‚å› ä¸ºå¾€listé›†åˆé‡Œæ’å…¥æˆ–åˆ é™¤æ•°æ®æ—¶ï¼Œä¼šä¼´éšç€åé¢æ•°æ®çš„ç§»åŠ¨ï¼Œæ‰€æœ‰æ’å…¥åˆ é™¤æ•°æ®é€Ÿåº¦æ…¢ã€‚</p><ul><li><strong>ArrayListï¼š</strong>çº¿ç¨‹ä¸å®‰å…¨ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œå…ƒç´ æœ‰åºï¼Œå¯é‡å¤</li><li><strong>Vectorï¼š</strong>çº¿ç¨‹å®‰å…¨ï¼Œä½†é€Ÿåº¦æ…¢ï¼Œå·²è¢«ArrayListæ›¿ä»£</li><li><strong>LinkedListï¼š</strong>é“¾è¡¨ç»“æ„ï¼Œå¢åˆ é€Ÿåº¦å¿«</li></ul><p>LinkedListç»å¸¸ç”¨åœ¨å¢åˆ æ“ä½œè¾ƒå¤šè€ŒæŸ¥è¯¢æ“ä½œå¾ˆå°‘çš„æƒ…å†µä¸‹ï¼ŒArrayListåˆ™ç›¸å</p><h5 id="Setæ¥å£"><a href="#Setæ¥å£" class="headerlink" title="Setæ¥å£"></a>Setæ¥å£</h5><p>Seté‡Œå­˜æ”¾çš„å¯¹è±¡æ˜¯æ— åºï¼ˆå­˜å…¥å’Œå–å‡ºçš„é¡ºåºä¸ä¸€å®šä¸€è‡´ï¼‰ï¼Œä¸èƒ½é‡å¤çš„ï¼Œé›†åˆä¸­çš„å¯¹è±¡ä¸æŒ‰ç‰¹å®šçš„æ–¹å¼æ’åºï¼Œåªæ˜¯ç®€å•åœ°æŠŠå¯¹è±¡åŠ å…¥é›†åˆä¸­ã€‚</p><ul><li><strong>HashSetï¼š</strong>ï¼š</li></ul><ol><li>åº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨ã€‚æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ä¸åŒæ­¥</li><li>é€šè¿‡å…ƒç´ çš„ä¸¤ä¸ªæ–¹æ³•ï¼ŒhashCodeå’Œequalsæ¥ä¿è¯å”¯ä¸€æ€§</li><li>å¦‚æœå…ƒç´ çš„HashCodeå€¼ç›¸åŒï¼Œæ‰ä¼šåˆ¤æ–­equalsæ˜¯å¦ä¸ºtrueã€‚</li><li>å¦‚æœå…ƒç´ çš„hashcodeå€¼ä¸åŒï¼Œä¸ä¼šè°ƒç”¨equalsã€‚</li><li>æ— åº</li></ol><ul><li><strong>TreeSetï¼š</strong></li></ul><ol><li>æœ‰åº</li><li>çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¯ä»¥å¯¹Seté›†åˆä¸­çš„å…ƒç´ è¿›è¡Œæ’åº</li><li>é€šè¿‡compareToæˆ–è€…compareæ–¹æ³•æ¥ä¿è¯å…ƒç´ çš„å”¯ä¸€æ€§ï¼Œå…ƒç´ ä»¥äºŒå‰æ ‘çš„å½¢å¼å­˜æ”¾ã€‚</li></ol><h4 id="Mapæ¥å£"><a href="#Mapæ¥å£" class="headerlink" title="Mapæ¥å£"></a>Mapæ¥å£</h4><ul><li>Mapæä¾›äº†ä¸€ç§æ˜ å°„å…³ç³»ï¼Œå…ƒç´ æ˜¯ä»¥é”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„å½¢å¼å­˜å‚¨çš„ï¼Œèƒ½æ ¹æ®keyå¿«é€ŸæŸ¥æ‰¾valueï¼›</li><li>Mapä¸­çš„é”®å€¼å¯¹ä»¥Entryç±»å‹çš„å¯¹è±¡å®ä¾‹å½¢å¼å­˜åœ¨ï¼›</li><li>keyå€¼ä¸èƒ½é‡å¤ï¼Œvalueå€¼å¯ä»¥é‡å¤ï¼›</li></ul><h5 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h5><p>åº•å±‚æ˜¯å“ˆå¸Œè¡¨æ•°æ®ç»“æ„ï¼Œå…è®¸ä½¿ç”¨ null å€¼å’Œ null é”®ï¼Œè¯¥é›†åˆæ˜¯ä¸åŒæ­¥çš„ã€‚å°†hashtableæ›¿ä»£ï¼Œjdk1.2.æ•ˆç‡é«˜ã€‚</p><h6 id="HashMapåŸç†ï¼š"><a href="#HashMapåŸç†ï¼š" class="headerlink" title="HashMapåŸç†ï¼š"></a><strong><a href="http://tracylihui.github.io/2015/07/01/Java%E9%9B%86%E5%90%88%E5%AD%A6%E4%B9%A01%EF%BC%9AHashMap%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" target="_blank" rel="external">HashMapåŸç†ï¼š</a></strong></h6><ul><li>HashMapåº•å±‚å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚å½“æ–°å»ºä¸€ä¸ªHashMapçš„æ—¶å€™ï¼Œå°±ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ã€‚</li></ul><ul><li>æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹åˆæ˜¯ä¸€ä¸ªEntryï¼Œå…¶ä¸­åŒ…å«äº†keyå’Œvalueï¼Œä¹Ÿå°±æ˜¯é”®å€¼å¯¹ï¼Œå¦å¤–è¿˜åŒ…å«äº†ä¸€ä¸ªnextçš„EntryæŒ‡é’ˆ</li></ul><ul><li>å› ä¸ºæŒæœ‰ä¸‹ä¸€ä¸ªEntryæŒ‡é’ˆï¼Œæ‰€ä»¥æ„æˆé“¾è¡¨</li><li>å¾€HashMapä¸­putå…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæ ¹æ®keyçš„hashCodeé‡æ–°è®¡ç®—hashå€¼</li><li>æ ¹æ®hashå€¼å¾—åˆ°è¿™ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆå³ä¸‹æ ‡ï¼‰</li><li>å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸Šå·²ç»å­˜æ”¾æœ‰å…¶ä»–å…ƒç´ äº†ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªä½ç½®ä¸Šçš„å…ƒç´ å°†ä»¥é“¾è¡¨çš„å½¢å¼å­˜æ”¾ï¼Œæ–°åŠ å…¥çš„æ”¾åœ¨é“¾å¤´ï¼Œæœ€å…ˆåŠ å…¥çš„æ”¾åœ¨é“¾å°¾ã€‚</li><li>å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸Šæ²¡æœ‰å…ƒç´ ï¼Œå°±ç›´æ¥å°†è¯¥å…ƒç´ æ”¾åˆ°æ­¤æ•°ç»„ä¸­çš„è¯¥ä½ç½®ä¸Š</li><li>ä»HashMapä¸­getå…ƒç´ æ—¶ï¼Œé¦–å…ˆè®¡ç®—keyçš„hashCodeï¼Œæ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”ä½ç½®çš„æŸä¸€å…ƒç´ ï¼Œç„¶åé€šè¿‡keyçš„equalsæ–¹æ³•åœ¨å¯¹åº”ä½ç½®çš„é“¾è¡¨ä¸­æ‰¾åˆ°éœ€è¦çš„å…ƒç´ ã€‚</li></ul><h6 id="ä¸€å¥è¯åŸç†æ€»ç»“ï¼š"><a href="#ä¸€å¥è¯åŸç†æ€»ç»“ï¼š" class="headerlink" title="ä¸€å¥è¯åŸç†æ€»ç»“ï¼š"></a>ä¸€å¥è¯åŸç†æ€»ç»“ï¼š</h6><p>ç®€å•æ¥è¯´ï¼ŒHashMapåœ¨åº•å±‚å°†key-valueå½“ä½œä¸€ä¸ªæ•´ä½“å¤„ç†ï¼Œè¿™ä¸ªæ•´ä½“å°±æ˜¯ä¸€ä¸ªEntryå¯¹è±¡ã€‚HashMapåº•å±‚é‡‡ç”¨ä¸€ä¸ªEntry[]æ•°ç»„æ¥ä¿å­˜æ‰€æœ‰çš„key-valueï¼Œæ¯ä¸ªEntryåŒ…å«äº†key-valueï¼Œè¿˜åŒ…å«äº†nextçš„EntryæŒ‡é’ˆï¼Œå› æ­¤æ„æˆä¸€ä¸ªé“¾è¡¨ã€‚å½“è¦å­˜å‚¨ä¸€ä¸ªEntryå¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®hashç®—æ³•å†³å®šåœ¨æ•°ç»„ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œå†æ ¹æ®equalsæ–¹æ³•ï¼Œå†³å®šå…¶åœ¨è¯¥æ•°ç»„ä½ç½®ä¸Šçš„é“¾è¡¨çš„å­˜å‚¨ä½ç½®ï¼›åœ¨éœ€è¦å–å‡ºä¸€ä¸ªEntryæ—¶ï¼Œä¹Ÿä¼šæ ¹æ®hashç®—æ³•æ‰¾åˆ°å…¶åœ¨è¿™ä¸ªæ•°ç»„çš„å­˜å‚¨ä½ç½®ï¼Œå†æ ¹æ®equelæ–¹æ³•ï¼Œä»è¯¥ä½ç½®æ‰¾åˆ°å¯¹åº”çš„Entryå¯¹è±¡ã€‚</p><h6 id="hashmapä¸¤ç§éå†æ–¹å¼"><a href="#hashmapä¸¤ç§éå†æ–¹å¼" class="headerlink" title="hashmapä¸¤ç§éå†æ–¹å¼"></a>hashmapä¸¤ç§éå†æ–¹å¼</h6><p>ç¬¬ä¸€ç§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Map map = <span class="keyword">new</span> HashMap();</div><div class="line">ã€€ã€€Iterator iter = map.entrySet().iterator();</div><div class="line">ã€€ã€€<span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">ã€€ã€€Map.Entry entry = (Map.Entry) iter.next();</div><div class="line">ã€€ã€€Object key = entry.getKey();</div><div class="line">ã€€ã€€Object val = entry.getValue();</div><div class="line">ã€€ã€€&#125;</div></pre></td></tr></table></figure><p>ç¬¬äºŒç§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ã€€Map map = <span class="keyword">new</span> HashMap();</div><div class="line">ã€€ã€€Iterator iter = map.keySet().iterator();</div><div class="line">ã€€ã€€<span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">ã€€ã€€Object key = iter.next();</div><div class="line">ã€€ã€€Object val = map.get(key);</div><div class="line">ã€€ã€€&#125;</div></pre></td></tr></table></figure><h6 id="æµ…æConcurrentHashMap"><a href="#æµ…æConcurrentHashMap" class="headerlink" title="æµ…æConcurrentHashMap"></a>æµ…æConcurrentHashMap</h6><ul><li>public V get(Object key)ä¸æ¶‰åŠåˆ°é”ï¼Œä¹Ÿå°±æ˜¯è¯´è·å¾—å¯¹è±¡æ—¶æ²¡æœ‰ä½¿ç”¨é”ï¼›</li><li>putã€removeæ–¹æ³•è¦ä½¿ç”¨é”ï¼Œä½†å¹¶ä¸ä¸€å®šæœ‰é”äº‰ç”¨ï¼ŒåŸå› åœ¨äºConcurrentHashMapå°†ç¼“å­˜çš„å˜é‡åˆ†åˆ°å¤šä¸ªSegmentï¼Œæ¯ä¸ªSegmentä¸Šæœ‰ä¸€ä¸ªé”ï¼Œåªè¦å¤šä¸ªçº¿ç¨‹è®¿é—®çš„ä¸æ˜¯ä¸€ä¸ªSegmentå°±æ²¡æœ‰é”äº‰ç”¨ï¼Œå°±æ²¡æœ‰å µå¡ï¼Œå„çº¿ç¨‹ç”¨å„è‡ªçš„é”ï¼ŒConcurrentHashMapç¼ºçœæƒ…å†µä¸‹ç”Ÿæˆ16ä¸ªSegmentï¼Œä¹Ÿå°±æ˜¯å…è®¸16ä¸ªçº¿ç¨‹å¹¶å‘çš„æ›´æ–°è€Œå°½é‡æ²¡æœ‰é”äº‰ç”¨ï¼›</li><li>Hashtableå¯¹get,put,removeéƒ½ä½¿ç”¨äº†åŒæ­¥æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨éå†é›†åˆï¼Œå…¶ä»–çš„çº¿ç¨‹å°±æš‚æ—¶ä¸èƒ½ä½¿ç”¨è¯¥é›†åˆäº†ï¼Œè¿™æ ·æ— ç–‘å°±å¾ˆå®¹æ˜“å¯¹æ€§èƒ½å’Œååé‡é€ æˆå½±å“ã€‚è€ŒConcurrentHashMapåˆ™ä¸åŒï¼Œå®ƒåªå¯¹put,removeæ“ä½œä½¿ç”¨äº†åŒæ­¥æ“ä½œï¼Œgetæ“ä½œå¹¶ä¸å½±å“</li><li>Hashtableåœ¨ä½¿ç”¨iteratoréå†çš„æ—¶å€™ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹ï¼ŒåŒ…æ‹¬æœ¬çº¿ç¨‹å¯¹Hashtableè¿›è¡Œäº†putï¼Œremoveç­‰æ›´æ–°æ“ä½œçš„è¯ï¼Œå°±ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œä½†å¦‚æœä½¿ç”¨ConcurrentHashMapçš„è¯ï¼Œå°±ä¸ç”¨è€ƒè™‘è¿™æ–¹é¢çš„é—®é¢˜äº†</li></ul><h6 id="æµ…æHashMapï¼ŒHashTableï¼ŒConcurrentHashMap"><a href="#æµ…æHashMapï¼ŒHashTableï¼ŒConcurrentHashMap" class="headerlink" title="æµ…æHashMapï¼ŒHashTableï¼ŒConcurrentHashMap"></a>æµ…æHashMapï¼ŒHashTableï¼ŒConcurrentHashMap</h6><ul><li>HashMapå¦‚ä¸Šæ‰€è¯‰ï¼Œä¸åŒæ­¥ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œä¸ä½¿ç”¨ç”¨ä¸å¤šçº¿ç¨‹é«˜å¹¶å‘æƒ…å†µä¸‹</li><li>Hashtableï¼Œè¢«é—å¼ƒçš„ç±»ï¼Œçº¿ç¨‹å®‰å…¨æ˜¯å› ä¸ºåœ¨æ‰€æœ‰æ–¹æ³•ä¸Šéƒ½åŠ äº†synchronizedæ¥å®ç°çº¿ç¨‹å®‰å…¨ï¼Œå¯¼è‡´å¤šçº¿ç¨‹è®¿é—®æ•ˆç‡ä½</li><li>Synchronized Mapï¼ˆé€šè¿‡Collections.synchronizedMap()æ¥åŒ…è£…ä¸€ä¸ªhashmapï¼‰å’ŒhashtableåŒºåˆ«ä¸å¤§ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯æ²¡æœ‰è¢«é—å¼ƒ</li><li>ConcurrentHashMapï¼Œé»˜è®¤å…è®¸16ä¸ªçº¿ç¨‹è¯»å†™è¿™ä¸ªmapï¼Œä¸åƒHashtableå’ŒSynchronized Mapä¸€æ ·ï¼Œæ²¡æœ‰é”æ•´ä¸ªæ•´ä¸ªmapï¼Œè€Œæ˜¯åˆ’åˆ†äº†å¤šä¸ªæ®µï¼ˆSegmentï¼‰ï¼Œåªä¼šé”éœ€è¦æ“ä½œçš„é‚£ä¸€æ®µæ•°æ®</li></ul><p><a href="https://www.jianshu.com/p/c00308c32de4" target="_blank" rel="external">ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†åšå®¢</a></p><p><a href="http://blog.csdn.net/heng615975867/article/details/52799213" target="_blank" rel="external">ç‚¹å‡»æŸ¥çœ‹ç›¸å…³åšå®¢</a></p><h5 id="TreeMap"><a href="#TreeMap" class="headerlink" title="TreeMap"></a><strong>TreeMap</strong></h5><p>åº•å±‚æ˜¯äºŒå‰æ ‘æ•°æ®ç»“æ„ã€‚çº¿ç¨‹ä¸åŒæ­¥ã€‚å¯ä»¥ç”¨äºç»™mapé›†åˆä¸­çš„é”®è¿›è¡Œæ’åºã€‚</p><h4 id="é›†åˆè¾“å‡ºï¼ˆéå†ï¼‰"><a href="#é›†åˆè¾“å‡ºï¼ˆéå†ï¼‰" class="headerlink" title="é›†åˆè¾“å‡ºï¼ˆéå†ï¼‰"></a>é›†åˆè¾“å‡ºï¼ˆéå†ï¼‰</h4><ul><li>Iteratorï¼š è¿­ä»£è¾“å‡ºï¼Œä½¿ç”¨æœ€å¤šçš„è¾“å‡ºæ–¹å¼</li><li>ListIteratorï¼šæ˜¯Iteratorçš„å­æ¥å£ï¼Œä¸“é—¨ç”¨äºè¾“å‡ºListä¸­çš„å†…å®¹ã€‚</li><li>foreachè¾“å‡ºï¼šJDK1.5ä¹‹åæä¾›çš„æ–°åŠŸèƒ½ï¼Œå¯ä»¥è¾“å‡ºæ•°ç»„æˆ–é›†åˆã€‚</li><li>forå¾ªç¯</li></ul><h4 id="é›†åˆçš„å·¥å…·ç±»"><a href="#é›†åˆçš„å·¥å…·ç±»" class="headerlink" title="é›†åˆçš„å·¥å…·ç±»"></a>é›†åˆçš„å·¥å…·ç±»</h4><p>Collections:é›†åˆæ¡†æ¶çš„å·¥å…·ç±»ã€‚é‡Œé¢å®šä¹‰çš„éƒ½æ˜¯é™æ€æ–¹æ³•ã€‚</p><p>ã€€ã€€Collectionså’ŒCollectionæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>ã€€ã€€ã€€ã€€Collectionæ˜¯é›†åˆæ¡†æ¶ä¸­çš„ä¸€ä¸ªé¡¶å±‚æ¥å£ï¼Œå®ƒé‡Œé¢å®šä¹‰äº†å•åˆ—é›†åˆçš„å…±æ€§æ–¹æ³•ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€å®ƒæœ‰ä¸¤ä¸ªå¸¸ç”¨çš„å­æ¥å£ï¼Œ</p><p>ã€€ã€€ã€€ã€€ã€€ã€€â€”â€”Listï¼šå¯¹å…ƒç´ éƒ½æœ‰å®šä¹‰ç´¢å¼•ã€‚æœ‰åºçš„ã€‚å¯ä»¥é‡å¤å…ƒç´ ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€â€”â€”Setï¼šä¸å¯ä»¥é‡å¤å…ƒç´ ã€‚æ— åºã€‚</p><p>ã€€ã€€ã€€ã€€Collectionsæ˜¯é›†åˆæ¡†æ¶ä¸­çš„ä¸€ä¸ªå·¥å…·ç±»ã€‚è¯¥ç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯é™æ€çš„ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€æä¾›çš„æ–¹æ³•ä¸­æœ‰å¯ä»¥å¯¹listé›†åˆè¿›è¡Œæ’åºï¼ŒäºŒåˆ†æŸ¥æ‰¾ç­‰æ–¹æ³•ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€é€šå¸¸å¸¸ç”¨çš„é›†åˆéƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚å› ä¸ºè¦æé«˜æ•ˆç‡ã€‚</p><p>ã€€ã€€ã€€ã€€ã€€ã€€å¦‚æœå¤šçº¿ç¨‹æ“ä½œè¿™äº›é›†åˆæ—¶ï¼Œå¯ä»¥é€šè¿‡è¯¥å·¥å…·ç±»ä¸­çš„åŒæ­¥æ–¹æ³•ï¼Œå°†çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆï¼Œè½¬æ¢æˆå®‰å…¨çš„ã€‚</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>Listï¼šadd/remove/get/setã€‚</p><p>ã€€ã€€ã€€ã€€1ï¼ŒArrayListï¼šå…¶å®å°±æ˜¯æ•°ç»„ï¼Œå®¹é‡ä¸€å¤§ï¼Œé¢‘ç¹å¢åˆ å°±æ˜¯å™©æ¢¦ï¼Œé€‚åˆéšæœºæŸ¥æ‰¾ï¼›</p><p>ã€€ã€€ã€€ã€€2ï¼ŒLinkedListï¼šå¢åŠ äº†push/[pop|remove|pull]ï¼Œå…¶å®éƒ½æ˜¯removeFirstï¼›</p><p>ã€€ã€€ã€€ã€€3ï¼ŒVectorï¼šå†å²é—ç•™äº§ç‰©ï¼ŒåŒæ­¥ç‰ˆçš„ArrayListï¼Œä»£ç å’ŒArrayListå¤ªåƒï¼›</p><p>ã€€ã€€ã€€ã€€4ï¼ŒStackï¼šç»§æ‰¿è‡ªVectorã€‚Javaé‡Œå…¶å®æ²¡æœ‰çº¯ç²¹çš„Stackï¼Œå¯ä»¥è‡ªå·±å®ç°ï¼Œç”¨ç»„åˆçš„æ–¹å¼ï¼Œå°è£…ä¸€ä¸‹LinkedListå³å¯ï¼›</p><p>ã€€ã€€ã€€ã€€5ï¼ŒQueueï¼šæœ¬æ¥æ˜¯å•ç‹¬çš„ä¸€ç±»ï¼Œä¸è¿‡åœ¨SUNçš„JDKé‡Œå°±æ˜¯ç”¨LinkedListæ¥æä¾›è¿™ä¸ªåŠŸèƒ½çš„ï¼Œä¸»è¦æ–¹æ³•æ˜¯offer/pull/peekï¼Œå› æ­¤å½’åˆ°è¿™é‡Œå‘¢ã€‚</p><p>ã€€ã€€Setï¼šadd/removeã€‚å¯ä»¥ç”¨è¿­ä»£å™¨æˆ–è€…è½¬æ¢æˆlistã€‚</p><p>ã€€ã€€ã€€ã€€1ï¼ŒHashSetï¼šå†…éƒ¨é‡‡ç”¨HashMapå®ç°çš„ï¼›</p><p>ã€€ã€€ã€€ã€€2ï¼ŒLinkedHashSetï¼šé‡‡ç”¨LinkedHashMapå®ç°ï¼›</p><p>ã€€ã€€ã€€ã€€3ï¼ŒTreeSetï¼šTreeMapã€‚</p><p>ã€€ã€€Mapï¼šput/get/removeã€‚</p><p>ã€€ã€€ã€€ã€€1ï¼ŒHashMap/HashTableï¼šæ•£åˆ—è¡¨ï¼Œå’ŒArrayListä¸€æ ·é‡‡ç”¨æ•°ç»„å®ç°ï¼Œè¶…è¿‡åˆå§‹å®¹é‡ä¼šå¯¹æ€§èƒ½æœ‰æŸè€—ï¼›</p><p>ã€€ã€€ã€€ã€€2ï¼ŒLinkedHashMapï¼šç»§æ‰¿è‡ªHashMapï¼Œä½†é€šè¿‡é‡å†™åµŒå¥—ç±»HashMap.Entryå®ç°äº†é“¾è¡¨ç»“æ„ï¼ŒåŒæ ·æœ‰å®¹é‡çš„é—®é¢˜ï¼›</p><p>ã€€ã€€ã€€ã€€3ï¼ŒPropertiesï¼šæ˜¯ç»§æ‰¿çš„HashTableã€‚</p><p>ã€€ã€€ã€€ã€€é¡ºä¾¿è¯´ä¸€ä¸‹Arrays.asListï¼Œè¿™ä¸ªæ–¹æ³•çš„å®ç°ä¾èµ–ä¸€ä¸ªåµŒå¥—ç±»ï¼Œè¿™ä¸ªåµŒå¥—ç±»ä¹Ÿå«ArrayListï¼</p><h4 id="æ‰‹å†™é›†åˆ"><a href="#æ‰‹å†™é›†åˆ" class="headerlink" title="æ‰‹å†™é›†åˆ"></a>æ‰‹å†™é›†åˆ</h4><h5 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** </span></div><div class="line"> * æ‰‹å†™ArrayList  </div><div class="line"> */  </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyArrayList</span></span>&#123;  </div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="keyword">private</span> Object[] value = <span class="keyword">null</span>;  </div><div class="line">  </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;  </div><div class="line">  </div><div class="line">    MyArrayList() &#123;  </div><div class="line">        value = <span class="keyword">new</span> Object[<span class="number">10</span>];  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(Object obj)</span></span>&#123;  </div><div class="line">        <span class="keyword">if</span>(size == value.length)  </div><div class="line">            expansion();  </div><div class="line">        value[size++]=obj;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> value[index];  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Object obj)</span></span>&#123;  </div><div class="line">        Object[] obj2 = <span class="keyword">new</span> Object[size];  </div><div class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= size; i++) &#123;  </div><div class="line">            <span class="keyword">if</span>(!(value[i].toString().equals(obj.toString())))&#123;  </div><div class="line">                obj2[index] = value[i];  </div><div class="line">                index ++;  </div><div class="line">            &#125;<span class="keyword">else</span>&#123;  </div><div class="line">                id ++ ;  </div><div class="line">                <span class="keyword">if</span>(id == <span class="number">1</span>)  </div><div class="line">                    size --;  </div><div class="line">                <span class="keyword">else</span>&#123;  </div><div class="line">                    obj2[index] = value[i];  </div><div class="line">                    index ++;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        value = obj2;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"null"</span>)  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index,Object obj)</span></span>&#123;  </div><div class="line">        Object[] newObj = <span class="keyword">new</span> Object[size];;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;  </div><div class="line">            <span class="keyword">if</span>(i == index)  </div><div class="line">                newObj[i] = obj;  </div><div class="line">            <span class="keyword">else</span>  </div><div class="line">                newObj[i] = value[i];  </div><div class="line">        &#125;  </div><div class="line">        value = newObj;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;  </div><div class="line">        <span class="keyword">return</span> size;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">expansion</span><span class="params">()</span> </span>&#123;  </div><div class="line">        Object[] temp = <span class="keyword">new</span> Object[value.length + <span class="number">5</span>];  </div><div class="line">        temp = value.clone();  </div><div class="line">        <span class="comment">/** </span></div><div class="line">        * æ³¨æ„ï¼šcloneåªå¯¹ä¸€ç»´æ•°ç»„èµ·ä½œç”¨ï¼Œè€Œä¸èƒ½ç”¨äºäºŒç»´æ•°ç»„ï¼Œ å› ä¸ºjavaæ²¡æœ‰äºŒç»´æ•°ç»„çš„æ¦‚å¿µï¼Œè€Œåªæœ‰æ•°ç»„çš„æ•°ç»„ï¼ŒäºŒç»´ </div><div class="line">        * æ•°ç»„å­˜å‚¨çš„æ˜¯å‡ ä¸ªä¸€ç»´æ•°ç»„çš„å¼•ç”¨ï¼Œè€Œä½¿ç”¨cloneä¹Ÿåªæ˜¯ æ‹·è´äº†è¿™å‡ ä¸ªå¼•ç”¨ï¼Œè¯´ç™½äº†è¿˜æ˜¯åŸæ¥é‚£å‡ ä¸ªä¸€ç»´æ•°ç»„å¯¹è±¡ã€‚ </div><div class="line">        * å¦‚æœæƒ³ç”¨äºäºŒç»´æ•°ç»„ï¼Œé‚£ä¹ˆå°±éå†å…¶ä¸­çš„ä¸€ç»´æ•°ç»„ï¼ŒæŒ¨ä¸ª æ‹·è´ä¸€ç»´æ•°ç»„åˆ°ç›®æ ‡äºŒç»´æ•°ç»„ä¸­çš„ä¸€ç»´æ•°ç»„ä¸‹ã€‚ </div><div class="line">        */  </div><div class="line">        value = temp;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;  </div><div class="line">        size = <span class="number">0</span>;  </div><div class="line">        value = <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;  </div><div class="line">        MyArrayList ma = <span class="keyword">new</span> MyArrayList();  </div><div class="line">        ma.add(<span class="string">"hello"</span>);  </div><div class="line">        ma.add(<span class="string">"world"</span>);  </div><div class="line">        ma.add(<span class="string">"java"</span>);  </div><div class="line">        System.out.println(ma.get(<span class="number">1</span>));  </div><div class="line">        System.out.println(ma.size());  </div><div class="line">        ma.set(<span class="number">1</span>, <span class="string">"new"</span>);  </div><div class="line">        System.out.println(ma.get(<span class="number">1</span>));  </div><div class="line">        System.out.println(ma.size());  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>LinkedList</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLinkedList</span>&lt;<span class="title">AnyType</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">AnyType</span>&gt;</span>&#123;</div><div class="line">        <span class="keyword">public</span> AnyType data;</div><div class="line">        <span class="keyword">public</span> Node&lt;AnyType&gt; prev;</div><div class="line">        <span class="keyword">public</span> Node&lt;AnyType&gt; next;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(AnyType d, Node&lt;AnyType&gt; p, Node&lt;AnyType&gt; n)</span></span>&#123;</div><div class="line">            data = d;</div><div class="line">            prev = p;</div><div class="line">            next = n;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> theSize;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> modCount;</div><div class="line">    <span class="keyword">private</span> Node&lt;AnyType&gt; beginMarker;</div><div class="line">    <span class="keyword">private</span> Node&lt;AnyType&gt; endMarker;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyLinkedList</span><span class="params">()</span></span>&#123;</div><div class="line">        clear();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</div><div class="line">        beginMarker = <span class="keyword">new</span> Node&lt;AnyType&gt;(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</div><div class="line">        endMarker = <span class="keyword">new</span> Node&lt;AnyType&gt;(<span class="keyword">null</span>, beginMarker, <span class="keyword">null</span>);</div><div class="line">        beginMarker.next = endMarker;</div><div class="line">        theSize = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> theSize;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(AnyType x)</span></span>&#123;</div><div class="line">        add(size(), x);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> idx, AnyType x)</span></span>&#123;</div><div class="line">        addBefore(getNode(idx), x);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> AnyType <span class="title">get</span><span class="params">(<span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> getNode(idx).data;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addBefore</span><span class="params">(Node&lt;AnyType&gt; p, AnyType x)</span></span>&#123;</div><div class="line">        Node&lt;AnyType&gt; newNode = <span class="keyword">new</span> Node&lt;AnyType&gt;(x, p.prev, p);</div><div class="line">        newNode.prev.next = newNode;</div><div class="line">        p.prev = newNode;</div><div class="line">        theSize++;</div><div class="line">        modCount++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> Node&lt;AnyType&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> idx)</span></span>&#123;</div><div class="line">        Node&lt;AnyType&gt; p;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(idx &lt; <span class="number">0</span> || idx &gt; size())&#123;</div><div class="line">            System.out.println(<span class="string">"IndexOutOfBoundsException"</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(idx &lt;= size()/<span class="number">2</span>)&#123;</div><div class="line">            System.out.println(idx);</div><div class="line">            p = beginMarker.next;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; idx; i++)&#123;</div><div class="line">                p = p.next;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            p = endMarker;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = size(); i &gt; idx; i--)&#123;</div><div class="line">                p = p.prev;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> p;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">find</span><span class="params">(AnyType x)</span></span>&#123;</div><div class="line">        Node&lt;AnyType&gt; p = beginMarker.next;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size(); i++)&#123;</div><div class="line">            <span class="keyword">if</span>(p.data == x)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">            p = p.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</div><div class="line">        String s = <span class="string">""</span>;</div><div class="line">        Node&lt;AnyType&gt; p = beginMarker.next;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size(); i++)&#123;</div><div class="line">            s += p.data +<span class="string">","</span>;</div><div class="line">            p = p.next;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> s;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HandlerThread</title>
      <link href="/2015/12/22/HandlerThread/"/>
      <content type="html"><![CDATA[<p><strong>HandlerThread</strong></p><p>HandlerThreadçŸ¥è¯†ç‚¹æ•´ç†</p><a id="more"></a><p> <strong>å®˜æ–¹ä»‹ç»</strong></p><blockquote><p>Handy class for starting a new thread that has a looper. The looper can then be used to create handler classes. Note that start() must still be called.</p></blockquote><p>æ„æ€å°±æ˜¯HandlerThreadèƒ½å¤Ÿæ–°å»ºæ‹¥æœ‰Looperçš„çº¿ç¨‹(é™¤äº†ä¸»çº¿ç¨‹,æˆ‘ä»¬æ–°å»ºçº¿ç¨‹æ˜¯éœ€è¦æ‰‹åŠ¨è°ƒç”¨Looper.prepareæ¥åˆå§‹åŒ–looperå’Œmessagequeueçš„),è€Œè¿™ä¸ªlooperèƒ½å¤Ÿæ¥æ–°å»ºå…¶ä»–çš„Handler(æ–°å»ºçš„è¿™ä¸ªhandleræ˜¯å±äºå­çº¿ç¨‹çš„,å¹¶ä¸”looperå’Œmessagequeueéƒ½æ˜¯åˆå§‹åŒ–å¥½äº†çš„)</p><p><strong>å¦‚ä»¥ä¸‹ä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">mHandlerThread = <span class="keyword">new</span> HandlerThread(<span class="string">"check-message-coming"</span>);<span class="comment">//the name of the new thread</span></div><div class="line">        mHandlerThread.start();</div><div class="line"></div><div class="line">        mThreadHandler = <span class="keyword">new</span> Handler(mHandlerThread.getLooper())<span class="comment">//æ‹¥æœ‰å­çº¿ç¨‹looperçš„handler</span></div><div class="line">        &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span></span></div><div class="line">            &#123;</div><div class="line">                update();<span class="comment">//æ¨¡æ‹Ÿæ•°æ®æ›´æ–°</span></div><div class="line"></div><div class="line">                <span class="keyword">if</span> (isUpdateInfo)</div><div class="line">                    mThreadHandler.sendEmptyMessage(MSG_UPDATE_INFO);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        </div><div class="line"> <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroy();</div><div class="line"></div><div class="line">        <span class="comment">//é‡Šæ”¾èµ„æº</span></div><div class="line">        myHandlerThread.quit() ;</div><div class="line">    &#125;</div><div class="line"><span class="comment">//å…¶ä»–çº¿ç¨‹å¯ä»¥æ‹¿mThreadHandlerå‘æ¶ˆæ¯äº†ï¼Œæ¥å®Œæˆå‘è¯¥HandlerThreadçº¿ç¨‹é€šè®¯</span></div></pre></td></tr></table></figure><p>mThreadHandleræ„å»ºçš„æ—¶å€™,ä¼ çš„æ˜¯HandlerThreadçš„looperå¯¹è±¡,ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªmThreadHandleræ˜¯å±äºå­çº¿ç¨‹çš„ç®¡ç†çš„,ä»–çš„handlerMessageçš„å›è°ƒä¸­æ˜¯å¯ä»¥åšè€—æ—¶æ“ä½œçš„(åˆ‡è®°,æ˜¯ä¸èƒ½åšæ›´æ–°UIçš„æ“ä½œçš„,å¦‚éœ€è¦æ›´æ–°,éœ€è¦ç”¨ä¸»çº¿ç¨‹çš„handlerå‘æ¶ˆæ¯æ¥æ›´æ–°,æˆ–è€…ä½¿ç”¨runOnUiThreadæˆ–è€…eventBusç­‰å…¶ä»–æ–¹å¼æ¥åˆ·æ–°ui)</p><p><strong>é€€å‡ºå¾ªç¯</strong></p><p>Looperæ˜¯é€šè¿‡è°ƒç”¨loopæ–¹æ³•é©±åŠ¨ç€æ¶ˆæ¯å¾ªç¯çš„è¿›è¡Œ: ä»MessageQueueä¸­é˜»å¡å¼åœ°å–å‡ºä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åè®©Handlerå¤„ç†è¯¥æ¶ˆæ¯ï¼Œå‘¨è€Œå¤å§‹ï¼Œloopæ–¹æ³•æ˜¯ä¸ªæ­»å¾ªç¯æ–¹æ³•ã€‚</p><p>é‚£å¦‚ä½•ç»ˆæ­¢æ¶ˆæ¯å¾ªç¯å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è°ƒç”¨Looperçš„quitæ–¹æ³•æˆ–quitSafelyæ–¹æ³•ï¼ŒäºŒè€…ç¨æœ‰ä¸åŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Quits the looper.</div><div class="line">     * &lt;p&gt;</div><div class="line">     * Causes the &#123;<span class="doctag">@link</span> #loop&#125; method to terminate without processing any</div><div class="line">     * more messages in the message queue.</div><div class="line">     * &lt;/p&gt;&lt;p&gt;</div><div class="line">     * Any attempt to post messages to the queue after the looper is asked to quit will fail.</div><div class="line">     * For example, the &#123;<span class="doctag">@link</span> Handler#sendMessage(Message)&#125; method will return false.</div><div class="line">     * &lt;/p&gt;&lt;p class="note"&gt;</div><div class="line">     * Using this method may be unsafe because some messages may not be delivered</div><div class="line">     * before the looper terminates.  Consider using &#123;<span class="doctag">@link</span> #quitSafely&#125; instead to ensure</div><div class="line">     * that all pending work is completed in an orderly manner.</div><div class="line">     * &lt;/p&gt;</div><div class="line">     *</div><div class="line">     * <span class="doctag">@see</span> #quitSafely</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quit</span><span class="params">()</span> </span>&#123;</div><div class="line">        mQueue.quit(<span class="keyword">false</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Quits the looper safely.</div><div class="line">     * &lt;p&gt;</div><div class="line">     * Causes the &#123;<span class="doctag">@link</span> #loop&#125; method to terminate as soon as all remaining messages</div><div class="line">     * in the message queue that are already due to be delivered have been handled.</div><div class="line">     * However pending delayed messages with due times in the future will not be</div><div class="line">     * delivered before the loop terminates.</div><div class="line">     * &lt;/p&gt;&lt;p&gt;</div><div class="line">     * Any attempt to post messages to the queue after the looper is asked to quit will fail.</div><div class="line">     * For example, the &#123;<span class="doctag">@link</span> Handler#sendMessage(Message)&#125; method will return false.</div><div class="line">     * &lt;/p&gt;</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quitSafely</span><span class="params">()</span> </span>&#123;</div><div class="line">        mQueue.quit(<span class="keyword">true</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure><p><strong>quitï¼ˆï¼‰å’ŒquitSafetyçš„åŒºåˆ«</strong></p><p>å½“æˆ‘ä»¬è°ƒç”¨Looperçš„quitæ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œäº†MessageQueueä¸­çš„removeAllMessagesLockedæ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯æŠŠMessageQueueæ¶ˆæ¯æ± ä¸­æ‰€æœ‰çš„æ¶ˆæ¯å…¨éƒ¨æ¸…ç©ºï¼Œæ— è®ºæ˜¯å»¶è¿Ÿæ¶ˆæ¯ï¼ˆå»¶è¿Ÿæ¶ˆæ¯æ˜¯æŒ‡é€šè¿‡sendMessageDelayedæˆ–é€šè¿‡postDelayedç­‰æ–¹æ³•å‘é€çš„éœ€è¦å»¶è¿Ÿæ‰§è¡Œçš„æ¶ˆæ¯ï¼‰è¿˜æ˜¯éå»¶è¿Ÿæ¶ˆæ¯ã€‚</p><p>å½“æˆ‘ä»¬è°ƒç”¨Looperçš„quitSafelyæ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œäº†MessageQueueä¸­çš„removeAllFutureMessagesLockedæ–¹æ³•ï¼Œé€šè¿‡åå­—å°±å¯ä»¥çœ‹å‡ºï¼Œè¯¥æ–¹æ³•åªä¼šæ¸…ç©ºMessageQueueæ¶ˆæ¯æ± ä¸­æ‰€æœ‰çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œå¹¶å°†æ¶ˆæ¯æ± ä¸­æ‰€æœ‰çš„éå»¶è¿Ÿæ¶ˆæ¯æ´¾å‘å‡ºå»è®©Handlerå»å¤„ç†ï¼ŒquitSafelyç›¸æ¯”äºquitæ–¹æ³•å®‰å…¨ä¹‹å¤„åœ¨äºæ¸…ç©ºæ¶ˆæ¯ä¹‹å‰ä¼šæ´¾å‘æ‰€æœ‰çš„éå»¶è¿Ÿæ¶ˆæ¯ã€‚</p><p>æ— è®ºæ˜¯è°ƒç”¨äº†quitæ–¹æ³•è¿˜æ˜¯quitSafelyæ–¹æ³•åªä¼šï¼ŒLooperå°±ä¸å†æ¥æ”¶æ–°çš„æ¶ˆæ¯ã€‚å³åœ¨è°ƒç”¨äº†Looperçš„quitæˆ–quitSafelyæ–¹æ³•ä¹‹åï¼Œæ¶ˆæ¯å¾ªç¯å°±ç»ˆç»“äº†ï¼Œè¿™æ—¶å€™å†é€šè¿‡Handlerè°ƒç”¨sendMessageæˆ–postç­‰æ–¹æ³•å‘é€æ¶ˆæ¯æ—¶å‡è¿”å›falseï¼Œè¡¨ç¤ºæ¶ˆæ¯æ²¡æœ‰æˆåŠŸæ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—MessageQueueä¸­ï¼Œå› ä¸ºæ¶ˆæ¯é˜Ÿåˆ—å·²ç»é€€å‡ºäº†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯Looperçš„quitæ–¹æ³•ä»API Level 1å°±å­˜åœ¨äº†ï¼Œä½†æ˜¯Looperçš„quitSafelyæ–¹æ³•ä»API Level 18æ‰æ·»åŠ è¿›æ¥ã€‚</p><p><strong>æ€»ç»“</strong></p><pre><code>1. HandlerThreadç»§æ‰¿è‡ªThread,å› æ­¤è°ƒç”¨startæ–¹æ³•,ä¹Ÿæ˜¯æ‰§è¡Œrunæ–¹æ³•,run()æ–¹æ³•çš„é€»è¾‘éƒ½æ˜¯åœ¨å­çº¿ç¨‹ä¸­è¿è¡Œçš„ã€‚2. æŸ¥çœ‹HandlerThreadæºç å¯ä»¥çœ‹åˆ°,run()ä¸­ä¸»è¦åšäº†Looper.prepare()å’Œlooper.loop()åˆ›å»ºlooperå’Œmessagequeueå¯¹è±¡å¹¶å¼€å¯æ¶ˆæ¯é˜Ÿåˆ—çš„å¾ªç¯3. éœ€è¦æ³¨æ„çš„æ˜¯,å¯¹äºç½‘ç»œioæ“ä½œ,HandlerThreadå¹¶ä¸é€‚åˆ,å› ä¸ºå®ƒåªæœ‰ä¸€ä¸ªçº¿ç¨‹,å¾—æ’é˜Ÿä¸€ä¸ªä¸€ä¸ªç­‰ç€ã€‚4. é¡µé¢æ¶ˆè€—çš„æ—¶å€™,è°ƒç”¨ myHandlerThread.quit() ;looperå°±ä¸åœ¨æ¥å—æ–°çš„æ¶ˆæ¯,æ¶ˆæ¯å¾ªç¯ç»“æŸ,è¿™ä¸ªæ—¶å€™å†é€šè¿‡handlerè°ƒç”¨sendMessageæˆ–è€…postç­‰æ–¹æ³•å‘é€æ¶ˆæ¯æ—¶å‡è¿”å›false,è¡¨ç¤ºæ²¡æœ‰æˆåŠŸçš„æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚</code></pre>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>edittextè¾“å…¥é™åˆ¶</title>
      <link href="/2015/12/13/edittext%E8%BE%93%E5%85%A5%E9%99%90%E5%88%B6/"/>
      <content type="html"><![CDATA[<p>EditTextæ™ºèƒ½é™åˆ¶å°æ•°ç‚¹å‰ååˆ†åˆ«ä¿ç•™å‡ ä½</p><a id="more"></a><p>éœ€æ±‚</p><ul><li>å¯ä»¥åˆ†åˆ«é™åˆ¶å°æ•°ç‚¹å‰é¢å‡ ä½ï¼Œå’Œå°æ•°ç‚¹åå‡ ä½</li><li>é¦–ä½è¾“å…¥0æ—¶ï¼Œç¬¬äºŒä½åªèƒ½è¾“å…¥å°æ•°ç‚¹</li><li>é¦–ä½è¾“å…¥å°æ•°ç‚¹ï¼Œé»˜è®¤æ˜¾ç¤º0.</li><li>å˜»å˜»!</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> *</div><div class="line"> * <span class="doctag">@param</span> frontPoint    å°æ•°ç‚¹å‰å‡ ä½æ•°</div><div class="line"> * <span class="doctag">@param</span> behindPoint   å°æ•°ç‚¹åå‡ ä½æ•°</div><div class="line"> * <span class="doctag">@param</span> editTexts</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setEditTextLimit</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> frontPoint, <span class="keyword">final</span> <span class="keyword">int</span> behindPoint, <span class="keyword">final</span> EditText... editTexts)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (editTexts != <span class="keyword">null</span> &amp;&amp; editTexts.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> EditText editText : editTexts) &#123;</div><div class="line">            editText.addTextChangedListener(<span class="keyword">new</span> TextWatcher() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> before,</span></span></div><div class="line">                                          <span class="keyword">int</span> count) &#123;</div><div class="line">                    <span class="keyword">if</span> (s.length() == frontPoint + <span class="number">1</span> &amp;&amp; !s.toString().contains(<span class="string">"."</span>)) &#123;</div><div class="line">                        editText.setText(s.toString().substring(<span class="number">0</span>, frontPoint));</div><div class="line">                        editText.setSelection(frontPoint);</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (editText.getText().toString().indexOf(<span class="string">"."</span>) &gt;= <span class="number">0</span>) &#123;</div><div class="line">                        <span class="keyword">if</span> (editText.getText().toString().indexOf(<span class="string">"."</span>, editText.getText().toString().indexOf(<span class="string">"."</span>) + <span class="number">1</span>) &gt; <span class="number">0</span>) &#123;</div><div class="line">                            editText.setText(editText.getText().toString().substring(<span class="number">0</span>, editText.getText().toString().length() - <span class="number">1</span>));</div><div class="line">                            editText.setSelection(editText.getText().toString().length());</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (s.toString().contains(<span class="string">"."</span>)) &#123;</div><div class="line">                        <span class="keyword">if</span> (s.length() - <span class="number">1</span> - s.toString().indexOf(<span class="string">"."</span>) &gt; behindPoint) &#123;</div><div class="line">                            s = s.toString().subSequence(<span class="number">0</span>,</div><div class="line">                                    s.toString().indexOf(<span class="string">"."</span>) + behindPoint+<span class="number">1</span>);</div><div class="line">                            editText.setText(s);</div><div class="line">                            editText.setSelection(s.length());</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    <span class="comment">//ç›´æ¥è¾“å…¥ä¸€ä¸ªç‚¹,æ˜¾ç¤º0.</span></div><div class="line">                    <span class="keyword">if</span> (s.toString().trim().substring(<span class="number">0</span>).equals(<span class="string">"."</span>)) &#123;</div><div class="line">                        s = <span class="string">"0"</span> + s;</div><div class="line">                        editText.setText(s);</div><div class="line">                        editText.setSelection(<span class="number">2</span>);</div><div class="line">                    &#125;</div><div class="line">                    <span class="comment">//å½“è¾“å…¥ä¸€ä¸ª0,åé¢åªèƒ½è¾“å…¥å°æ•°ç‚¹</span></div><div class="line">                    <span class="keyword">if</span> (s.toString().startsWith(<span class="string">"0"</span>)</div><div class="line">                            &amp;&amp; s.toString().trim().length() &gt; <span class="number">1</span>) &#123;</div><div class="line">                        <span class="keyword">if</span> (!s.toString().substring(<span class="number">1</span>, <span class="number">2</span>).equals(<span class="string">"."</span>)) &#123;</div><div class="line">                            editText.setText(s.subSequence(<span class="number">0</span>, <span class="number">1</span>));</div><div class="line">                            editText.setSelection(<span class="number">1</span>);</div><div class="line">                            <span class="keyword">return</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> count,</span></span></div><div class="line">                                              <span class="keyword">int</span> after) &#123;</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterTextChanged</span><span class="params">(Editable s)</span> </span>&#123;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>xmlåˆ«å¿˜äº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">android:inputType="numberDecimal"</div></pre></td></tr></table></figure><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=417859220&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å›¾ç‰‡ä¸Šä¼ ,è§’åº¦ä¸æ­£ç¡®</title>
      <link href="/2015/08/08/%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0-%E8%A7%92%E5%BA%A6%E4%B8%8D%E6%AD%A3%E7%A1%AE/"/>
      <content type="html"><![CDATA[<p>éƒ¨åˆ†æœºå‹ï¼ˆä¸‰æ˜Ÿï¼‰çš„ä¸Šä¼ å,å›¾ç‰‡æ˜¯é»˜è®¤æ—‹è½¬äº†90Â°<br><a id="more"></a></p><blockquote><p>è§£å†³é—®é¢˜</p></blockquote><p>ç›´æ¥è¿›å…¥æ­£é¢˜</p><h5 id="å½“æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡éœ€è¦åšçš„å¤„ç†"><a href="#å½“æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡éœ€è¦åšçš„å¤„ç†" class="headerlink" title="å½“æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡éœ€è¦åšçš„å¤„ç†"></a>å½“æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡éœ€è¦åšçš„å¤„ç†</h5><ul><li>å‹ç¼©</li><li>åˆ¤æ–­è§’åº¦æ˜¯å¦æ­£ç¡®</li><li>å¦‚æœä¸è§’åº¦ä¸å¯¹,çº æ­£è§’åº¦</li><li>å…¶ä»–(åŠ æ°´å°ä»€ä¹ˆçš„çœ‹å…·ä½“éœ€æ±‚)</li></ul><p>è§£å†³<br>ä»¥ä¸‹ä»£ç å—<br>â€‹<br>     /**</p><pre><code> * å‹ç¼©å›¾ç‰‡ï¼Œå¤„ç†æŸäº›æ‰‹æœºæ‹ç…§è§’åº¦æ—‹è½¬çš„é—®é¢˜ * @param context * @param filePath * @param file * @param q * @return * @throws FileNotFoundException */public static File compressImage(Context context, String filePath, File file, int q) throws FileNotFoundException {    Bitmap bm = getSmallBitmap(filePath);    int degree = readPictureDegree(filePath);    LogUtil.e(&quot;fengan&quot;, &quot;degree==&quot; + degree);    if (degree != 0) {//æ—‹è½¬ç…§ç‰‡è§’åº¦        bm = rotateBitmap(bm, degree);    }    FileOutputStream out = new FileOutputStream(file);    bm.compress(Bitmap.CompressFormat.JPEG, q, out);    return file;}`/** * è·å–å›¾ç‰‡è§’åº¦ * @param path * @return */public static int readPictureDegree(String path) {    int degree = 0;    try {        ExifInterface exifInterface = new ExifInterface(path);        int orientation = exifInterface.getAttributeInt(                ExifInterface.TAG_ORIENTATION,                ExifInterface.ORIENTATION_NORMAL);        switch (orientation) {            case ExifInterface.ORIENTATION_ROTATE_90:                degree = 90;                break;            case ExifInterface.ORIENTATION_ROTATE_180:                degree = 180;                break;            case ExifInterface.ORIENTATION_ROTATE_270:                degree = 270;                break;        }    } catch (IOException e) {        e.printStackTrace();    }    return degree;} /** * æ—‹è½¬ç…§ç‰‡ * @param bitmap * @param degress * @return */public static Bitmap rotateBitmap(Bitmap bitmap, int degress) {    if (bitmap != null) {        Matrix m = new Matrix();        m.postRotate(degress);        bitmap = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(),                bitmap.getHeight(), m, true);        return bitmap;    }    return bitmap;}    /** * æ ¹æ®è·¯å¾„è·å¾—çªç ´å¹¶å‹ç¼©è¿”å›bitmapç”¨äºæ˜¾ç¤º * * @return */public static Bitmap getSmallBitmap(String filePath) {    final BitmapFactory.Options options = new BitmapFactory.Options();    options.inJustDecodeBounds = true;    BitmapFactory.decodeFile(filePath, options);    // Calculate inSampleSize    options.inSampleSize = calculateInSampleSize(options, 480, 800);    // Decode bitmap with inSampleSize set    options.inJustDecodeBounds = false;    return BitmapFactory.decodeFile(filePath, options);}</code></pre><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=490602392&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¥ä½ ä»Šå¤©å¿ƒæƒ…æ„‰å¿«</title>
      <link href="/2015/08/08/%E7%A5%9D%E4%BD%A0%E4%BB%8A%E5%A4%A9%E5%BF%83%E6%83%85%E6%84%89%E5%BF%AB/"/>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=28138588&auto=1&height=66"></iframe>]]></content>
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
